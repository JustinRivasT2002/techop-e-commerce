import{A as It,a as gv,b as Th,c as yv,d as Rs,e as Ah,f as Uc,g as _v,h as vv,i as Sh,j as De,k as Lr,l as an,m as jc,n as Ms,o as wv,p as Ev,q as Cv,r as bv,s as Xn,t as Ph,u as xh,v as Rh,w as Mh,x as Dh,y as Oh,z as kh}from"./chunk-MHDKQ3SD.js";import{$ as hh,$a as Ch,$b as Fr,A as Ci,Aa as G_,Ab as tv,B as Hn,Ba as _h,Bb as Nc,C as ah,Ca as W_,Cb as nv,D as bi,Da as K_,Db as As,E as k_,Ea as Cs,Eb as Ss,F as Dr,Fa as Yn,Fb as rv,G as nn,Ga as H_,Gb as iv,H as ch,Ha as G,Hb as Vr,I as V_,Ia as bs,Ib as Mi,J as Sc,Ja as Pc,Jb as An,K as Ii,Ka as kr,Kb as ov,L as lh,La as oe,Lb as Nr,M as Ti,Ma as xc,Mb as sv,N as ze,Na as Q_,Nb as av,O as uh,Oa as Y_,Ob as mt,P as N_,Pa as vh,Pb as cv,Q as nt,Qa as $e,Qb as Ps,R as he,Ra as Ze,Rb as lv,S as Qn,Sa as Ge,Sb as uv,T as In,Ta as Ut,Tb as xs,U as ee,Ua as Le,Ub as Fc,V as Je,Va as wh,Vb as Di,W as F_,Wa as X_,Wb as Oi,X as te,Xa as Rc,Xb as dv,Y as dh,Ya as Mc,Yb as hv,Z as q,Za as Eh,Zb as fv,_ as $,_a as Dc,_b as pv,a as A_,aa as Ai,ab as bh,ac as mv,b as S_,ba as L_,bb as Oc,bc as Lc,c as tn,ca as wt,cb as Is,d as rh,da as Rt,db as me,e as ih,ea as U_,eb as Ih,f as Pt,fa as Si,fb as _,g as Ft,ga as Ee,gb as v,h as Ic,ha as Ce,hb as _e,i as P_,ia as rn,ib as jt,j as bn,ja as j_,jb as ye,k as vs,ka as on,kb as ce,l as Tc,la as fh,lb as kc,m as Pe,ma as B_,mb as E,n as X,na as Es,nb as Gt,o as ws,oa as ph,ob as Te,p as x_,pa as sn,pb as J_,q as R_,qa as Ne,qb as Et,r as Z,ra as mh,rb as Ct,s as Ac,sa as q_,sb as bt,t as xt,ta as Or,tb as Tn,u as oh,ua as gh,ub as Z_,v as M_,va as Pi,vb as ev,w as sh,wa as z_,wb as xi,x as D_,xa as yh,xb as Ri,y as O_,ya as $_,yb as Vc,z as vt,za as Lt,zb as Ts}from"./chunk-EO3H2UQM.js";import{a as z,b as ge,e as nh,f as k}from"./chunk-KT3CPUTC.js";var Os=class{},qc=class{},Ur=class r{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let n=t.indexOf(":");if(n>0){let i=t.slice(0,n),o=t.slice(n+1).trim();this.addHeaderEntry(i,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.addHeaderEntry(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof r?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new r;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof r?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(c=>o.indexOf(c)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let n=e.toLowerCase();this.maybeSetNormalizedName(e,n),this.headers.has(n)?this.headers.get(n).push(t):this.headers.set(n,[t])}setHeaderEntries(e,t){let n=(Array.isArray(t)?t:[t]).map(o=>o.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var Nh=class{encodeKey(e){return Iv(e)}encodeValue(e){return Iv(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function RT(r,e){let t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{let o=i.indexOf("="),[s,c]=o==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,o)),e.decodeValue(i.slice(o+1))],l=t.get(s)||[];l.push(c),t.set(s,l)}),t}var MT=/%(\d[a-f0-9])/gi,DT={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Iv(r){return encodeURIComponent(r).replace(MT,(e,t)=>DT[t]??e)}function Bc(r){return`${r}`}var Jn=class r{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new Nh,e.fromString){if(e.fromObject)throw new he(2805,!1);this.map=RT(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let n=e.fromObject[t],i=Array.isArray(n)?n.map(Bc):[Bc(n)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(n=>{let i=e[n];Array.isArray(i)?i.forEach(o=>{t.push({param:n,value:o,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new r({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(Bc(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let n=this.map.get(e.param)||[],i=n.indexOf(Bc(e.value));i!==-1&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Fh=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function OT(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Tv(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function Av(r){return typeof Blob<"u"&&r instanceof Blob}function Sv(r){return typeof FormData<"u"&&r instanceof FormData}function kT(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}var Pv="Content-Type",xv="Accept",Ov="X-Request-URL",kv="text/plain",Vv="application/json",VT=`${Vv}, ${kv}, */*`,Ds=class r{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(e,t,n,i){this.url=t,this.method=e.toUpperCase();let o;if(OT(this.method)||i?(this.body=n!==void 0?n:null,o=i):o=n,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),this.transferCache=o.transferCache),this.headers??=new Ur,this.context??=new Fh,!this.params)this.params=new Jn,this.urlWithParams=t;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=t;else{let c=t.indexOf("?"),l=c===-1?"?":c<t.length-1?"&":"";this.urlWithParams=t+l+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Tv(this.body)||Av(this.body)||Sv(this.body)||kT(this.body)?this.body:this.body instanceof Jn?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Sv(this.body)?null:Av(this.body)?this.body.type||null:Tv(this.body)?null:typeof this.body=="string"?kv:this.body instanceof Jn?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?Vv:null}clone(e={}){let t=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,o=e.transferCache??this.transferCache,s=e.body!==void 0?e.body:this.body,c=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,d=e.headers||this.headers,f=e.params||this.params,p=e.context??this.context;return e.setHeaders!==void 0&&(d=Object.keys(e.setHeaders).reduce((g,b)=>g.set(b,e.setHeaders[b]),d)),e.setParams&&(f=Object.keys(e.setParams).reduce((g,b)=>g.set(b,e.setParams[b]),f)),new r(t,n,s,{params:f,headers:d,context:p,reportProgress:l,responseType:i,withCredentials:c,transferCache:o})}},ki=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(ki||{}),ks=class{headers;status;statusText;url;ok;type;constructor(e,t=200,n="OK"){this.headers=e.headers||new Ur,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Lh=class r extends ks{constructor(e={}){super(e)}type=ki.ResponseHeader;clone(e={}){return new r({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},zc=class r extends ks{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=ki.Response;clone(e={}){return new r({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},$c=class extends ks{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},NT=200,FT=204;function Vh(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials,transferCache:r.transferCache}}var Sn=(()=>{class r{handler;constructor(t){this.handler=t}request(t,n,i={}){let o;if(t instanceof Ds)o=t;else{let l;i.headers instanceof Ur?l=i.headers:l=new Ur(i.headers);let d;i.params&&(i.params instanceof Jn?d=i.params:d=new Jn({fromObject:i.params})),o=new Ds(t,n,i.body!==void 0?i.body:null,{headers:l,context:i.context,params:d,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let s=X(o).pipe(Hn(l=>this.handler.handle(l)));if(t instanceof Ds||i.observe==="events")return s;let c=s.pipe(vt(l=>l instanceof zc));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(Z(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new he(2806,!1);return l.body}));case"blob":return c.pipe(Z(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new he(2807,!1);return l.body}));case"text":return c.pipe(Z(l=>{if(l.body!==null&&typeof l.body!="string")throw new he(2808,!1);return l.body}));case"json":default:return c.pipe(Z(l=>l.body))}case"response":return c;default:throw new he(2809,!1)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:new Jn().append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,i={}){return this.request("PATCH",t,Vh(i,n))}post(t,n,i={}){return this.request("POST",t,Vh(i,n))}put(t,n,i={}){return this.request("PUT",t,Vh(i,n))}static \u0275fac=function(n){return new(n||r)(q(Os))};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})();var LT=new te("");function Nv(r,e){return e(r)}function UT(r,e){return(t,n)=>e.intercept(t,{handle:i=>r(i,n)})}function jT(r,e,t){return(n,i)=>Rt(t,()=>e(n,o=>r(o,i)))}var BT=new te(""),Uh=new te(""),qT=new te(""),Fv=new te("",{providedIn:"root",factory:()=>!0});function zT(){let r=null;return(e,t)=>{r===null&&(r=($(BT,{optional:!0})??[]).reduceRight(UT,Nv));let n=$(Es);if($(Fv)){let o=n.add();return r(e,t).pipe(Dr(()=>n.remove(o)))}else return r(e,t)}}var Rv=(()=>{class r extends Os{backend;injector;chain=null;pendingTasks=$(Es);contributeToStability=$(Fv);constructor(t,n){super(),this.backend=t,this.injector=n}handle(t){if(this.chain===null){let n=Array.from(new Set([...this.injector.get(Uh),...this.injector.get(qT,[])]));this.chain=n.reduceRight((i,o)=>jT(i,o,this.injector),Nv)}if(this.contributeToStability){let n=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(Dr(()=>this.pendingTasks.remove(n)))}else return this.chain(t,n=>this.backend.handle(n))}static \u0275fac=function(n){return new(n||r)(q(qc),q(wt))};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})();var $T=/^\)\]\}',?\n/,GT=RegExp(`^${Ov}:`,"m");function WT(r){return"responseURL"in r&&r.responseURL?r.responseURL:GT.test(r.getAllResponseHeaders())?r.getResponseHeader(Ov):null}var Mv=(()=>{class r{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new he(-2800,!1);let n=this.xhrFactory;return(n.\u0275loadImpl?Pe(n.\u0275loadImpl()):X(null)).pipe(ze(()=>new tn(o=>{let s=n.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((O,R)=>s.setRequestHeader(O,R.join(","))),t.headers.has(xv)||s.setRequestHeader(xv,VT),!t.headers.has(Pv)){let O=t.detectContentTypeHeader();O!==null&&s.setRequestHeader(Pv,O)}if(t.responseType){let O=t.responseType.toLowerCase();s.responseType=O!=="json"?O:"text"}let c=t.serializeBody(),l=null,d=()=>{if(l!==null)return l;let O=s.statusText||"OK",R=new Ur(s.getAllResponseHeaders()),K=WT(s)||t.url;return l=new Lh({headers:R,status:s.status,statusText:O,url:K}),l},f=()=>{let{headers:O,status:R,statusText:K,url:Q}=d(),L=null;R!==FT&&(L=typeof s.response>"u"?s.responseText:s.response),R===0&&(R=L?NT:0);let J=R>=200&&R<300;if(t.responseType==="json"&&typeof L=="string"){let ne=L;L=L.replace($T,"");try{L=L!==""?JSON.parse(L):null}catch(re){L=ne,J&&(J=!1,L={error:re,text:L})}}J?(o.next(new zc({body:L,headers:O,status:R,statusText:K,url:Q||void 0})),o.complete()):o.error(new $c({error:L,headers:O,status:R,statusText:K,url:Q||void 0}))},p=O=>{let{url:R}=d(),K=new $c({error:O,status:s.status||0,statusText:s.statusText||"Unknown Error",url:R||void 0});o.error(K)},g=!1,b=O=>{g||(o.next(d()),g=!0);let R={type:ki.DownloadProgress,loaded:O.loaded};O.lengthComputable&&(R.total=O.total),t.responseType==="text"&&s.responseText&&(R.partialText=s.responseText),o.next(R)},V=O=>{let R={type:ki.UploadProgress,loaded:O.loaded};O.lengthComputable&&(R.total=O.total),o.next(R)};return s.addEventListener("load",f),s.addEventListener("error",p),s.addEventListener("timeout",p),s.addEventListener("abort",p),t.reportProgress&&(s.addEventListener("progress",b),c!==null&&s.upload&&s.upload.addEventListener("progress",V)),s.send(c),o.next({type:ki.Sent}),()=>{s.removeEventListener("error",p),s.removeEventListener("abort",p),s.removeEventListener("load",f),s.removeEventListener("timeout",p),t.reportProgress&&(s.removeEventListener("progress",b),c!==null&&s.upload&&s.upload.removeEventListener("progress",V)),s.readyState!==s.DONE&&s.abort()}})))}static \u0275fac=function(n){return new(n||r)(q(Lc))};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})(),Lv=new te(""),KT="XSRF-TOKEN",HT=new te("",{providedIn:"root",factory:()=>KT}),QT="X-XSRF-TOKEN",YT=new te("",{providedIn:"root",factory:()=>QT}),Gc=class{},XT=(()=>{class r{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,n,i){this.doc=t,this.platform=n,this.cookieName=i}getToken(){if(this.platform==="server")return null;let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Fc(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(n){return new(n||r)(q(mt),q(Lt),q(HT))};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})();function JT(r,e){let t=r.url.toLowerCase();if(!$(Lv)||r.method==="GET"||r.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(r);let n=$(Gc).getToken(),i=$(YT);return n!=null&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,n)})),e(r)}var Uv=function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r}(Uv||{});function ZT(r,e){return{\u0275kind:r,\u0275providers:e}}function eA(...r){let e=[Sn,Mv,Rv,{provide:Os,useExisting:Rv},{provide:qc,useFactory:()=>$(LT,{optional:!0})??$(Mv)},{provide:Uh,useValue:JT,multi:!0},{provide:Lv,useValue:!0},{provide:Gc,useClass:XT}];for(let t of r)e.push(...t.\u0275providers);return Ai(e)}var Dv=new te("");function tA(){return ZT(Uv.LegacyInterceptors,[{provide:Dv,useFactory:zT},{provide:Uh,useExisting:Dv,multi:!0}])}var jv=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=Ze({type:r});static \u0275inj=Je({providers:[eA(tA())]})}return r})();var Bh=class extends av{supportsDOMEvents=!0},qh=class r extends Bh{static makeCurrent(){sv(new r)}onAndCancel(e,t,n,i){return e.addEventListener(t,n,i),()=>{e.removeEventListener(t,n,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=rA();return t==null?null:iA(t)}resetBaseElement(){Vs=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Fc(document.cookie,e)}},Vs=null;function rA(){return Vs=Vs||document.querySelector("base"),Vs?Vs.getAttribute("href"):null}function iA(r){return new URL(r,document.baseURI).pathname}var zh=class{addToWindow(e){Qn.getAngularTestability=(n,i=!0)=>{let o=e.findTestabilityInTree(n,i);if(o==null)throw new he(5103,!1);return o},Qn.getAllAngularTestabilities=()=>e.getAllTestabilities(),Qn.getAllAngularRootElements=()=>e.getAllRootElements();let t=n=>{let i=Qn.getAllAngularTestabilities(),o=i.length,s=function(){o--,o==0&&n()};i.forEach(c=>{c.whenStable(s)})};Qn.frameworkStabilizers||(Qn.frameworkStabilizers=[]),Qn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,n){if(t==null)return null;let i=e.getTestability(t);return i??(n?Nr().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},oA=(()=>{class r{build(){return new XMLHttpRequest}static \u0275fac=function(n){return new(n||r)};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})(),$h=new te(""),Gv=(()=>{class r{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,n){this._zone=n,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,n,i,o){return this._findPluginFor(n).addEventListener(t,n,i,o)}getZone(){return this._zone}_findPluginFor(t){let n=this._eventNameToPlugin.get(t);if(n)return n;if(n=this._plugins.find(o=>o.supports(t)),!n)throw new he(5101,!1);return this._eventNameToPlugin.set(t,n),n}static \u0275fac=function(n){return new(n||r)(q($h),q(Ne))};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})(),Hc=class{_doc;constructor(e){this._doc=e}manager},Kc="ng-app-id";function Bv(r){for(let e of r)e.remove()}function qv(r,e){let t=e.createElement("style");return t.textContent=r,t}function sA(r,e,t,n){let i=r.head?.querySelectorAll(`style[${Kc}="${e}"],link[${Kc}="${e}"]`);if(i)for(let o of i)o.removeAttribute(Kc),o instanceof HTMLLinkElement?n.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function Gh(r,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",r),t}var Wv=(()=>{class r{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,n,i,o={}){this.doc=t,this.appId=n,this.nonce=i,this.isServer=Fr(o),sA(t,n,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,n){for(let i of t)this.addUsage(i,this.inline,qv);n?.forEach(i=>this.addUsage(i,this.external,Gh))}removeStyles(t,n){for(let i of t)this.removeUsage(i,this.inline);n?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,n,i){let o=n.get(t);o?o.usage++:n.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(t,this.doc)))})}removeUsage(t,n){let i=n.get(t);i&&(i.usage--,i.usage<=0&&(Bv(i.elements),n.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Bv(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[n,{elements:i}]of this.inline)i.push(this.addElement(t,qv(n,this.doc)));for(let[n,{elements:i}]of this.external)i.push(this.addElement(t,Gh(n,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,n){return this.nonce&&n.setAttribute("nonce",this.nonce),this.isServer&&n.setAttribute(Kc,this.appId),t.appendChild(n)}static \u0275fac=function(n){return new(n||r)(q(mt),q(yh),q(_h,8),q(Lt))};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})(),jh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Kh=/%COMP%/g;var Kv="%COMP%",aA=`_nghost-${Kv}`,cA=`_ngcontent-${Kv}`,lA=!0,uA=new te("",{providedIn:"root",factory:()=>lA});function dA(r){return cA.replace(Kh,r)}function hA(r){return aA.replace(Kh,r)}function Hv(r,e){return e.map(t=>t.replace(Kh,r))}var Qc=(()=>{class r{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,n,i,o,s,c,l,d=null,f=null){this.eventManager=t,this.sharedStylesHost=n,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=c,this.ngZone=l,this.nonce=d,this.tracingService=f,this.platformIsServer=Fr(c),this.defaultRenderer=new Ns(t,s,l,this.platformIsServer,this.tracingService)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;this.platformIsServer&&n.encapsulation===Cs.ShadowDom&&(n=ge(z({},n),{encapsulation:Cs.Emulated}));let i=this.getOrCreateRenderer(t,n);return i instanceof Yc?i.applyToHost(t):i instanceof Fs&&i.applyStyles(),i}getOrCreateRenderer(t,n){let i=this.rendererByCompId,o=i.get(n.id);if(!o){let s=this.doc,c=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,p=this.platformIsServer,g=this.tracingService;switch(n.encapsulation){case Cs.Emulated:o=new Yc(l,d,n,this.appId,f,s,c,p,g);break;case Cs.ShadowDom:return new Wh(l,d,t,n,s,c,this.nonce,p,g);default:o=new Fs(l,d,n,f,s,c,p,g);break}i.set(n.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(n){return new(n||r)(q(Gv),q(Wv),q(yh),q(uA),q(mt),q(Lt),q(Ne),q(_h),q(W_,8))};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})(),Ns=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,n,i,o){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(jh[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(zv(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(zv(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){t.remove()}selectRootElement(e,t){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new he(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;let o=jh[i];o?e.setAttributeNS(o,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){let i=jh[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(bs.DashCase|bs.Important)?e.style.setProperty(t,n,i&bs.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&bs.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e!=null&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n,i){if(typeof e=="string"&&(e=Nr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);let o=this.decoratePreventDefault(n);return this.tracingService!==null&&this.tracingService.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function zv(r){return r.tagName==="TEMPLATE"&&r.content!==void 0}var Wh=class extends Ns{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,n,i,o,s,c,l,d){super(e,o,s,l,d),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let f=i.styles;f=Hv(i.id,f);for(let g of f){let b=document.createElement("style");c&&b.setAttribute("nonce",c),b.textContent=g,this.shadowRoot.appendChild(b)}let p=i.getExternalStyles?.();if(p)for(let g of p){let b=Gh(g,o);c&&b.setAttribute("nonce",c),this.shadowRoot.appendChild(b)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Fs=class extends Ns{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,n,i,o,s,c,l,d){super(e,o,s,c,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let f=n.styles;this.styles=d?Hv(d,f):f,this.styleUrls=n.getExternalStyles?.(d)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Yc=class extends Fs{contentAttr;hostAttr;constructor(e,t,n,i,o,s,c,l,d){let f=i+"-"+n.id;super(e,t,n,o,s,c,l,d,f),this.contentAttr=dA(f),this.hostAttr=hA(f)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}},fA=(()=>{class r extends Hc{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,i,o){return t.addEventListener(n,i,o),()=>this.removeEventListener(t,n,i,o)}removeEventListener(t,n,i,o){return t.removeEventListener(n,i,o)}static \u0275fac=function(n){return new(n||r)(q(mt))};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})(),$v=["alt","control","meta","shift"],pA={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},mA={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey},gA=(()=>{class r extends Hc{constructor(t){super(t)}supports(t){return r.parseEventName(t)!=null}addEventListener(t,n,i,o){let s=r.parseEventName(n),c=r.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Nr().onAndCancel(t,s.domEventName,c,o))}static parseEventName(t){let n=t.toLowerCase().split("."),i=n.shift();if(n.length===0||!(i==="keydown"||i==="keyup"))return null;let o=r._normalizeKey(n.pop()),s="",c=n.indexOf("code");if(c>-1&&(n.splice(c,1),s="code."),$v.forEach(d=>{let f=n.indexOf(d);f>-1&&(n.splice(f,1),s+=d+".")}),s+=o,n.length!=0||o.length===0)return null;let l={};return l.domEventName=i,l.fullKey=s,l}static matchEventFullKeyCode(t,n){let i=pA[t.key]||t.key,o="";return n.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),$v.forEach(s=>{if(s!==i){let c=mA[s];c(t)&&(o+=s+".")}}),o+=i,o===n)}static eventCallback(t,n,i){return o=>{r.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>n(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(n){return new(n||r)(q(mt))};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})();function yA(){qh.makeCurrent()}function _A(){return new mh}function vA(){return z_(document),document}var wA=[{provide:Lt,useValue:pv},{provide:$_,useValue:yA,multi:!0},{provide:mt,useFactory:vA,deps:[]}],Qv=nv(rv,"browser",wA);var EA=[{provide:Rc,useClass:zh,deps:[]},{provide:X_,useClass:Mc,deps:[Ne,Eh,Rc]},{provide:Mc,useClass:Mc,deps:[Ne,Eh,Rc]}],CA=[{provide:L_,useValue:"root"},{provide:mh,useFactory:_A,deps:[]},{provide:$h,useClass:fA,multi:!0,deps:[mt]},{provide:$h,useClass:gA,multi:!0,deps:[mt]},Qc,Wv,Gv,{provide:Pc,useExisting:Qc},{provide:Lc,useClass:oA,deps:[]},[]],Yv=(()=>{class r{constructor(){}static \u0275fac=function(n){return new(n||r)};static \u0275mod=Ze({type:r});static \u0275inj=Je({providers:[...CA,...EA],imports:[fv,iv]})}return r})();var Xv=(()=>{class r{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(n){return new(n||r)(q(mt))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var a0=(()=>{class r{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,n){this._renderer=t,this._elementRef=n}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(n){return new(n||r)(oe(kr),oe(Or))};static \u0275dir=Ge({type:r})}return r})(),il=(()=>{class r extends a0{static \u0275fac=(()=>{let t;return function(i){return(t||(t=rn(r)))(i||r)}})();static \u0275dir=Ge({type:r,features:[Ut]})}return r})(),$s=new te("");var bA={provide:$s,useExisting:In(()=>Zn),multi:!0};function IA(){let r=Nr()?Nr().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}var TA=new te(""),Zn=(()=>{class r extends a0{_compositionMode;_composing=!1;constructor(t,n,i){super(t,n),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!IA())}writeValue(t){let n=t??"";this.setProperty("value",n)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(n){return new(n||r)(oe(kr),oe(Or),oe(TA,8))};static \u0275dir=Ge({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){n&1&&ye("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},standalone:!1,features:[Tn([bA]),Ut]})}return r})();function c0(r){return r==null||(typeof r=="string"||Array.isArray(r))&&r.length===0}var ol=new te(""),l0=new te("");function AA(r){return c0(r.value)?{required:!0}:null}function SA(r){if(!r)return Hh;let e,t;return typeof r=="string"?(t="",r.charAt(0)!=="^"&&(t+="^"),t+=r,r.charAt(r.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=r.toString(),e=r),n=>{if(c0(n.value))return null;let i=n.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function Hh(r){return null}function u0(r){return r!=null}function d0(r){return Dc(r)?Pe(r):r}function h0(r){let e={};return r.forEach(t=>{e=t!=null?z(z({},e),t):e}),Object.keys(e).length===0?null:e}function f0(r,e){return e.map(t=>t(r))}function PA(r){return!r.validate}function p0(r){return r.map(e=>PA(e)?e:t=>e.validate(t))}function xA(r){if(!r)return null;let e=r.filter(u0);return e.length==0?null:function(t){return h0(f0(t,e))}}function Yh(r){return r!=null?xA(p0(r)):null}function RA(r){if(!r)return null;let e=r.filter(u0);return e.length==0?null:function(t){let n=f0(t,e).map(d0);return D_(n).pipe(Z(h0))}}function Xh(r){return r!=null?RA(p0(r)):null}function Zv(r,e){return r===null?[e]:Array.isArray(r)?[...r,e]:[r,e]}function MA(r){return r._rawValidators}function DA(r){return r._rawAsyncValidators}function Qh(r){return r?Array.isArray(r)?r:[r]:[]}function Jc(r,e){return Array.isArray(r)?r.includes(e):r===e}function e0(r,e){let t=Qh(e);return Qh(r).forEach(i=>{Jc(t,i)||t.push(i)}),t}function t0(r,e){return Qh(e).filter(t=>!Jc(r,t))}var Zc=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Yh(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Xh(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Li=class extends Zc{name;get formDirective(){return null}get path(){return null}},zs=class extends Zc{_parent=null;name=null;valueAccessor=null},el=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},OA={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},OD=ge(z({},OA),{"[class.ng-submitted]":"isSubmitted"}),ji=(()=>{class r extends el{constructor(t){super(t)}static \u0275fac=function(n){return new(n||r)(oe(zs,2))};static \u0275dir=Ge({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){n&2&&Ih("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Ut]})}return r})(),m0=(()=>{class r extends el{constructor(t){super(t)}static \u0275fac=function(n){return new(n||r)(oe(Li,10))};static \u0275dir=Ge({type:r,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,i){n&2&&Ih("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[Ut]})}return r})();var Ls="VALID",Xc="INVALID",Ni="PENDING",Us="DISABLED",Ui=class{},tl=class extends Ui{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Bs=class extends Ui{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},qs=class extends Ui{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Fi=class extends Ui{status;source;constructor(e,t){super(),this.status=e,this.source=t}};function g0(r){return(sl(r)?r.validators:r)||null}function kA(r){return Array.isArray(r)?Yh(r):r||null}function y0(r,e){return(sl(e)?e.asyncValidators:r)||null}function VA(r){return Array.isArray(r)?Xh(r):r||null}function sl(r){return r!=null&&!Array.isArray(r)&&typeof r=="object"}function NA(r,e,t){let n=r.controls;if(!(e?Object.keys(n):n).length)throw new he(1e3,"");if(!n[t])throw new he(1001,"")}function FA(r,e,t){r._forEachChild((n,i)=>{if(t[i]===void 0)throw new he(1002,"")})}var nl=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return An(this.statusReactive)}set status(e){An(()=>this.statusReactive.set(e))}_status=Mi(()=>this.statusReactive());statusReactive=Pi(void 0);get valid(){return this.status===Ls}get invalid(){return this.status===Xc}get pending(){return this.status==Ni}get disabled(){return this.status===Us}get enabled(){return this.status!==Us}errors;get pristine(){return An(this.pristineReactive)}set pristine(e){An(()=>this.pristineReactive.set(e))}_pristine=Mi(()=>this.pristineReactive());pristineReactive=Pi(!0);get dirty(){return!this.pristine}get touched(){return An(this.touchedReactive)}set touched(e){An(()=>this.touchedReactive.set(e))}_touched=Mi(()=>this.touchedReactive());touchedReactive=Pi(!1);get untouched(){return!this.touched}_events=new Pt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(e0(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(e0(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(t0(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(t0(e,this._rawAsyncValidators))}hasValidator(e){return Jc(this._rawValidators,e)}hasAsyncValidator(e){return Jc(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(ge(z({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new qs(!0,n))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:n})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n),t&&e.emitEvent!==!1&&this._events.next(new qs(!1,n))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(ge(z({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new Bs(!1,n))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),t&&e.emitEvent!==!1&&this._events.next(new Bs(!0,n))}markAsPending(e={}){this.status=Ni;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Fi(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(ge(z({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Us,this.errors=null,this._forEachChild(i=>{i.disable(ge(z({},e),{onlySelf:!0}))}),this._updateValue();let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new tl(this.value,n)),this._events.next(new Fi(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ge(z({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Ls,this._forEachChild(n=>{n.enable(ge(z({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ge(z({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ls||this.status===Ni)&&this._runAsyncValidator(n,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new tl(this.value,t)),this._events.next(new Fi(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(ge(z({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Us:Ls}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Ni,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let n=d0(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((n,i)=>n&&n._find(i),this)}getError(e,t){let n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,n){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||n)&&this._events.next(new Fi(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,n)}_initObservables(){this.valueChanges=new sn,this.statusChanges=new sn}_calculateStatus(){return this._allControlsDisabled()?Us:this.errors?Xc:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ni)?Ni:this._anyControlsHaveStatus(Xc)?Xc:Ls}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let n=!this._anyControlsDirty(),i=this.pristine!==n;this.pristine=n,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Bs(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new qs(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){sl(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=kA(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=VA(this._rawAsyncValidators)}},rl=class extends nl{constructor(e,t,n){super(g0(t),y0(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){FA(this,!0,e),Object.keys(e).forEach(n=>{NA(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(n=>{let i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,i)=>{n.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>n._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((i,o)=>{n=t(n,i,o)}),n}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Jh=new te("",{providedIn:"root",factory:()=>Zh}),Zh="always";function LA(r,e){return[...e.path,r]}function _0(r,e,t=Zh){v0(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(r.disabled),jA(r,e),qA(r,e),BA(r,e),UA(r,e)}function n0(r,e){r.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function UA(r,e){if(e.valueAccessor.setDisabledState){let t=n=>{e.valueAccessor.setDisabledState(n)};r.registerOnDisabledChange(t),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(t)})}}function v0(r,e){let t=MA(r);e.validator!==null?r.setValidators(Zv(t,e.validator)):typeof t=="function"&&r.setValidators([t]);let n=DA(r);e.asyncValidator!==null?r.setAsyncValidators(Zv(n,e.asyncValidator)):typeof n=="function"&&r.setAsyncValidators([n]);let i=()=>r.updateValueAndValidity();n0(e._rawValidators,i),n0(e._rawAsyncValidators,i)}function jA(r,e){e.valueAccessor.registerOnChange(t=>{r._pendingValue=t,r._pendingChange=!0,r._pendingDirty=!0,r.updateOn==="change"&&w0(r,e)})}function BA(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,r.updateOn==="blur"&&r._pendingChange&&w0(r,e),r.updateOn!=="submit"&&r.markAsTouched()})}function w0(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function qA(r,e){let t=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};r.registerOnChange(t),e._registerOnDestroy(()=>{r._unregisterOnChange(t)})}function zA(r,e){r==null,v0(r,e)}function $A(r,e){if(!r.hasOwnProperty("model"))return!1;let t=r.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function GA(r){return Object.getPrototypeOf(r.constructor)===il}function WA(r,e){r._syncPendingControls(),e.forEach(t=>{let n=t.control;n.updateOn==="submit"&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function KA(r,e){if(!e)return null;Array.isArray(e);let t,n,i;return e.forEach(o=>{o.constructor===Zn?t=o:GA(o)?n=o:i=o}),i||n||t||null}var HA={provide:Li,useExisting:In(()=>ef)},js=Promise.resolve(),ef=(()=>{class r extends Li{callSetDisabledState;get submitted(){return An(this.submittedReactive)}_submitted=Mi(()=>this.submittedReactive());submittedReactive=Pi(!1);_directives=new Set;form;ngSubmit=new sn;options;constructor(t,n,i){super(),this.callSetDisabledState=i,this.form=new rl({},Yh(t),Xh(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){js.then(()=>{let n=this._findContainer(t.path);t.control=n.registerControl(t.name,t.control),_0(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){js.then(()=>{let n=this._findContainer(t.path);n&&n.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){js.then(()=>{let n=this._findContainer(t.path),i=new rl({});zA(i,t),n.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){js.then(()=>{let n=this._findContainer(t.path);n&&n.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,n){js.then(()=>{this.form.get(t.path).setValue(n)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),WA(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(n){return new(n||r)(oe(ol,10),oe(l0,10),oe(Jh,8))};static \u0275dir=Ge({type:r,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,i){n&1&&ye("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Tn([HA]),Ut]})}return r})();function r0(r,e){let t=r.indexOf(e);t>-1&&r.splice(t,1)}function i0(r){return typeof r=="object"&&r!==null&&Object.keys(r).length===2&&"value"in r&&"disabled"in r}var QA=class extends nl{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,n){super(g0(t),y0(n,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),sl(t)&&(t.nonNullable||t.initialValueIsDefault)&&(i0(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){r0(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){r0(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){i0(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var YA={provide:zs,useExisting:In(()=>jr)},o0=Promise.resolve(),jr=(()=>{class r extends zs{_changeDetectorRef;callSetDisabledState;control=new QA;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new sn;constructor(t,n,i,o,s,c){super(),this._changeDetectorRef=s,this.callSetDisabledState=c,this._parent=t,this._setValidators(n),this._setAsyncValidators(i),this.valueAccessor=KA(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),$A(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){_0(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){o0.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let n=t.isDisabled.currentValue,i=n!==0&&Vr(n);o0.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?LA(t,this._parent):[t]}static \u0275fac=function(n){return new(n||r)(oe(Li,9),oe(ol,10),oe(l0,10),oe($s,10),oe(Ss,8),oe(Jh,8))};static \u0275dir=Ge({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Tn([YA]),Ut,Si]})}return r})(),E0=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275dir=Ge({type:r,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return r})(),XA={provide:$s,useExisting:In(()=>tf),multi:!0},tf=(()=>{class r extends il{writeValue(t){let n=t??"";this.setProperty("value",n)}registerOnChange(t){this.onChange=n=>{t(n==""?null:parseFloat(n))}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=rn(r)))(i||r)}})();static \u0275dir=Ge({type:r,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(n,i){n&1&&ye("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},standalone:!1,features:[Tn([XA]),Ut]})}return r})();var JA={provide:$s,useExisting:In(()=>al),multi:!0};function C0(r,e){return r==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${r}: ${e}`.slice(0,50))}function ZA(r){return r.split(":")[0]}var al=(()=>{class r extends il{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let n=this._getOptionId(t),i=C0(n,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=n=>{this.value=this._getOptionValue(n),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n),t))return n;return null}_getOptionValue(t){let n=ZA(t);return this._optionMap.has(n)?this._optionMap.get(n):t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=rn(r)))(i||r)}})();static \u0275dir=Ge({type:r,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,i){n&1&&ye("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Tn([JA]),Ut]})}return r})(),b0=(()=>{class r{_element;_renderer;_select;id;constructor(t,n,i){this._element=t,this._renderer=n,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(C0(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(n){return new(n||r)(oe(Or),oe(kr),oe(al,9))};static \u0275dir=Ge({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return r})(),eS={provide:$s,useExisting:In(()=>I0),multi:!0};function s0(r,e){return r==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${r}: ${e}`.slice(0,50))}function tS(r){return r.split(":")[0]}var I0=(()=>{class r extends il{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let n;if(Array.isArray(t)){let i=t.map(o=>this._getOptionId(o));n=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else n=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(n)}registerOnChange(t){this.onChange=n=>{let i=[],o=n.selectedOptions;if(o!==void 0){let s=o;for(let c=0;c<s.length;c++){let l=s[c],d=this._getOptionValue(l.value);i.push(d)}}else{let s=n.options;for(let c=0;c<s.length;c++){let l=s[c];if(l.selected){let d=this._getOptionValue(l.value);i.push(d)}}}this.value=i,t(i)}}_registerOption(t){let n=(this._idCounter++).toString();return this._optionMap.set(n,t),n}_getOptionId(t){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n)._value,t))return n;return null}_getOptionValue(t){let n=tS(t);return this._optionMap.has(n)?this._optionMap.get(n)._value:t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=rn(r)))(i||r)}})();static \u0275dir=Ge({type:r,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,i){n&1&&ye("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Tn([eS]),Ut]})}return r})(),T0=(()=>{class r{_element;_renderer;_select;id;_value;constructor(t,n,i){this._element=t,this._renderer=n,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(s0(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(s0(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(n){return new(n||r)(oe(Or),oe(kr),oe(I0,9))};static \u0275dir=Ge({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return r})();var A0=(()=>{class r{_validator=Hh;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let n=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(n),this._validator=this._enabled?this.createValidator(n):Hh,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(n){return new(n||r)};static \u0275dir=Ge({type:r,features:[Si]})}return r})();var nS={provide:ol,useExisting:In(()=>Gs),multi:!0};var Gs=(()=>{class r extends A0{required;inputName="required";normalizeInput=Vr;createValidator=t=>AA;enabled(t){return t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=rn(r)))(i||r)}})();static \u0275dir=Ge({type:r,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,i){n&2&&Is("required",i._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Tn([nS]),Ut]})}return r})();var rS={provide:ol,useExisting:In(()=>nf),multi:!0},nf=(()=>{class r extends A0{pattern;inputName="pattern";normalizeInput=t=>t;createValidator=t=>SA(t);static \u0275fac=(()=>{let t;return function(i){return(t||(t=rn(r)))(i||r)}})();static \u0275dir=Ge({type:r,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(n,i){n&2&&Is("pattern",i._enabled?i.pattern:null)},inputs:{pattern:"pattern"},standalone:!1,features:[Tn([rS]),Ut]})}return r})();var iS=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=Ze({type:r});static \u0275inj=Je({})}return r})();var S0=(()=>{class r{static withConfig(t){return{ngModule:r,providers:[{provide:Jh,useValue:t.callSetDisabledState??Zh}]}}static \u0275fac=function(n){return new(n||r)};static \u0275mod=Ze({type:r});static \u0275inj=Je({imports:[iS]})}return r})();var ae="primary",ia=Symbol("RouteTitle"),lf=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Wi(r){return new lf(r)}function oS(r,e,t){let n=t.path.split("/");if(n.length>r.length||t.pathMatch==="full"&&(e.hasChildren()||n.length<r.length))return null;let i={};for(let o=0;o<n.length;o++){let s=n[o],c=r[o];if(s[0]===":")i[s.substring(1)]=c;else if(s!==c.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function sS(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!cn(r[t],e[t]))return!1;return!0}function cn(r,e){let t=r?uf(r):void 0,n=e?uf(e):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!F0(r[i],e[i]))return!1;return!0}function uf(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function F0(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;let t=[...r].sort(),n=[...e].sort();return t.every((i,o)=>n[o]===i)}else return r===e}function L0(r){return r.length>0?r[r.length-1]:null}function tr(r){return x_(r)?r:Dc(r)?Pe(Promise.resolve(r)):X(r)}var aS={exact:j0,subset:B0},U0={exact:cS,subset:lS,ignored:()=>!0};function P0(r,e,t){return aS[t.paths](r.root,e.root,t.matrixParams)&&U0[t.queryParams](r.queryParams,e.queryParams)&&!(t.fragment==="exact"&&r.fragment!==e.fragment)}function cS(r,e){return cn(r,e)}function j0(r,e,t){if(!qr(r.segments,e.segments)||!ul(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!r.children[n]||!j0(r.children[n],e.children[n],t))return!1;return!0}function lS(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>F0(r[t],e[t]))}function B0(r,e,t){return q0(r,e,e.segments,t)}function q0(r,e,t,n){if(r.segments.length>t.length){let i=r.segments.slice(0,t.length);return!(!qr(i,t)||e.hasChildren()||!ul(i,t,n))}else if(r.segments.length===t.length){if(!qr(r.segments,t)||!ul(r.segments,t,n))return!1;for(let i in e.children)if(!r.children[i]||!B0(r.children[i],e.children[i],n))return!1;return!0}else{let i=t.slice(0,r.segments.length),o=t.slice(r.segments.length);return!qr(r.segments,i)||!ul(r.segments,i,n)||!r.children[ae]?!1:q0(r.children[ae],e,o,n)}}function ul(r,e,t){return e.every((n,i)=>U0[t](r[i].parameters,n.parameters))}var xn=class{root;queryParams;fragment;_queryParamMap;constructor(e=new ve([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=Wi(this.queryParams),this._queryParamMap}toString(){return hS.serialize(this)}},ve=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return dl(this)}},Br=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Wi(this.parameters),this._parameterMap}toString(){return $0(this)}};function uS(r,e){return qr(r,e)&&r.every((t,n)=>cn(t.parameters,e[n].parameters))}function qr(r,e){return r.length!==e.length?!1:r.every((t,n)=>t.path===e[n].path)}function dS(r,e){let t=[];return Object.entries(r.children).forEach(([n,i])=>{n===ae&&(t=t.concat(e(i,n)))}),Object.entries(r.children).forEach(([n,i])=>{n!==ae&&(t=t.concat(e(i,n)))}),t}var oa=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275prov=ee({token:r,factory:()=>new Ki,providedIn:"root"})}return r})(),Ki=class{parse(e){let t=new hf(e);return new xn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Ws(e.root,!0)}`,n=mS(e.queryParams),i=typeof e.fragment=="string"?`#${fS(e.fragment)}`:"";return`${t}${n}${i}`}},hS=new Ki;function dl(r){return r.segments.map(e=>$0(e)).join("/")}function Ws(r,e){if(!r.hasChildren())return dl(r);if(e){let t=r.children[ae]?Ws(r.children[ae],!1):"",n=[];return Object.entries(r.children).forEach(([i,o])=>{i!==ae&&n.push(`${i}:${Ws(o,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}else{let t=dS(r,(n,i)=>i===ae?[Ws(r.children[ae],!1)]:[`${i}:${Ws(n,!1)}`]);return Object.keys(r.children).length===1&&r.children[ae]!=null?`${dl(r)}/${t[0]}`:`${dl(r)}/(${t.join("//")})`}}function z0(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function cl(r){return z0(r).replace(/%3B/gi,";")}function fS(r){return encodeURI(r)}function df(r){return z0(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function hl(r){return decodeURIComponent(r)}function x0(r){return hl(r.replace(/\+/g,"%20"))}function $0(r){return`${df(r.path)}${pS(r.parameters)}`}function pS(r){return Object.entries(r).map(([e,t])=>`;${df(e)}=${df(t)}`).join("")}function mS(r){let e=Object.entries(r).map(([t,n])=>Array.isArray(n)?n.map(i=>`${cl(t)}=${cl(i)}`).join("&"):`${cl(t)}=${cl(n)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var gS=/^[^\/()?;#]+/;function of(r){let e=r.match(gS);return e?e[0]:""}var yS=/^[^\/()?;=#]+/;function _S(r){let e=r.match(yS);return e?e[0]:""}var vS=/^[^=?&#]+/;function wS(r){let e=r.match(vS);return e?e[0]:""}var ES=/^[^&#]+/;function CS(r){let e=r.match(ES);return e?e[0]:""}var hf=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ve([],{}):new ve([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[ae]=new ve(e,t)),n}parseSegment(){let e=of(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new he(4009,!1);return this.capture(e),new Br(hl(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=_S(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let i=of(this.remaining);i&&(n=i,this.capture(n))}e[hl(t)]=hl(n)}parseQueryParam(e){let t=wS(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let s=CS(this.remaining);s&&(n=s,this.capture(n))}let i=x0(t),o=x0(n);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=of(this.remaining),i=this.remaining[n.length];if(i!=="/"&&i!==")"&&i!==";")throw new he(4010,!1);let o;n.indexOf(":")>-1?(o=n.slice(0,n.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=ae);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[ae]:new ve([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new he(4011,!1)}};function G0(r){return r.segments.length>0?new ve([],{[ae]:r}):r}function W0(r){let e={};for(let[n,i]of Object.entries(r.children)){let o=W0(i);if(n===ae&&o.segments.length===0&&o.hasChildren())for(let[s,c]of Object.entries(o.children))e[s]=c;else(o.segments.length>0||o.hasChildren())&&(e[n]=o)}let t=new ve(r.segments,e);return bS(t)}function bS(r){if(r.numberOfChildren===1&&r.children[ae]){let e=r.children[ae];return new ve(r.segments.concat(e.segments),e.children)}return r}function zr(r){return r instanceof xn}function IS(r,e,t=null,n=null){let i=K0(r);return H0(i,e,t,n)}function K0(r){let e;function t(o){let s={};for(let l of o.children){let d=t(l);s[l.outlet]=d}let c=new ve(o.url,s);return o===r&&(e=c),c}let n=t(r.root),i=G0(n);return e??i}function H0(r,e,t,n){let i=r;for(;i.parent;)i=i.parent;if(e.length===0)return sf(i,i,i,t,n);let o=TS(e);if(o.toRoot())return sf(i,i,new ve([],{}),t,n);let s=AS(o,i,r),c=s.processChildren?Hs(s.segmentGroup,s.index,o.commands):Y0(s.segmentGroup,s.index,o.commands);return sf(i,s.segmentGroup,c,t,n)}function fl(r){return typeof r=="object"&&r!=null&&!r.outlets&&!r.segmentPath}function Xs(r){return typeof r=="object"&&r!=null&&r.outlets}function sf(r,e,t,n,i){let o={};n&&Object.entries(n).forEach(([l,d])=>{o[l]=Array.isArray(d)?d.map(f=>`${f}`):`${d}`});let s;r===e?s=t:s=Q0(r,e,t);let c=G0(W0(s));return new xn(c,o,i)}function Q0(r,e,t){let n={};return Object.entries(r.children).forEach(([i,o])=>{o===e?n[i]=t:n[i]=Q0(o,e,t)}),new ve(r.segments,n)}var pl=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&fl(n[0]))throw new he(4003,!1);let i=n.find(Xs);if(i&&i!==L0(n))throw new he(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function TS(r){if(typeof r[0]=="string"&&r.length===1&&r[0]==="/")return new pl(!0,0,r);let e=0,t=!1,n=r.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let c={};return Object.entries(o.outlets).forEach(([l,d])=>{c[l]=typeof d=="string"?d.split("/"):d}),[...i,{outlets:c}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((c,l)=>{l==0&&c==="."||(l==0&&c===""?t=!0:c===".."?e++:c!=""&&i.push(c))}),i):[...i,o]},[]);return new pl(t,e,n)}var zi=class{segmentGroup;processChildren;index;constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}};function AS(r,e,t){if(r.isAbsolute)return new zi(e,!0,0);if(!t)return new zi(e,!1,NaN);if(t.parent===null)return new zi(t,!0,0);let n=fl(r.commands[0])?0:1,i=t.segments.length-1+n;return SS(t,i,r.numberOfDoubleDots)}function SS(r,e,t){let n=r,i=e,o=t;for(;o>i;){if(o-=i,n=n.parent,!n)throw new he(4005,!1);i=n.segments.length}return new zi(n,!1,i-o)}function PS(r){return Xs(r[0])?r[0].outlets:{[ae]:r}}function Y0(r,e,t){if(r??=new ve([],{}),r.segments.length===0&&r.hasChildren())return Hs(r,e,t);let n=xS(r,e,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){let o=new ve(r.segments.slice(0,n.pathIndex),{});return o.children[ae]=new ve(r.segments.slice(n.pathIndex),r.children),Hs(o,0,i)}else return n.match&&i.length===0?new ve(r.segments,{}):n.match&&!r.hasChildren()?ff(r,e,t):n.match?Hs(r,0,i):ff(r,e,t)}function Hs(r,e,t){if(t.length===0)return new ve(r.segments,{});{let n=PS(t),i={};if(Object.keys(n).some(o=>o!==ae)&&r.children[ae]&&r.numberOfChildren===1&&r.children[ae].segments.length===0){let o=Hs(r.children[ae],e,t);return new ve(r.segments,o.children)}return Object.entries(n).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=Y0(r.children[o],e,s))}),Object.entries(r.children).forEach(([o,s])=>{n[o]===void 0&&(i[o]=s)}),new ve(r.segments,i)}}function xS(r,e,t){let n=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=t.length)return o;let s=r.segments[i],c=t[n];if(Xs(c))break;let l=`${c}`,d=n<t.length-1?t[n+1]:null;if(i>0&&l===void 0)break;if(l&&d&&typeof d=="object"&&d.outlets===void 0){if(!M0(l,d,s))return o;n+=2}else{if(!M0(l,{},s))return o;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}function ff(r,e,t){let n=r.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Xs(o)){let l=RS(o.outlets);return new ve(n,l)}if(i===0&&fl(t[0])){let l=r.segments[e];n.push(new Br(l.path,R0(t[0]))),i++;continue}let s=Xs(o)?o.outlets[ae]:`${o}`,c=i<t.length-1?t[i+1]:null;s&&c&&fl(c)?(n.push(new Br(s,R0(c))),i+=2):(n.push(new Br(s,{})),i++)}return new ve(n,{})}function RS(r){let e={};return Object.entries(r).forEach(([t,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[t]=ff(new ve([],{}),0,n))}),e}function R0(r){let e={};return Object.entries(r).forEach(([t,n])=>e[t]=`${n}`),e}function M0(r,e,t){return r==t.path&&cn(e,t.parameters)}var Qs="imperative",et=function(r){return r[r.NavigationStart=0]="NavigationStart",r[r.NavigationEnd=1]="NavigationEnd",r[r.NavigationCancel=2]="NavigationCancel",r[r.NavigationError=3]="NavigationError",r[r.RoutesRecognized=4]="RoutesRecognized",r[r.ResolveStart=5]="ResolveStart",r[r.ResolveEnd=6]="ResolveEnd",r[r.GuardsCheckStart=7]="GuardsCheckStart",r[r.GuardsCheckEnd=8]="GuardsCheckEnd",r[r.RouteConfigLoadStart=9]="RouteConfigLoadStart",r[r.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",r[r.ChildActivationStart=11]="ChildActivationStart",r[r.ChildActivationEnd=12]="ChildActivationEnd",r[r.ActivationStart=13]="ActivationStart",r[r.ActivationEnd=14]="ActivationEnd",r[r.Scroll=15]="Scroll",r[r.NavigationSkipped=16]="NavigationSkipped",r}(et||{}),Bt=class{id;url;constructor(e,t){this.id=e,this.url=t}},Hi=class extends Bt{type=et.NavigationStart;navigationTrigger;restoredState;constructor(e,t,n="imperative",i=null){super(e,t),this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ln=class extends Bt{urlAfterRedirects;type=et.NavigationEnd;constructor(e,t,n){super(e,t),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Dt=function(r){return r[r.Redirect=0]="Redirect",r[r.SupersededByNewNavigation=1]="SupersededByNewNavigation",r[r.NoDataFromResolver=2]="NoDataFromResolver",r[r.GuardRejected=3]="GuardRejected",r}(Dt||{}),ml=function(r){return r[r.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",r[r.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",r}(ml||{}),Pn=class extends Bt{reason;code;type=et.NavigationCancel;constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},er=class extends Bt{reason;code;type=et.NavigationSkipped;constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i}},Js=class extends Bt{error;target;type=et.NavigationError;constructor(e,t,n,i){super(e,t),this.error=n,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},gl=class extends Bt{urlAfterRedirects;state;type=et.RoutesRecognized;constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},pf=class extends Bt{urlAfterRedirects;state;type=et.GuardsCheckStart;constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},mf=class extends Bt{urlAfterRedirects;state;shouldActivate;type=et.GuardsCheckEnd;constructor(e,t,n,i,o){super(e,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},gf=class extends Bt{urlAfterRedirects;state;type=et.ResolveStart;constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},yf=class extends Bt{urlAfterRedirects;state;type=et.ResolveEnd;constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},_f=class{route;type=et.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},vf=class{route;type=et.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},wf=class{snapshot;type=et.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ef=class{snapshot;type=et.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Cf=class{snapshot;type=et.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},bf=class{snapshot;type=et.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yl=class{routerEvent;position;anchor;type=et.Scroll;constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Zs=class{},Qi=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function MS(r,e){return r.providers&&!r._injector&&(r._injector=vh(r.providers,e,`Route: ${r.path}`)),r._injector??e}function Wt(r){return r.outlet||ae}function DS(r,e){let t=r.filter(n=>Wt(n)===e);return t.push(...r.filter(n=>Wt(n)!==e)),t}function sa(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var If=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return sa(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new aa(this.rootInjector)}},aa=(()=>{class r{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,n){let i=this.getOrCreateContext(t);i.outlet=n,this.contexts.set(t,i)}onChildOutletDestroyed(t){let n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new If(this.rootInjector),this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(n){return new(n||r)(q(wt))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),_l=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Tf(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){let t=Tf(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Af(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Af(e,this._root).map(t=>t.value)}};function Tf(r,e){if(r===e.value)return e;for(let t of e.children){let n=Tf(r,t);if(n)return n}return null}function Af(r,e){if(r===e.value)return[e];for(let t of e.children){let n=Af(r,t);if(n.length)return n.unshift(e),n}return[]}var Mt=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function qi(r){let e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}var vl=class extends _l{snapshot;constructor(e,t){super(e),this.snapshot=t,Vf(this,e)}toString(){return this.snapshot.toString()}};function X0(r){let e=OS(r),t=new Ft([new Br("",{})]),n=new Ft({}),i=new Ft({}),o=new Ft({}),s=new Ft(""),c=new Rn(t,n,o,s,i,ae,r,e.root);return c.snapshot=e.root,new vl(new Mt(c,[]),e)}function OS(r){let e={},t={},n={},i="",o=new $i([],e,n,i,t,ae,r,null,{});return new El("",new Mt(o,[]))}var Rn=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,n,i,o,s,c,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=c,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Z(d=>d[ia]))??X(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Z(e=>Wi(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Z(e=>Wi(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function wl(r,e,t="emptyOnly"){let n,{routeConfig:i}=r;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:z(z({},e.params),r.params),data:z(z({},e.data),r.data),resolve:z(z(z(z({},r.data),e.data),i?.data),r._resolvedData)}:n={params:z({},r.params),data:z({},r.data),resolve:z(z({},r.data),r._resolvedData??{})},i&&Z0(i)&&(n.resolve[ia]=i.title),n}var $i=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[ia]}constructor(e,t,n,i,o,s,c,l,d){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=o,this.outlet=s,this.component=c,this.routeConfig=l,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Wi(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Wi(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},El=class extends _l{url;constructor(e,t){super(t),this.url=e,Vf(this,t)}toString(){return J0(this._root)}};function Vf(r,e){e.value._routerState=r,e.children.forEach(t=>Vf(r,t))}function J0(r){let e=r.children.length>0?` { ${r.children.map(J0).join(", ")} } `:"";return`${r.value}${e}`}function af(r){if(r.snapshot){let e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,cn(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),cn(e.params,t.params)||r.paramsSubject.next(t.params),sS(e.url,t.url)||r.urlSubject.next(t.url),cn(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function Sf(r,e){let t=cn(r.params,e.params)&&uS(r.url,e.url),n=!r.parent!=!e.parent;return t&&!n&&(!r.parent||Sf(r.parent,e.parent))}function Z0(r){return typeof r.title=="string"||r.title===null}var kS=new te(""),Nf=(()=>{class r{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=ae;activateEvents=new sn;deactivateEvents=new sn;attachEvents=new sn;detachEvents=new sn;routerOutletData=q_(void 0);parentContexts=$(aa);location=$(Q_);changeDetector=$(Ss);inputBinder=$(Al,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:n,previousValue:i}=t.name;if(n)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new he(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new he(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new he(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new he(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new Pf(t,c,i.injector,this.routerOutletData);this.activated=i.createComponent(s,{index:i.length,injector:l,environmentInjector:n}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(n){return new(n||r)};static \u0275dir=Ge({type:r,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Si]})}return r})(),Pf=class r{route;childContexts;parent;outletData;__ngOutletInjector(e){return new r(this.route,this.childContexts,e,this.outletData)}constructor(e,t,n,i){this.route=e,this.childContexts=t,this.parent=n,this.outletData=i}get(e,t){return e===Rn?this.route:e===aa?this.childContexts:e===kS?this.outletData:this.parent.get(e,t)}},Al=new te(""),D0=(()=>{class r{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:n}=t,i=Ac([n.queryParams,n.params,n.data]).pipe(ze(([o,s,c],l)=>(c=z(z(z({},o),s),c),l===0?X(c):Promise.resolve(c)))).subscribe(o=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==n||n.component===null){this.unsubscribeFromRouteData(t);return}let s=ov(n.component);if(!s){this.unsubscribeFromRouteData(t);return}for(let{templateName:c}of s.inputs)t.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(t,i)}static \u0275fac=function(n){return new(n||r)};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})();function VS(r,e,t){let n=ea(r,e._root,t?t._root:void 0);return new vl(n,e)}function ea(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){let n=t.value;n._futureSnapshot=e.value;let i=NS(r,e,t);return new Mt(n,i)}else{if(r.shouldAttach(e.value)){let o=r.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(c=>ea(r,c)),s}}let n=FS(e.value),i=e.children.map(o=>ea(r,o));return new Mt(n,i)}}function NS(r,e,t){return e.children.map(n=>{for(let i of t.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return ea(r,n,i);return ea(r,n)})}function FS(r){return new Rn(new Ft(r.url),new Ft(r.params),new Ft(r.queryParams),new Ft(r.fragment),new Ft(r.data),r.outlet,r.component,r)}var ta=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},ew="ngNavigationCancelingError";function Cl(r,e){let{redirectTo:t,navigationBehaviorOptions:n}=zr(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=tw(!1,Dt.Redirect);return i.url=t,i.navigationBehaviorOptions=n,i}function tw(r,e){let t=new Error(`NavigationCancelingError: ${r||""}`);return t[ew]=!0,t.cancellationCode=e,t}function LS(r){return nw(r)&&zr(r.url)}function nw(r){return!!r&&r[ew]}var US=(r,e,t,n)=>Z(i=>(new xf(e,i.targetRouterState,i.currentRouterState,t,n).activate(r),i)),xf=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,n,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),af(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){let i=qi(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],n),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,n)})}deactivateRoutes(e,t,n){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=n.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,n);else o&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,o=qi(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(n&&n.outlet){let s=n.outlet.detach(),c=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){let n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,o=qi(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){let i=qi(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],n),this.forwardEvent(new bf(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Ef(e.value.snapshot))}activateRoutes(e,t,n){let i=e.value,o=t?t.value:null;if(af(i),i===o)if(i.component){let s=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,n);else if(i.component){let s=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let c=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(c.contexts),s.attachRef=c.componentRef,s.route=c.route.value,s.outlet&&s.outlet.attach(c.componentRef,c.route.value),af(c.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,n)}},bl=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Gi=class{component;route;constructor(e,t){this.component=e,this.route=t}};function jS(r,e,t){let n=r._root,i=e?e._root:null;return Ks(n,i,t,[n.value])}function BS(r){let e=r.routeConfig?r.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:r,guards:e}}function Xi(r,e){let t=Symbol(),n=e.get(r,t);return n===t?typeof r=="function"&&!F_(r)?r:e.get(r):n}function Ks(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=qi(e);return r.children.forEach(s=>{qS(s,o[s.value.outlet],t,n.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,c])=>Ys(c,t.getContext(s),i)),i}function qS(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=r.value,s=e?e.value:null,c=t?t.getContext(r.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=zS(s,o,o.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new bl(n)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Ks(r,e,c?c.children:null,n,i):Ks(r,e,t,n,i),l&&c&&c.outlet&&c.outlet.isActivated&&i.canDeactivateChecks.push(new Gi(c.outlet.component,s))}else s&&Ys(e,c,i),i.canActivateChecks.push(new bl(n)),o.component?Ks(r,null,c?c.children:null,n,i):Ks(r,null,t,n,i);return i}function zS(r,e,t){if(typeof t=="function")return t(r,e);switch(t){case"pathParamsChange":return!qr(r.url,e.url);case"pathParamsOrQueryParamsChange":return!qr(r.url,e.url)||!cn(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Sf(r,e)||!cn(r.queryParams,e.queryParams);case"paramsChange":default:return!Sf(r,e)}}function Ys(r,e,t){let n=qi(r),i=r.value;Object.entries(n).forEach(([o,s])=>{i.component?e?Ys(s,e.children.getContext(o),t):Ys(s,null,t):Ys(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Gi(e.outlet.component,i)):t.canDeactivateChecks.push(new Gi(null,i)):t.canDeactivateChecks.push(new Gi(null,i))}function ca(r){return typeof r=="function"}function $S(r){return typeof r=="boolean"}function GS(r){return r&&ca(r.canLoad)}function WS(r){return r&&ca(r.canActivate)}function KS(r){return r&&ca(r.canActivateChild)}function HS(r){return r&&ca(r.canDeactivate)}function QS(r){return r&&ca(r.canMatch)}function rw(r){return r instanceof R_||r?.name==="EmptyError"}var ll=Symbol("INITIAL_VALUE");function Yi(){return ze(r=>Ac(r.map(e=>e.pipe(bi(1),Ti(ll)))).pipe(Z(e=>{for(let t of e)if(t!==!0){if(t===ll)return ll;if(t===!1||YS(t))return t}return!0}),vt(e=>e!==ll),bi(1)))}function YS(r){return zr(r)||r instanceof ta}function XS(r,e){return xt(t=>{let{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?X(ge(z({},t),{guardsResult:!0})):JS(s,n,i,r).pipe(xt(c=>c&&$S(c)?ZS(n,o,r,e):X(c)),Z(c=>ge(z({},t),{guardsResult:c})))})}function JS(r,e,t,n){return Pe(r).pipe(xt(i=>iP(i.component,i.route,t,e,n)),nn(i=>i!==!0,!0))}function ZS(r,e,t,n){return Pe(e).pipe(Hn(i=>M_(tP(i.route.parent,n),eP(i.route,n),rP(r,i.path,t),nP(r,i.route,t))),nn(i=>i!==!0,!0))}function eP(r,e){return r!==null&&e&&e(new Cf(r)),X(!0)}function tP(r,e){return r!==null&&e&&e(new wf(r)),X(!0)}function nP(r,e,t){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return X(!0);let i=n.map(o=>sh(()=>{let s=sa(e)??t,c=Xi(o,s),l=WS(c)?c.canActivate(e,r):Rt(s,()=>c(e,r));return tr(l).pipe(nn())}));return X(i).pipe(Yi())}function rP(r,e,t){let n=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>BS(s)).filter(s=>s!==null).map(s=>sh(()=>{let c=s.guards.map(l=>{let d=sa(s.node)??t,f=Xi(l,d),p=KS(f)?f.canActivateChild(n,r):Rt(d,()=>f(n,r));return tr(p).pipe(nn())});return X(c).pipe(Yi())}));return X(o).pipe(Yi())}function iP(r,e,t,n,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return X(!0);let s=o.map(c=>{let l=sa(e)??i,d=Xi(c,l),f=HS(d)?d.canDeactivate(r,e,t,n):Rt(l,()=>d(r,e,t,n));return tr(f).pipe(nn())});return X(s).pipe(Yi())}function oP(r,e,t,n){let i=e.canLoad;if(i===void 0||i.length===0)return X(!0);let o=i.map(s=>{let c=Xi(s,r),l=GS(c)?c.canLoad(e,t):Rt(r,()=>c(e,t));return tr(l)});return X(o).pipe(Yi(),iw(n))}function iw(r){return S_(nt(e=>{if(typeof e!="boolean")throw Cl(r,e)}),Z(e=>e===!0))}function sP(r,e,t,n){let i=e.canMatch;if(!i||i.length===0)return X(!0);let o=i.map(s=>{let c=Xi(s,r),l=QS(c)?c.canMatch(e,t):Rt(r,()=>c(e,t));return tr(l)});return X(o).pipe(Yi(),iw(n))}var na=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},ra=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function Bi(r){return ws(new na(r))}function aP(r){return ws(new he(4e3,!1))}function cP(r){return ws(tw(!1,Dt.GuardRejected))}var Rf=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),i.numberOfChildren===0)return X(n);if(i.numberOfChildren>1||!i.children[ae])return aP(`${e.redirectTo}`);i=i.children[ae]}}applyRedirectCommands(e,t,n,i,o){if(typeof t!="string"){let c=t,{queryParams:l,fragment:d,routeConfig:f,url:p,outlet:g,params:b,data:V,title:O}=i,R=Rt(o,()=>c({params:b,data:V,queryParams:l,fragment:d,routeConfig:f,url:p,outlet:g,title:O}));if(R instanceof xn)throw new ra(R);t=R}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n);if(t[0]==="/")throw new ra(s);return s}applyRedirectCreateUrlTree(e,t,n,i){let o=this.createSegmentGroup(e,t.root,n,i);return new xn(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let n={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let c=o.substring(1);n[i]=t[c]}else n[i]=o}),n}createSegmentGroup(e,t,n,i){let o=this.createSegments(e,t.segments,n,i),s={};return Object.entries(t.children).forEach(([c,l])=>{s[c]=this.createSegmentGroup(e,l,n,i)}),new ve(o,s)}createSegments(e,t,n,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,n))}findPosParam(e,t,n){let i=n[t.path.substring(1)];if(!i)throw new he(4001,!1);return i}findOrReturn(e,t){let n=0;for(let i of t){if(i.path===e.path)return t.splice(n),i;n++}return e}},Mf={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function lP(r,e,t,n,i){let o=ow(r,e,t);return o.matched?(n=MS(e,n),sP(n,e,t,i).pipe(Z(s=>s===!0?o:z({},Mf)))):X(o)}function ow(r,e,t){if(e.path==="**")return uP(t);if(e.path==="")return e.pathMatch==="full"&&(r.hasChildren()||t.length>0)?z({},Mf):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||oS)(t,r,e);if(!i)return z({},Mf);let o={};Object.entries(i.posParams??{}).forEach(([c,l])=>{o[c]=l.path});let s=i.consumed.length>0?z(z({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function uP(r){return{matched:!0,parameters:r.length>0?L0(r).parameters:{},consumedSegments:r,remainingSegments:[],positionalParamSegments:{}}}function O0(r,e,t,n){return t.length>0&&fP(r,t,n)?{segmentGroup:new ve(e,hP(n,new ve(t,r.children))),slicedSegments:[]}:t.length===0&&pP(r,t,n)?{segmentGroup:new ve(r.segments,dP(r,t,n,r.children)),slicedSegments:t}:{segmentGroup:new ve(r.segments,r.children),slicedSegments:t}}function dP(r,e,t,n){let i={};for(let o of t)if(Sl(r,e,o)&&!n[Wt(o)]){let s=new ve([],{});i[Wt(o)]=s}return z(z({},n),i)}function hP(r,e){let t={};t[ae]=e;for(let n of r)if(n.path===""&&Wt(n)!==ae){let i=new ve([],{});t[Wt(n)]=i}return t}function fP(r,e,t){return t.some(n=>Sl(r,e,n)&&Wt(n)!==ae)}function pP(r,e,t){return t.some(n=>Sl(r,e,n))}function Sl(r,e,t){return(r.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function mP(r,e,t){return e.length===0&&!r.children[t]}var Df=class{};function gP(r,e,t,n,i,o,s="emptyOnly"){return new Of(r,e,t,n,i,s,o).recognize()}var yP=31,Of=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,n,i,o,s,c){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=c,this.applyRedirects=new Rf(this.urlSerializer,this.urlTree)}noMatchError(e){return new he(4002,`'${e.segmentGroup}'`)}recognize(){let e=O0(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Z(({children:t,rootSnapshot:n})=>{let i=new Mt(n,t),o=new El("",i),s=IS(n,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new $i([],Object.freeze({}),Object.freeze(z({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ae,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,ae,t).pipe(Z(n=>({children:n,rootSnapshot:t})),Ci(n=>{if(n instanceof ra)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof na?this.noMatchError(n):n}))}processSegmentGroup(e,t,n,i,o){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,t,n,o):this.processSegment(e,t,n,n.segments,i,!0,o).pipe(Z(s=>s instanceof Mt?[s]:[]))}processChildren(e,t,n,i){let o=[];for(let s of Object.keys(n.children))s==="primary"?o.unshift(s):o.push(s);return Pe(o).pipe(Hn(s=>{let c=n.children[s],l=DS(t,s);return this.processSegmentGroup(e,l,c,s,i)}),Ii((s,c)=>(s.push(...c),s)),ah(null),V_(),xt(s=>{if(s===null)return Bi(n);let c=sw(s);return _P(c),X(c)}))}processSegment(e,t,n,i,o,s,c){return Pe(t).pipe(Hn(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,n,i,o,s,c).pipe(Ci(d=>{if(d instanceof na)return X(null);throw d}))),nn(l=>!!l),Ci(l=>{if(rw(l))return mP(n,i,o)?X(new Df):Bi(n);throw l}))}processSegmentAgainstRoute(e,t,n,i,o,s,c,l){return Wt(n)!==s&&(s===ae||!Sl(i,o,n))?Bi(i):n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,n,o,s,l):this.allowRedirects&&c?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,n,o,s,l):Bi(i)}expandSegmentAgainstRouteUsingRedirect(e,t,n,i,o,s,c){let{matched:l,parameters:d,consumedSegments:f,positionalParamSegments:p,remainingSegments:g}=ow(t,i,o);if(!l)return Bi(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>yP&&(this.allowRedirects=!1));let b=new $i(o,d,Object.freeze(z({},this.urlTree.queryParams)),this.urlTree.fragment,k0(i),Wt(i),i.component??i._loadedComponent??null,i,V0(i)),V=wl(b,c,this.paramsInheritanceStrategy);b.params=Object.freeze(V.params),b.data=Object.freeze(V.data);let O=this.applyRedirects.applyRedirectCommands(f,i.redirectTo,p,b,e);return this.applyRedirects.lineralizeSegments(i,O).pipe(xt(R=>this.processSegment(e,n,t,R.concat(g),s,!1,c)))}matchSegmentAgainstRoute(e,t,n,i,o,s){let c=lP(t,n,i,e,this.urlSerializer);return n.path==="**"&&(t.children={}),c.pipe(ze(l=>l.matched?(e=n._injector??e,this.getChildConfig(e,n,i).pipe(ze(({routes:d})=>{let f=n._loadedInjector??e,{parameters:p,consumedSegments:g,remainingSegments:b}=l,V=new $i(g,p,Object.freeze(z({},this.urlTree.queryParams)),this.urlTree.fragment,k0(n),Wt(n),n.component??n._loadedComponent??null,n,V0(n)),O=wl(V,s,this.paramsInheritanceStrategy);V.params=Object.freeze(O.params),V.data=Object.freeze(O.data);let{segmentGroup:R,slicedSegments:K}=O0(t,g,b,d);if(K.length===0&&R.hasChildren())return this.processChildren(f,d,R,V).pipe(Z(L=>new Mt(V,L)));if(d.length===0&&K.length===0)return X(new Mt(V,[]));let Q=Wt(n)===o;return this.processSegment(f,d,R,K,Q?ae:o,!0,V).pipe(Z(L=>new Mt(V,L instanceof Mt?[L]:[])))}))):Bi(t)))}getChildConfig(e,t,n){return t.children?X({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?X({routes:t._loadedRoutes,injector:t._loadedInjector}):oP(e,t,n,this.urlSerializer).pipe(xt(i=>i?this.configLoader.loadChildren(e,t).pipe(nt(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):cP(t))):X({routes:[],injector:e})}};function _P(r){r.sort((e,t)=>e.value.outlet===ae?-1:t.value.outlet===ae?1:e.value.outlet.localeCompare(t.value.outlet))}function vP(r){let e=r.value.routeConfig;return e&&e.path===""}function sw(r){let e=[],t=new Set;for(let n of r){if(!vP(n)){e.push(n);continue}let i=e.find(o=>n.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...n.children),t.add(i)):e.push(n)}for(let n of t){let i=sw(n.children);e.push(new Mt(n.value,i))}return e.filter(n=>!t.has(n))}function k0(r){return r.data||{}}function V0(r){return r.resolve||{}}function wP(r,e,t,n,i,o){return xt(s=>gP(r,e,t,n,s.extractedUrl,i,o).pipe(Z(({state:c,tree:l})=>ge(z({},s),{targetSnapshot:c,urlAfterRedirects:l}))))}function EP(r,e){return xt(t=>{let{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return X(t);let o=new Set(i.map(l=>l.route)),s=new Set;for(let l of o)if(!s.has(l))for(let d of aw(l))s.add(d);let c=0;return Pe(s).pipe(Hn(l=>o.has(l)?CP(l,n,r,e):(l.data=wl(l,l.parent,r).resolve,X(void 0))),nt(()=>c++),ch(1),xt(l=>c===s.size?X(t):bn))})}function aw(r){let e=r.children.map(t=>aw(t)).flat();return[r,...e]}function CP(r,e,t,n){let i=r.routeConfig,o=r._resolve;return i?.title!==void 0&&!Z0(i)&&(o[ia]=i.title),bP(o,r,e,n).pipe(Z(s=>(r._resolvedData=s,r.data=wl(r,r.parent,t).resolve,null)))}function bP(r,e,t,n){let i=uf(r);if(i.length===0)return X({});let o={};return Pe(i).pipe(xt(s=>IP(r[s],e,t,n).pipe(nn(),nt(c=>{if(c instanceof ta)throw Cl(new Ki,c);o[s]=c}))),ch(1),Z(()=>o),Ci(s=>rw(s)?bn:ws(s)))}function IP(r,e,t,n){let i=sa(e)??n,o=Xi(r,i),s=o.resolve?o.resolve(e,t):Rt(i,()=>o(e,t));return tr(s)}function cf(r){return ze(e=>{let t=r(e);return t?Pe(t).pipe(Z(()=>e)):X(e)})}var cw=(()=>{class r{buildTitle(t){let n,i=t.root;for(;i!==void 0;)n=this.getResolvedTitleForRoute(i)??n,i=i.children.find(o=>o.outlet===ae);return n}getResolvedTitleForRoute(t){return t.data[ia]}static \u0275fac=function(n){return new(n||r)};static \u0275prov=ee({token:r,factory:()=>$(TP),providedIn:"root"})}return r})(),TP=(()=>{class r extends cw{title;constructor(t){super(),this.title=t}updateTitle(t){let n=this.buildTitle(t);n!==void 0&&this.title.setTitle(n)}static \u0275fac=function(n){return new(n||r)(q(Xv))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),la=new te("",{providedIn:"root",factory:()=>({})}),AP=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275cmp=$e({type:r,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(n,i){n&1&&_e(0,"router-outlet")},dependencies:[Nf],encapsulation:2})}return r})();function Ff(r){let e=r.children&&r.children.map(Ff),t=e?ge(z({},r),{children:e}):z({},r);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ae&&(t.component=AP),t}var Il=new te(""),Lf=(()=>{class r{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=$(Nc);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return X(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let n=tr(t.loadComponent()).pipe(Z(lw),nt(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),Dr(()=>{this.componentLoaders.delete(t)})),i=new ih(n,()=>new Pt).pipe(rh());return this.componentLoaders.set(t,i),i}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return X({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);let o=SP(n,this.compiler,t,this.onLoadEndListener).pipe(Dr(()=>{this.childrenLoaders.delete(n)})),s=new ih(o,()=>new Pt).pipe(rh());return this.childrenLoaders.set(n,s),s}static \u0275fac=function(n){return new(n||r)};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function SP(r,e,t,n){return tr(r.loadChildren()).pipe(Z(lw),xt(i=>i instanceof Y_||Array.isArray(i)?X(i):Pe(e.compileModuleAsync(i))),Z(i=>{n&&n(r);let o,s,c=!1;return Array.isArray(i)?(s=i,c=!0):(o=i.create(t).injector,s=o.get(Il,[],{optional:!0,self:!0}).flat()),{routes:s.map(Ff),injector:o}}))}function PP(r){return r&&typeof r=="object"&&"default"in r}function lw(r){return PP(r)?r.default:r}var Uf=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275prov=ee({token:r,factory:()=>$(xP),providedIn:"root"})}return r})(),xP=(()=>{class r{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}static \u0275fac=function(n){return new(n||r)};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),uw=new te(""),dw=new te("");function RP(r,e,t){let n=r.get(dw),i=r.get(mt);return r.get(Ne).runOutsideAngular(()=>{if(!i.startViewTransition||n.skipNextTransition)return n.skipNextTransition=!1,new Promise(d=>setTimeout(d));let o,s=new Promise(d=>{o=d}),c=i.startViewTransition(()=>(o(),MP(r))),{onViewTransitionCreated:l}=n;return l&&Rt(r,()=>l({transition:c,from:e,to:t})),s})}function MP(r){return new Promise(e=>{K_({read:()=>setTimeout(e)},{injector:r})})}var hw=new te(""),jf=(()=>{class r{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new Pt;transitionAbortSubject=new Pt;configLoader=$(Lf);environmentInjector=$(wt);destroyRef=$(fh);urlSerializer=$(oa);rootContexts=$(aa);location=$(xs);inputBindingEnabled=$(Al,{optional:!0})!==null;titleStrategy=$(cw);options=$(la,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=$(Uf);createViewTransition=$(uw,{optional:!0});navigationErrorHandler=$(hw,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>X(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new _f(i)),n=i=>this.events.next(new vf(i));this.configLoader.onLoadEndListener=n,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let n=++this.navigationId;this.transitions?.next(ge(z(z({},this.transitions.value),t),{id:n}))}setupNavigations(t,n,i){return this.transitions=new Ft({id:0,currentUrlTree:n,currentRawUrl:n,extractedUrl:this.urlHandlingStrategy.extract(n),urlAfterRedirects:this.urlHandlingStrategy.extract(n),rawUrl:n,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Qs,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(vt(o=>o.id!==0),Z(o=>ge(z({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),ze(o=>{let s=!1,c=!1;return X(o).pipe(ze(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Dt.SupersededByNewNavigation),bn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?ge(z({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),f=l.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!d&&f!=="reload"){let p="";return this.events.next(new er(l.id,this.urlSerializer.serialize(l.rawUrl),p,ml.IgnoredSameUrlNavigation)),l.resolve(!1),bn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return X(l).pipe(ze(p=>{let g=this.transitions?.getValue();return this.events.next(new Hi(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),g!==this.transitions?.getValue()?bn:Promise.resolve(p)}),wP(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),nt(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=ge(z({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let g=new gl(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(g)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:g,source:b,restoredState:V,extras:O}=l,R=new Hi(p,this.urlSerializer.serialize(g),b,V);this.events.next(R);let K=X0(this.rootComponentType).snapshot;return this.currentTransition=o=ge(z({},l),{targetSnapshot:K,urlAfterRedirects:g,extras:ge(z({},O),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=g,X(o)}else{let p="";return this.events.next(new er(l.id,this.urlSerializer.serialize(l.extractedUrl),p,ml.IgnoredByUrlHandlingStrategy)),l.resolve(!1),bn}}),nt(l=>{let d=new pf(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Z(l=>(this.currentTransition=o=ge(z({},l),{guards:jS(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),XS(this.environmentInjector,l=>this.events.next(l)),nt(l=>{if(o.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw Cl(this.urlSerializer,l.guardsResult);let d=new mf(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),vt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Dt.GuardRejected),!1)),cf(l=>{if(l.guards.canActivateChecks.length)return X(l).pipe(nt(d=>{let f=new gf(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}),ze(d=>{let f=!1;return X(d).pipe(EP(this.paramsInheritanceStrategy,this.environmentInjector),nt({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(d,"",Dt.NoDataFromResolver)}}))}),nt(d=>{let f=new yf(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}))}),cf(l=>{let d=f=>{let p=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(f.routeConfig).pipe(nt(g=>{f.component=g}),Z(()=>{})));for(let g of f.children)p.push(...d(g));return p};return Ac(d(l.targetSnapshot.root)).pipe(ah(null),bi(1))}),cf(()=>this.afterPreactivation()),ze(()=>{let{currentSnapshot:l,targetSnapshot:d}=o,f=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return f?Pe(f).pipe(Z(()=>o)):X(o)}),Z(l=>{let d=VS(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=ge(z({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),nt(()=>{this.events.next(new Zs)}),US(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),bi(1),nt({next:l=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ln(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{s=!0}}),N_(this.transitionAbortSubject.pipe(nt(l=>{throw l}))),Dr(()=>{!s&&!c&&this.cancelNavigationTransition(o,"",Dt.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Ci(l=>{if(this.destroyed)return o.resolve(!1),bn;if(c=!0,nw(l))this.events.next(new Pn(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),LS(l)?this.events.next(new Qi(l.url,l.navigationBehaviorOptions)):o.resolve(!1);else{let d=new Js(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0);try{let f=Rt(this.environmentInjector,()=>this.navigationErrorHandler?.(d));if(f instanceof ta){let{message:p,cancellationCode:g}=Cl(this.urlSerializer,f);this.events.next(new Pn(o.id,this.urlSerializer.serialize(o.extractedUrl),p,g)),this.events.next(new Qi(f.redirectTo,f.navigationBehaviorOptions))}else throw this.events.next(d),l}catch(f){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(f)}}return bn}))}))}cancelNavigationTransition(t,n,i){let o=new Pn(t.id,this.urlSerializer.serialize(t.extractedUrl),n,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),n=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==n?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(n){return new(n||r)};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function DP(r){return r!==Qs}var OP=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275prov=ee({token:r,factory:()=>$(kP),providedIn:"root"})}return r})(),kf=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},kP=(()=>{class r extends kf{static \u0275fac=(()=>{let t;return function(i){return(t||(t=rn(r)))(i||r)}})();static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),fw=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275prov=ee({token:r,factory:()=>$(VP),providedIn:"root"})}return r})(),VP=(()=>{class r extends fw{location=$(xs);urlSerializer=$(oa);options=$(la,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=$(Uf);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new xn;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=X0(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(n=>{n.type==="popstate"&&t(n.url,n.state)})}handleRouterEvent(t,n){if(t instanceof Hi)this.stateMemento=this.createStateMemento();else if(t instanceof er)this.rawUrlTree=n.initialUrl;else if(t instanceof gl){if(this.urlUpdateStrategy==="eager"&&!n.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl);this.setBrowserUrl(n.targetBrowserUrl??i,n)}}else t instanceof Zs?(this.currentUrlTree=n.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl),this.routerState=n.targetRouterState,this.urlUpdateStrategy==="deferred"&&!n.extras.skipLocationChange&&this.setBrowserUrl(n.targetBrowserUrl??this.rawUrlTree,n)):t instanceof Pn&&(t.code===Dt.GuardRejected||t.code===Dt.NoDataFromResolver)?this.restoreHistory(n):t instanceof Js?this.restoreHistory(n,!0):t instanceof ln&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,n){let i=t instanceof xn?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||n.extras.replaceUrl){let o=this.browserPageId,s=z(z({},n.extras.state),this.generateNgRouterState(n.id,o));this.location.replaceState(i,"",s)}else{let o=z(z({},n.extras.state),this.generateNgRouterState(n.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(t,n=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===t.finalUrl&&o===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,n){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=rn(r)))(i||r)}})();static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function pw(r,e){r.events.pipe(vt(t=>t instanceof ln||t instanceof Pn||t instanceof Js||t instanceof er),Z(t=>t instanceof ln||t instanceof er?0:(t instanceof Pn?t.code===Dt.Redirect||t.code===Dt.SupersededByNewNavigation:!1)?2:1),vt(t=>t!==2),bi(1)).subscribe(()=>{e()})}var NP={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},FP={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ot=(()=>{class r{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=$(wh);stateManager=$(fw);options=$(la,{optional:!0})||{};pendingTasks=$(Es);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=$(jf);urlSerializer=$(oa);location=$(xs);urlHandlingStrategy=$(Uf);_events=new Pt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=$(OP);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=$(Il,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!$(Al,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new A_;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(n=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(n,o),n instanceof Pn&&n.code!==Dt.Redirect&&n.code!==Dt.SupersededByNewNavigation)this.navigated=!0;else if(n instanceof ln)this.navigated=!0;else if(n instanceof Qi){let s=n.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(n.url,i.currentRawUrl),l=z({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||DP(i.source)},s);this.scheduleNavigation(c,Qs,null,l,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}UP(n)&&this._events.next(n)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Qs,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,n)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",n)},0)})}navigateToSyncWithBrowser(t,n,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let l=z({},i);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(t);this.scheduleNavigation(c,n,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Ff),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,n={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:c,preserveFragment:l}=n,d=l?this.currentUrlTree.fragment:s,f=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":f=z(z({},this.currentUrlTree.queryParams),o);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=o||null}f!==null&&(f=this.removeEmptyProps(f));let p;try{let g=i?i.snapshot:this.routerState.snapshot.root;p=K0(g)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return H0(p,t,f,d??null)}navigateByUrl(t,n={skipLocationChange:!1}){let i=zr(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,Qs,null,n)}navigate(t,n={skipLocationChange:!1}){return LP(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,n){let i;if(n===!0?i=z({},NP):n===!1?i=z({},FP):i=n,zr(t))return P0(this.currentUrlTree,t,i);let o=this.parseUrl(t);return P0(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((n,[i,o])=>(o!=null&&(n[i]=o),n),{})}scheduleNavigation(t,n,i,o,s){if(this.disposed)return Promise.resolve(!1);let c,l,d;s?(c=s.resolve,l=s.reject,d=s.promise):d=new Promise((p,g)=>{c=p,l=g});let f=this.pendingTasks.add();return pw(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:n,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:c,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}static \u0275fac=function(n){return new(n||r)};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function LP(r){for(let e=0;e<r.length;e++)if(r[e]==null)throw new he(4008,!1)}function UP(r){return!(r instanceof Zs)&&!(r instanceof Qi)}var lt=(()=>{class r{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Pt;constructor(t,n,i,o,s,c){this.router=t,this.route=n,this.tabIndexAttribute=i,this.renderer=o,this.el=s,this.locationStrategy=c;let l=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=t.events.subscribe(d=>{d instanceof ln&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(zr(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,n,i,o,s){let c=this.urlTree;if(c===null||this.isAnchorElement&&(t!==0||n||i||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let n=this.href===null?null:H_(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(t,n){let i=this.renderer,o=this.el.nativeElement;n!==null?i.setAttribute(o,t,n):i.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:zr(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(n){return new(n||r)(oe(Ot),oe(Rn),j_("tabindex"),oe(kr),oe(Or),oe(Ps))};static \u0275dir=Ge({type:r,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,i){n&1&&ye("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),n&2&&Is("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Vr],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Vr],replaceUrl:[2,"replaceUrl","replaceUrl",Vr],routerLink:"routerLink"},features:[Si]})}return r})();var Tl=class{};var jP=(()=>{class r{router;injector;preloadingStrategy;loader;subscription;constructor(t,n,i,o,s){this.router=t,this.injector=i,this.preloadingStrategy=o,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(vt(t=>t instanceof ln),Hn(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){let i=[];for(let o of n){o.providers&&!o._injector&&(o._injector=vh(o.providers,t,`Route: ${o.path}`));let s=o._injector??t,c=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(c,o.children??o._loadedRoutes))}return Pe(i).pipe(oh())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let i;n.loadChildren&&n.canLoad===void 0?i=this.loader.loadChildren(t,n):i=X(null);let o=i.pipe(xt(s=>s===null?X(void 0):(n._loadedRoutes=s.routes,n._loadedInjector=s.injector,this.processRoutes(s.injector??t,s.routes))));if(n.loadComponent&&!n._loadedComponent){let s=this.loader.loadComponent(n);return Pe([o,s]).pipe(oh())}else return o})}static \u0275fac=function(n){return new(n||r)(q(Ot),q(Nc),q(wt),q(Tl),q(Lf))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),mw=new te(""),BP=(()=>{class r{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(t,n,i,o,s={}){this.urlSerializer=t,this.transitions=n,this.viewportScroller=i,this.zone=o,this.options=s,s.scrollPositionRestoration||="disabled",s.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Hi?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof ln?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof er&&t.code===ml.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof yl&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new yl(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(n){xc()};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})();function qP(r){return r.routerState.root}function ua(r,e){return{\u0275kind:r,\u0275providers:e}}function zP(){let r=$(on);return e=>{let t=r.get(Oc);if(e!==t.components[0])return;let n=r.get(Ot),i=r.get(gw);r.get(Bf)===1&&n.initialNavigation(),r.get(yw,null,dh.Optional)?.setUpPreloading(),r.get(mw,null,dh.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var gw=new te("",{factory:()=>new Pt}),Bf=new te("",{providedIn:"root",factory:()=>1});function $P(){return ua(2,[{provide:Bf,useValue:0},{provide:Ch,multi:!0,deps:[on],useFactory:e=>{let t=e.get(cv,Promise.resolve());return()=>t.then(()=>new Promise(n=>{let i=e.get(Ot),o=e.get(gw);pw(i,()=>{n(!0)}),e.get(jf).afterPreactivation=()=>(n(!0),o.closed?X(void 0):o),i.initialNavigation()}))}}])}function GP(){return ua(3,[{provide:Ch,multi:!0,useFactory:()=>{let e=$(Ot);return()=>{e.setUpLocationChangeListener()}}},{provide:Bf,useValue:2}])}var yw=new te("");function WP(r){return ua(0,[{provide:yw,useExisting:jP},{provide:Tl,useExisting:r}])}function KP(){return ua(8,[D0,{provide:Al,useExisting:D0}])}function HP(r){let e=[{provide:uw,useValue:RP},{provide:dw,useValue:z({skipNextTransition:!!r?.skipInitialTransition},r)}];return ua(9,e)}var QP=[xs,{provide:oa,useClass:Ki},Ot,aa,{provide:Rn,useFactory:qP,deps:[Ot]},Lf,[]],qf=(()=>{class r{constructor(){}static forRoot(t,n){return{ngModule:r,providers:[QP,[],{provide:Il,multi:!0,useValue:t},[],n?.errorHandler?{provide:hw,useValue:n.errorHandler}:[],{provide:la,useValue:n||{}},n?.useHash?XP():JP(),YP(),n?.preloadingStrategy?WP(n.preloadingStrategy).\u0275providers:[],n?.initialNavigation?ZP(n):[],n?.bindToComponentInputs?KP().\u0275providers:[],n?.enableViewTransitions?HP().\u0275providers:[],ex()]}}static forChild(t){return{ngModule:r,providers:[{provide:Il,multi:!0,useValue:t}]}}static \u0275fac=function(n){return new(n||r)};static \u0275mod=Ze({type:r});static \u0275inj=Je({})}return r})();function YP(){return{provide:mw,useFactory:()=>{let r=$(mv),e=$(Ne),t=$(la),n=$(jf),i=$(oa);return t.scrollOffset&&r.setOffset(t.scrollOffset),new BP(i,n,r,e,t)}}}function XP(){return{provide:Ps,useClass:uv}}function JP(){return{provide:Ps,useClass:lv}}function ZP(r){return[r.initialNavigation==="disabled"?GP().\u0275providers:[],r.initialNavigation==="enabledBlocking"?$P().\u0275providers:[]]}var N0=new te("");function ex(){return[{provide:N0,useFactory:zP},{provide:bh,multi:!0,useExisting:N0}]}var Pl=class r{title="techop-e-commerce";static \u0275fac=function(t){return new(t||r)};static \u0275cmp=$e({type:r,selectors:[["app-root"]],standalone:!1,decls:1,vars:0,template:function(t,n){t&1&&_e(0,"router-outlet")},dependencies:[Nf],encapsulation:2})};var xl=class r{currentYear=new Date().getFullYear();texts=["Bienvenidos a la tienda Techop","aqu\xED encontrar\xE1s todo lo que necesitas para estar a la vanguardia de la tecnolog\xEDa","un espacio para los amantes de los componentes","ordenadores","torres","y mucho m\xE1s"];index=0;ngOnInit(){this.animateText(),setInterval(()=>this.animateText(),3e3)}animateText(){let e=document.getElementById("dynamic-text");e&&(e.innerHTML="",this.texts[this.index].split("").forEach((n,i)=>{let o=document.createElement("span");o.textContent=n,o.style.animationDelay=`${i*.1}s`,e.appendChild(o)}),this.index=(this.index+1)%this.texts.length)}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=$e({type:r,selectors:[["app-home"]],standalone:!1,decls:29,vars:1,consts:[[1,"video-container"],["autoplay","","muted","","loop","","preload","metadata"],["src","assets/videos/video-welcome-home.mp4","type","video/mp4"],[1,"page-content"],[1,"navbar"],[1,"navbar-brand"],["routerLink","/"],[1,"navbar-links"],["routerLink","/about-us"],["routerLink","/products"],["routerLink","/account"],["routerLink","/cart"],[1,"main-container"],[1,"content"],["id","dynamic-text"],[1,"footer"],[1,"footer-bottom"]],template:function(t,n){t&1&&(_(0,"div",0)(1,"video",1),_e(2,"source",2),E(3," Tu navegador no soporta el formato de video. "),v()(),_(4,"div",3)(5,"nav",4)(6,"div",5)(7,"a",6),E(8,"Techop"),v()(),_(9,"ul",7)(10,"li")(11,"a",8),E(12,"Sobre Nosotros"),v()(),_(13,"li")(14,"a",9),E(15,"Productos"),v()(),_(16,"li")(17,"a",10),E(18,"Cuenta"),v()(),_(19,"li")(20,"a",11),E(21,"Carrito de Compra"),v()()()(),_(22,"div",12)(23,"div",13),_e(24,"h1",14),v(),_(25,"footer",15)(26,"div",16)(27,"p"),E(28),v()()()()()),t&2&&(G(28),Te("\xA9 ",n.currentYear," Techop E-commerce. Todos los derechos reservados."))},dependencies:[lt],styles:['*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}@font-face{font-family:BasisGrotesque;src:url("./media/BasisGrotesqueArabicPro-Light-EN3UARNA.woff2") format("woff2");font-weight:400;font-style:normal}.page-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;z-index:1;position:relative}.main-container[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;min-height:100vh}.video-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:-1}.video-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.content[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center;font-size:2.5rem;font-family:BasisGrotesque,sans-serif;color:#fff;text-align:center;z-index:2}.content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;opacity:0;transform:translateY(-100%);animation:_ngcontent-%COMP%_slideIn 1s forwards}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-100%)}to{opacity:1;transform:translateY(0)}}.navbar[_ngcontent-%COMP%]{font-family:BasisGrotesque,sans-serif;position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;color:#fff;z-index:1000}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-transform:uppercase;text-decoration:none;color:#fff;letter-spacing:.15em;display:inline-block;padding:15px 0;position:relative}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.navbar-links[_ngcontent-%COMP%]{list-style:none;display:flex;gap:1.5rem;margin:0;padding:0}.navbar-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:table-cell;position:relative;padding:15px 0}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-transform:uppercase;text-decoration:none;letter-spacing:.15em;display:inline-block;padding:15px 20px;position:relative}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{width:100%;left:0;color:#00fffc}@media screen and (max-height: 300px){.navbar-links[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:40px}}@media (max-width: 768px){.navbar[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:center}.navbar-links[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.content[_ngcontent-ng-c681850442][_ngcontent-%COMP%]{margin-top:25rem;font-size:4vw}}@media (max-width: 480px){.content[_ngcontent-%COMP%]{font-size:6vw;padding:1rem;text-align:center}}.footer[_ngcontent-%COMP%]{background:transparent;color:#fff;padding:1rem 2rem;font-family:BasisGrotesque,sans-serif}.footer-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;gap:2rem;max-width:1200px;margin:0 auto}.footer-column[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1.2rem;border-bottom:2px solid #00fffc;display:inline-block;padding-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#fff;transition:color .3s ease}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.payment-methods[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-top:1rem}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:35px;transition:transform .3s ease}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.footer-bottom[_ngcontent-%COMP%]{text-align:center;margin-top:2rem;font-size:.9rem;border-top:1px solid rgba(255,255,255,.2);padding-top:1rem}']})};var Ji=class r{constructor(e){this.http=e}apiUrl="https://techop-e-commerce.onrender.com/api/productos";getProductos(){return this.http.get(this.apiUrl)}getProductoById(e){return this.http.get(`${this.apiUrl}/${e}`)}static \u0275fac=function(t){return new(t||r)(q(Sn))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})};function tx(r,e){if(r&1){let t=jt();_(0,"div",22),_e(1,"img",23),_(2,"h2"),E(3),v(),_(4,"p"),E(5),v(),_(6,"button",24),ye("click",function(){let i=Ee(t).$implicit,o=ce();return Ce(o.comprar(i))}),E(7,"Comprar"),v()()}if(r&2){let t=e.$implicit;G(),me("src",t.imagen,Yn)("alt",t.nombre),G(2),Gt(t.nombre),G(2),Gt(t.descripcion)}}var Rl=class r{constructor(e,t){this.productService=e;this.router=t}productos=[];currentYear=new Date().getFullYear();filtro="";ngOnInit(){this.cargarProductos()}cargarProductos(){this.productService.getProductos().subscribe(e=>{this.productos=e},e=>{console.error("Error al cargar productos:",e)})}productosFiltrados(){if(!this.filtro)return this.productos;let e=this.productos.filter(t=>t.nombre?.toLowerCase().includes(this.filtro.toLowerCase()));return console.log("Productos filtrados:",e),e}comprar(e){this.router.navigate(["/products",e.id])}static \u0275fac=function(t){return new(t||r)(oe(Ji),oe(Ot))};static \u0275cmp=$e({type:r,selectors:[["app-product-list"]],standalone:!1,decls:67,vars:3,consts:[[1,"navbar"],[1,"navbar-brand"],["routerLink","/"],[1,"navbar-links"],["routerLink","/about-us"],["routerLink","/products"],["routerLink","/account"],["routerLink","/cart"],[1,"filtro-container"],["type","text","placeholder","Buscar producto...",3,"ngModelChange","ngModel"],[1,"productos-container"],["class","producto",4,"ngFor","ngForOf"],[1,"footer"],[1,"footer-content"],[1,"footer-column"],["href","#"],[1,"payment-methods"],["src","assets/img/visa.svg","alt","Visa"],["src","assets/img/mastercard.svg","alt","Mastercard"],["src","assets/img/paypal.svg","alt","PayPal"],["src","assets/img/applePay.svg","alt","apple-pay"],[1,"footer-bottom"],[1,"producto"],[3,"src","alt"],[3,"click"]],template:function(t,n){t&1&&(_(0,"nav",0)(1,"div",1)(2,"a",2),E(3,"Techop"),v()(),_(4,"ul",3)(5,"li")(6,"a",4),E(7,"Sobre Nosotros"),v()(),_(8,"li")(9,"a",5),E(10,"Productos"),v()(),_(11,"li")(12,"a",6),E(13,"Cuenta"),v()(),_(14,"li")(15,"a",7),E(16,"Carrito de Compra"),v()()()(),_(17,"body")(18,"div",8)(19,"input",9),bt("ngModelChange",function(o){return Ct(n.filtro,o)||(n.filtro=o),o}),v()(),_(20,"div",10),Le(21,tx,8,4,"div",11),v()(),_(22,"footer",12)(23,"div",13)(24,"div",14)(25,"h4"),E(26,"Techop"),v(),_(27,"ul")(28,"li")(29,"a",5),E(30,"Productos"),v()(),_(31,"li")(32,"a",4),E(33,"Sobre Nosotros"),v()(),_(34,"li")(35,"a",6),E(36,"Cuenta"),v()(),_(37,"li")(38,"a",7),E(39,"Carrito"),v()()()(),_(40,"div",14)(41,"h4"),E(42,"Atenci\xF3n al Cliente"),v(),_(43,"ul")(44,"li")(45,"a",15),E(46,"Preguntas Frecuentes"),v()(),_(47,"li")(48,"a",15),E(49,"T\xE9rminos y Condiciones"),v()(),_(50,"li")(51,"a",15),E(52,"Pol\xEDtica de Privacidad"),v()(),_(53,"li")(54,"a",15),E(55,"Contacto"),v()()()(),_(56,"div",14)(57,"h4"),E(58,"M\xE9todos de Pago"),v(),_(59,"div",16),_e(60,"img",17)(61,"img",18)(62,"img",19)(63,"img",20),v()()(),_(64,"div",21)(65,"p"),E(66),v()()()),t&2&&(G(19),Et("ngModel",n.filtro),G(2),me("ngForOf",n.productosFiltrados()),G(45),Te("\xA9 ",n.currentYear," Techop E-commerce. Todos los derechos reservados."))},dependencies:[Di,lt,Zn,ji,jr],styles:['*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box;font-family:BasisGrotesque}body[_ngcontent-%COMP%]{height:max-content;background:linear-gradient(to bottom,#fff,#1e3c72)}@font-face{font-family:BasisGrotesque;src:url("./media/BasisGrotesqueArabicPro-Light-EN3UARNA.woff2") format("woff2");font-weight:bolder;font-style:normal}.navbar[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;z-index:1000;background-color:#fff}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-transform:uppercase;text-decoration:none;color:#333;letter-spacing:.15em;display:inline-block;padding:15px 0;position:relative}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.navbar-links[_ngcontent-%COMP%]{list-style:none;display:flex;gap:1.5rem;margin:0;padding:0}.navbar-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#333;text-transform:uppercase;text-decoration:none;letter-spacing:.15em;padding:15px 20px;display:inline-block}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.navbar-toggle[_ngcontent-%COMP%]{display:none;flex-direction:column;cursor:pointer}.navbar-toggle[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{height:3px;width:25px;background-color:#333;margin:4px 0;transition:.4s}.filtro-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:100px;margin-bottom:40px}.filtro-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:60%;padding:10px;border:1px solid #ccc;border-radius:5px;font-size:16px}.productos-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:20px}.producto[_ngcontent-%COMP%]{background:#fff;border-radius:10px;box-shadow:0 4px 8px #0003;width:230px;padding:15px;text-align:center;transition:transform .2s}.producto[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.producto[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;border-radius:10px}.producto[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;margin:10px 0}.producto[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;font-size:14px}.categoria[_ngcontent-%COMP%]{display:block;font-size:12px;color:#888;margin-bottom:10px}button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:10px;cursor:pointer;border-radius:5px;width:100%}button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.footer[_ngcontent-%COMP%]{background-color:#1e3c72;color:#fff;padding:3rem 2rem 1rem}.footer-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;gap:2rem;max-width:1200px;margin:0 auto}.footer-column[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1.2rem;border-bottom:2px solid #00fffc;display:inline-block;padding-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#fff;transition:color .3s ease}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.payment-methods[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-top:1rem}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:35px;transition:transform .3s ease}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.footer-bottom[_ngcontent-%COMP%]{text-align:center;margin-top:2rem;font-size:.9rem;border-top:1px solid rgba(255,255,255,.2);padding-top:1rem}@media (max-width: 768px){.navbar[_ngcontent-%COMP%]{flex-direction:column;align-items:center;background-color:transparent;position:relative}.navbar-links[_ngcontent-%COMP%]{flex-direction:column;align-items:center;width:100%;gap:.5rem;padding-top:1rem}.filtro-container[_ngcontent-%COMP%]{margin-top:1rem}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:10px 0;display:block}}']})};var Zi=class r{carrito=[];constructor(){this.cargarCarritoDesdeLocalStorage()}cargarCarritoDesdeLocalStorage(){this.carrito=JSON.parse(localStorage.getItem("carrito")||"[]")}agregarAlCarrito(e){let t=this.carrito.find(n=>n.id===e.id);t?t.cantidad++:this.carrito.push(ge(z({},e),{cantidad:1})),this.guardarCarrito()}obtenerCarrito(){return this.carrito}aumentarCantidad(e){let t=this.carrito.find(n=>n.id===e);t&&t.cantidad++,this.guardarCarrito()}reducirCantidad(e){let t=this.carrito.findIndex(n=>n.id===e);t!==-1&&(this.carrito[t].cantidad--,this.carrito[t].cantidad===0&&this.carrito.splice(t,1)),this.guardarCarrito()}vaciarCarrito(){this.carrito=[],localStorage.removeItem("carrito")}guardarCarrito(){localStorage.setItem("carrito",JSON.stringify(this.carrito))}static \u0275fac=function(t){return new(t||r)};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})};function nx(r,e){if(r&1){let t=jt();_(0,"div")(1,"div",20),_e(2,"img",21),_(3,"h1"),E(4),v(),_(5,"p"),E(6),v(),_(7,"p"),E(8),v(),_(9,"p"),E(10),v(),_(11,"p"),E(12),v(),_(13,"div",22)(14,"button",23),ye("click",function(){Ee(t);let i=ce();return Ce(i.anadirAlCarrito())}),E(15,"A\xF1adir al Carrito"),v(),_(16,"button",24),ye("click",function(){Ee(t);let i=ce();return Ce(i.comprarAhora())}),E(17,"Comprar Ahora"),v()()()()}if(r&2){let t=ce();G(2),me("src",t.producto.imagen,Yn)("alt",t.producto.nombre),G(2),Gt(t.producto.nombre),G(2),Te("Categoria: ",t.producto.categoria_nombre,""),G(2),Te("Stock disponible: ",t.producto.stock_disponible,""),G(2),Gt(t.nuevaDescripcion),G(2),Te("Precio: ",t.producto.precio,"\u20AC")}}function rx(r,e){r&1&&(_(0,"p"),E(1,"Cargando producto..."),v())}var Ml=class r{constructor(e,t,n,i){this.ruta=e;this.productoServicio=t;this.cartService=n;this.router=i}currentYear=new Date().getFullYear();producto=null;nuevaDescripcion="";ngOnInit(){let e=this.ruta.snapshot.paramMap.get("id");e&&this.productoServicio.getProductoById(Number(e)).subscribe(t=>{this.producto=t,console.log("producto: ",this.producto),this.asignarDescripcionPersonalizada(Number(e))},t=>{console.error("Error al obtener el producto:",t)})}asignarDescripcionPersonalizada(e){switch(e){case 1:this.nuevaDescripcion="Esta es una laptop de alto rendimiento, ideal para gamers y profesionales creativos.";break;case 2:this.nuevaDescripcion="Tarjeta gr\xE1fica de \xFAltima generaci\xF3n, perfecta para gaming y edici\xF3n de video.";break;case 3:this.nuevaDescripcion="Teclado mec\xE1nico con iluminaci\xF3n RGB personalizable para una experiencia \xFAnica.";break;default:this.nuevaDescripcion=this.producto?.descripcion||"Descripci\xF3n no disponible";break}}anadirAlCarrito(){this.producto&&(this.cartService.agregarAlCarrito(this.producto),alert(`Producto "${this.producto.nombre}" a\xF1adido al carrito.`))}comprarAhora(){this.producto&&(this.cartService.agregarAlCarrito(this.producto),this.router.navigate(["/cart"]))}static \u0275fac=function(t){return new(t||r)(oe(Rn),oe(Ji),oe(Zi),oe(Ot))};static \u0275cmp=$e({type:r,selectors:[["app-product-detail"]],standalone:!1,decls:66,vars:3,consts:[["cargando",""],[1,"navbar"],[1,"navbar-brand"],["routerLink","/"],[1,"navbar-links"],["routerLink","/about-us"],["routerLink","/products"],["routerLink","/account"],["routerLink","/cart"],[4,"ngIf","ngIfElse"],[1,"footer"],[1,"footer-content"],[1,"footer-column"],["href","#"],[1,"payment-methods"],["src","assets/img/visa.svg","alt","Visa"],["src","assets/img/mastercard.svg","alt","Mastercard"],["src","assets/img/paypal.svg","alt","PayPal"],["src","assets/img/applePay.svg","alt","apple-pay"],[1,"footer-bottom"],[1,"detalle-producto"],[1,"imagen-producto",3,"src","alt"],[1,"acciones"],[1,"boton-carrito",3,"click"],[1,"boton-comprar",3,"click"]],template:function(t,n){if(t&1&&(_(0,"nav",1)(1,"div",2)(2,"a",3),E(3,"Techop"),v()(),_(4,"ul",4)(5,"li")(6,"a",5),E(7,"Sobre Nosotros"),v()(),_(8,"li")(9,"a",6),E(10,"Productos"),v()(),_(11,"li")(12,"a",7),E(13,"Cuenta"),v()(),_(14,"li")(15,"a",8),E(16,"Carrito de Compra"),v()()()(),_(17,"body"),Le(18,nx,18,7,"div",9),v(),_(19,"footer",10)(20,"div",11)(21,"div",12)(22,"h4"),E(23,"Techop"),v(),_(24,"ul")(25,"li")(26,"a",6),E(27,"Productos"),v()(),_(28,"li")(29,"a",5),E(30,"Sobre Nosotros"),v()(),_(31,"li")(32,"a",7),E(33,"Cuenta"),v()(),_(34,"li")(35,"a",8),E(36,"Carrito"),v()()()(),_(37,"div",12)(38,"h4"),E(39,"Atenci\xF3n al Cliente"),v(),_(40,"ul")(41,"li")(42,"a",13),E(43,"Preguntas Frecuentes"),v()(),_(44,"li")(45,"a",13),E(46,"T\xE9rminos y Condiciones"),v()(),_(47,"li")(48,"a",13),E(49,"Pol\xEDtica de Privacidad"),v()(),_(50,"li")(51,"a",13),E(52,"Contacto"),v()()()(),_(53,"div",12)(54,"h4"),E(55,"M\xE9todos de Pago"),v(),_(56,"div",14),_e(57,"img",15)(58,"img",16)(59,"img",17)(60,"img",18),v()()(),_(61,"div",19)(62,"p"),E(63),v()()(),Le(64,rx,2,0,"ng-template",null,0,Vc)),t&2){let i=kc(65);G(18),me("ngIf",n.producto)("ngIfElse",i),G(45),Te("\xA9 ",n.currentYear," Techop E-commerce. Todos los derechos reservados.")}},dependencies:[Oi,lt],styles:['*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}@font-face{font-family:BasisGrotesque;src:url("./media/BasisGrotesqueArabicPro-Light-EN3UARNA.woff2") format("woff2");font-weight:bolder;font-style:normal}body[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#fff,#1e3c72);font-family:BasisGrotesque,sans-serif}.navbar[_ngcontent-%COMP%]{font-family:BasisGrotesque,sans-serif;position:absolute;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;z-index:1000}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-transform:uppercase;text-decoration:none;color:#333;letter-spacing:.15em;display:inline-block;padding:15px 0;position:relative}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.navbar-links[_ngcontent-%COMP%]{list-style:none;display:flex;gap:1.5rem;margin:0;padding:0}.navbar-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:table-cell;position:relative;padding:15px 0}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#333;text-transform:uppercase;text-decoration:none;letter-spacing:.15em;display:inline-block;padding:15px 20px;position:relative}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.detalle-producto[_ngcontent-%COMP%]{max-width:800px;margin:100px auto;padding:20px;background:linear-gradient(to bottom,#555,#fff);border-radius:10px;box-shadow:0 4px 6px #0000001a;animation:_ngcontent-%COMP%_fadeIn 1s ease-in-out}.imagen-producto[_ngcontent-%COMP%]{width:50%;max-height:500px;object-fit:cover;border-radius:10px;margin:0 auto 20px;display:block;transition:transform .3s ease-in-out}.imagen-producto[_ngcontent-%COMP%]:hover{transform:scale(1.05)}h1[_ngcontent-%COMP%]{font-size:2rem;color:#333;margin-bottom:10px;text-align:center;animation:_ngcontent-%COMP%_slideIn 1s ease-in-out}p[_ngcontent-%COMP%]{text-align:center;font-size:1.2rem;color:#555;line-height:1.6;margin-bottom:20px}.categoria[_ngcontent-%COMP%]{display:inline-block;font-size:.9rem;color:#fff;padding:5px 10px;border-radius:5px;animation:_ngcontent-%COMP%_pulse 2s infinite}.acciones[_ngcontent-%COMP%]{display:flex;justify-content:space-around;flex-wrap:wrap;margin-top:20px}button[_ngcontent-%COMP%]{font-family:BasisGrotesque;padding:10px 20px;font-size:1rem;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s ease,transform .2s ease}.boton-carrito[_ngcontent-%COMP%], .boton-comprar[_ngcontent-%COMP%]{background-color:#161615;color:#fff;margin:10px}.boton-carrito[_ngcontent-%COMP%]:hover, .boton-comprar[_ngcontent-%COMP%]:hover{background-color:#210be0;transform:translateY(-2px)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translate(-100%)}to{opacity:1;transform:translate(0)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.1)}}.footer[_ngcontent-%COMP%]{background-color:#1e3c72;color:#fff;padding:3rem 2rem 1rem}.footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff}.footer-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;gap:2rem;max-width:1200px;margin:0 auto}.footer-column[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1.2rem;border-bottom:2px solid #00fffc;display:inline-block;padding-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#fff;transition:color .3s ease}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.payment-methods[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-top:1rem}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:35px;transition:transform .3s ease}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.footer-bottom[_ngcontent-%COMP%]{text-align:center;margin-top:2rem;font-size:.9rem;border-top:1px solid rgba(255,255,255,.2);padding-top:1rem}@media (max-width: 768px){.navbar[_ngcontent-%COMP%]{flex-direction:column;align-items:center;background-color:transparent;position:relative}.navbar-links[_ngcontent-%COMP%]{flex-direction:column;align-items:center;width:100%;gap:.5rem;padding-top:1rem}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:10px 0;display:block}.detalle-producto[_ngcontent-%COMP%]{margin-top:30px;padding:15px}.imagen-producto[_ngcontent-%COMP%]{width:100%}.acciones[_ngcontent-%COMP%]{flex-direction:column;gap:10px}}@media (max-width: 480px){h1[_ngcontent-%COMP%]{font-size:1.5rem}p[_ngcontent-%COMP%]{font-size:1rem}.boton-carrito[_ngcontent-%COMP%], .boton-comprar[_ngcontent-%COMP%]{width:100%}.footer-content[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:center}}']})};var Dl=class r{constructor(e){this.http=e}apiUrl="https://techop-e-commerce.onrender.com/api/metodos-pago";getMetodosPago(){return this.http.get(this.apiUrl)}static \u0275fac=function(t){return new(t||r)(q(Sn))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ol=class r{constructor(e){this.http=e}apiUrl="https://techop-e-commerce.onrender.com/api/create-order";realizarCompra(e,t,n,i,o){let s={email:e,nombre:t,telefono:Number(n),direccion:i,total:this.calcularTotal(),metodo_pago_id:Number(o),estado_envio_id:1,detalles:this.obtenerDetalles()};return console.log("\u{1F6D2} Enviando pedido al backend:",s),this.http.post(this.apiUrl,s)}obtenerDetalles(){return JSON.parse(localStorage.getItem("carrito")||"[]").map(t=>({producto_id:t.id,cantidad:t.cantidad,precio_unitario:t.precio}))}calcularTotal(){return JSON.parse(localStorage.getItem("carrito")||"[]").reduce((t,n)=>t+n.precio*n.cantidad,0)}static \u0275fac=function(t){return new(t||r)(q(Sn))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})};function sx(r,e){if(r&1&&_e(0,"img",31),r&2){let t=ce().$implicit;me("src",t.imagen,Yn)("alt",t.nombre||"Producto")}}function ax(r,e){if(r&1){let t=jt();_(0,"div",25),Le(1,sx,1,2,"img",26),_(2,"div",27)(3,"h3"),E(4),v(),_(5,"div",28)(6,"button",29),ye("click",function(){let i=Ee(t).$implicit,o=ce(2);return Ce(o.reducir(i.id))}),E(7,"\u2212"),v(),_(8,"span"),E(9),v(),_(10,"button",29),ye("click",function(){let i=Ee(t).$implicit,o=ce(2);return Ce(o.aumentar(i.id))}),E(11,"+"),v()()(),_(12,"div",30)(13,"p")(14,"strong"),E(15),xi(16,"currency"),v()()()()}if(r&2){let t=e.$implicit;G(),me("ngIf",t.imagen),G(3),Gt(t.nombre||"Sin nombre"),G(5),Gt(t.cantidad),G(6),Gt(Ri(16,4,t.precio*t.cantidad,"EUR"))}}function cx(r,e){if(r&1){let t=jt();_(0,"div"),Le(1,ax,17,7,"div",22),_(2,"div",23)(3,"p")(4,"strong"),E(5,"Total:"),v(),E(6),xi(7,"currency"),v()(),_(8,"button",24),ye("click",function(){Ee(t);let i=ce();return Ce(i.mostrarPopup())}),E(9,"Continuar"),v()()}if(r&2){let t=ce();G(),me("ngForOf",t.productosCarrito),G(5),Te(" ",Ri(7,2,t.totalCarrito,"EUR"),"")}}function lx(r,e){r&1&&(_(0,"p",41),E(1,"\u26A0\uFE0F Este campo es obligatorio."),v())}function ux(r,e){r&1&&(_(0,"p",41),E(1,"\u26A0\uFE0F Este campo es obligatorio."),v())}function dx(r,e){r&1&&(_(0,"p",41),E(1,"\u26A0\uFE0F Introduce un correo v\xE1lido."),v())}function hx(r,e){r&1&&(_(0,"p",41),E(1,"\u26A0\uFE0F Este campo es obligatorio."),v())}function fx(r,e){r&1&&(_(0,"p",41),E(1,"\u26A0\uFE0F Introduce un n\xFAmero de tel\xE9fono v\xE1lido."),v())}function px(r,e){r&1&&(_(0,"p",41),E(1,"\u26A0\uFE0F Este campo es obligatorio."),v())}function mx(r,e){if(r&1&&(_(0,"option",42),E(1),v()),r&2){let t=e.$implicit;me("value",t.id),G(),Gt(t.nombre)}}function gx(r,e){r&1&&(_(0,"p",41),E(1,"\u26A0\uFE0F Debes seleccionar un m\xE9todo de pago."),v())}function yx(r,e){if(r&1){let t=jt();_(0,"div",32)(1,"div",33)(2,"h2"),E(3,"Confirmar Compra"),v(),_(4,"label"),E(5,"Nombre Completo:"),v(),_(6,"input",34),bt("ngModelChange",function(i){Ee(t);let o=ce();return Ct(o.nombreUsuario,i)||(o.nombreUsuario=i),Ce(i)}),v(),Le(7,lx,2,0,"p",35),_(8,"label"),E(9,"Email:"),v(),_(10,"input",36),bt("ngModelChange",function(i){Ee(t);let o=ce();return Ct(o.emailUsuario,i)||(o.emailUsuario=i),Ce(i)}),v(),Le(11,ux,2,0,"p",35)(12,dx,2,0,"p",35),_(13,"label"),E(14,"Tel\xE9fono:"),v(),_(15,"input",37),bt("ngModelChange",function(i){Ee(t);let o=ce();return Ct(o.telefonoUsuario,i)||(o.telefonoUsuario=i),Ce(i)}),v(),Le(16,hx,2,0,"p",35)(17,fx,2,0,"p",35),_(18,"label"),E(19,"Direcci\xF3n:"),v(),_(20,"input",34),bt("ngModelChange",function(i){Ee(t);let o=ce();return Ct(o.direccionUsuario,i)||(o.direccionUsuario=i),Ce(i)}),v(),Le(21,px,2,0,"p",35),_(22,"label"),E(23,"M\xE9todo de Pago:"),v(),_(24,"select",38),bt("ngModelChange",function(i){Ee(t);let o=ce();return Ct(o.metodoPagoId,i)||(o.metodoPagoId=i),Ce(i)}),Le(25,mx,2,2,"option",39),v(),Le(26,gx,2,0,"p",35),_(27,"p")(28,"strong"),E(29,"Total a pagar:"),v(),E(30),xi(31,"currency"),v(),_(32,"button",24),ye("click",function(){Ee(t);let i=ce();return Ce(i.finalizarCompra())}),E(33,"Finalizar compra"),v(),_(34,"button",40),ye("click",function(){Ee(t);let i=ce();return Ce(i.cerrarPopup())}),E(35,"Cancelar"),v()()()}if(r&2){let t=ce();G(6),Et("ngModel",t.nombreUsuario),G(),me("ngIf",t.intentoEnvio&&!t.nombreUsuario),G(3),Et("ngModel",t.emailUsuario),G(),me("ngIf",t.intentoEnvio&&!t.emailUsuario),G(),me("ngIf",t.intentoEnvio&&t.emailUsuario&&!t.validarEmail()),G(3),Et("ngModel",t.telefonoUsuario),G(),me("ngIf",t.intentoEnvio&&!t.telefonoUsuario),G(),me("ngIf",t.intentoEnvio&&t.telefonoUsuario&&!t.validarTelefono()),G(3),Et("ngModel",t.direccionUsuario),G(),me("ngIf",t.intentoEnvio&&!t.direccionUsuario),G(3),Et("ngModel",t.metodoPagoId),G(),me("ngForOf",t.metodosPago),G(),me("ngIf",t.intentoEnvio&&!t.metodoPagoId),G(4),Te(" ",Ri(31,14,t.totalCarrito,"EUR"),"")}}function _x(r,e){if(r&1&&(_(0,"li"),E(1),xi(2,"currency"),v()),r&2){let t=e.$implicit;G(),J_(" ",t.nombre," (x",t.cantidad,") - ",Ri(2,3,t.precio*t.cantidad,"EUR")," ")}}function vx(r,e){if(r&1){let t=jt();_(0,"div",32)(1,"div",33)(2,"h2"),E(3,"\u{1F6D2} Resumen del Pedido"),v(),_(4,"p")(5,"strong"),E(6,"\u{1F4E7} Email:"),v(),E(7),v(),_(8,"p")(9,"strong"),E(10,"\u{1F464} Nombre:"),v(),E(11),v(),_(12,"p")(13,"strong"),E(14,"\u{1F4DE} Tel\xE9fono:"),v(),E(15),v(),_(16,"p")(17,"strong"),E(18,"\u{1F3E0} Direcci\xF3n:"),v(),E(19),v(),_(20,"p")(21,"strong"),E(22,"\u{1F4B3} M\xE9todo de Pago:"),v(),E(23),v(),_(24,"h3"),E(25,"\u{1F6CD}\uFE0F Productos:"),v(),_(26,"ul"),Le(27,_x,3,6,"li",43),v(),_(28,"p")(29,"strong"),E(30,"\u{1F4B0} Total a pagar:"),v(),E(31),xi(32,"currency"),v(),_(33,"button",40),ye("click",function(){Ee(t);let i=ce();return Ce(i.confirmarCompra())}),E(34,"Confirmar compra"),v(),_(35,"button",44),ye("click",function(){Ee(t);let i=ce();return Ce(i.cerrarPopupConfirmacion())}),E(36,"Cancelar"),v()()()}if(r&2){let t=ce();G(7),Te(" ",t.emailUsuario,""),G(4),Te(" ",t.nombreUsuario,""),G(4),Te(" ",t.telefonoUsuario,""),G(4),Te(" ",t.direccionUsuario,""),G(4),Te(" ",t.getNombreMetodoPago(),""),G(4),me("ngForOf",t.productosCarrito),G(4),Te(" ",Ri(32,7,t.totalCarrito,"EUR"),"")}}function wx(r,e){r&1&&(_(0,"div",45)(1,"p"),E(2,"\u{1F6D2} Tu carrito est\xE1 vac\xEDo."),v(),_(3,"a",46),E(4,"Explorar productos"),v()())}var kl=class r{constructor(e,t,n){this.cartService=e;this.metodoPagoService=t;this.orderService=n}currentYear=new Date().getFullYear();productosCarrito=[];mostrarResumen=!1;intentoEnvio=!1;mostrarPopupConfirmacionBoleano=!1;emailUsuario="";nombreUsuario="";telefonoUsuario=null;direccionUsuario="";metodoPagoId=null;metodosPago=[];ngOnInit(){let e=this.cartService.obtenerCarrito();this.productosCarrito=Array.isArray(e)?e:[],this.obtenerMetodosPago()}obtenerMetodosPago(){this.metodoPagoService.getMetodosPago().subscribe(e=>{this.metodosPago=e},e=>{console.error("\u274C Error al obtener m\xE9todos de pago:",e)})}mostrarPopup(){this.mostrarResumen=!0,this.intentoEnvio=!1}cerrarPopup(){this.mostrarResumen=!1}mostrarPopupConfirmacion(){this.validarCampos()&&(this.mostrarPopupConfirmacionBoleano=!0)}cerrarPopupConfirmacion(){this.mostrarPopupConfirmacionBoleano=!1}aumentar(e){this.cartService.aumentarCantidad(e),this.actualizarCarrito()}reducir(e){this.cartService.reducirCantidad(e),this.actualizarCarrito()}validarEmail(){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.emailUsuario)}validarTelefono(){return/^(?:\+34|0034|34)?[6789]\d{8}$/.test(this.telefonoUsuario?.toString()||"")}getNombreMetodoPago(){if(this.metodoPagoId===null)return"No seleccionado";for(let e of this.metodosPago)if(e.id==this.metodoPagoId)return e.nombre;return"No seleccionado"}validarCampos(){return this.intentoEnvio=!0,!(!this.emailUsuario||!this.nombreUsuario||!this.telefonoUsuario||!this.direccionUsuario||!this.metodoPagoId||!this.validarEmail()||!this.validarTelefono())}confirmarCompra(){this.orderService.realizarCompra(this.emailUsuario,this.nombreUsuario,this.telefonoUsuario,this.direccionUsuario,this.metodoPagoId).subscribe(e=>{console.log("\u2705 Pedido realizado con \xE9xito:",e),alert("\u2705 Compra realizada con \xE9xito. Te enviaremos un correo con los detalles de tu pedido."),this.cartService.vaciarCarrito(),this.cerrarPopup(),this.cerrarPopupConfirmacion(),this.limpiarDatosUsuario()},e=>{console.error("\u274C Error al realizar la compra:",e),alert("\u274C Error al procesar la compra. Intenta nuevamente.")})}finalizarCompra(){this.mostrarPopupConfirmacion()}get totalCarrito(){return this.productosCarrito.reduce((e,t)=>e+t.precio*t.cantidad,0)}actualizarCarrito(){let e=this.cartService.obtenerCarrito();this.productosCarrito=Array.isArray(e)?e:[]}limpiarDatosUsuario(){this.productosCarrito=[],this.emailUsuario="",this.nombreUsuario="",this.telefonoUsuario=null,this.direccionUsuario="",this.metodoPagoId=null}static \u0275fac=function(t){return new(t||r)(oe(Zi),oe(Dl),oe(Ol))};static \u0275cmp=$e({type:r,selectors:[["app-cart"]],standalone:!1,decls:71,vars:5,consts:[["vacio",""],[1,"navbar"],[1,"navbar-brand"],["routerLink","/"],[1,"navbar-links"],["routerLink","/about-us"],["routerLink","/products"],["routerLink","/account"],["routerLink","/cart"],[1,"carrito-container"],[4,"ngIf","ngIfElse"],["class","popup",4,"ngIf"],[1,"footer"],[1,"footer-content"],[1,"footer-column"],["href","#"],[1,"payment-methods"],["src","assets/img/visa.svg","alt","Visa"],["src","assets/img/mastercard.svg","alt","Mastercard"],["src","assets/img/paypal.svg","alt","PayPal"],["src","assets/img/applePay.svg","alt","apple-pay"],[1,"footer-bottom"],["class","producto-carrito",4,"ngFor","ngForOf"],[1,"total-carrito"],[1,"finalizar-btn",3,"click"],[1,"producto-carrito"],["class","producto-img",3,"src","alt",4,"ngIf"],[1,"producto-info"],[1,"cantidad-control"],[3,"click"],[1,"producto-precio"],[1,"producto-img",3,"src","alt"],[1,"popup"],[1,"popup-content"],["type","text",3,"ngModelChange","ngModel"],["class","error-msg",4,"ngIf"],["type","email","required","",3,"ngModelChange","ngModel"],["type","number","inputmode","numeric","pattern","[0-9]*",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"confirmar-btn",3,"click"],[1,"error-msg"],[3,"value"],[4,"ngFor","ngForOf"],[1,"cancelar-btn",3,"click"],[1,"carrito-vacio"],["routerLink","/products",1,"volver-productos"]],template:function(t,n){if(t&1&&(_(0,"nav",1)(1,"div",2)(2,"a",3),E(3,"Techop"),v()(),_(4,"ul",4)(5,"li")(6,"a",5),E(7,"Sobre Nosotros"),v()(),_(8,"li")(9,"a",6),E(10,"Productos"),v()(),_(11,"li")(12,"a",7),E(13,"Cuenta"),v()(),_(14,"li")(15,"a",8),E(16,"Carrito de Compra"),v()()()(),_(17,"body")(18,"div",9)(19,"h2"),E(20,"Carrito de Compra"),v(),Le(21,cx,10,5,"div",10)(22,yx,36,17,"div",11)(23,vx,37,10,"div",11)(24,wx,5,0,"ng-template",null,0,Vc),v()(),_(26,"footer",12)(27,"div",13)(28,"div",14)(29,"h4"),E(30,"Techop"),v(),_(31,"ul")(32,"li")(33,"a",6),E(34,"Productos"),v()(),_(35,"li")(36,"a",5),E(37,"Sobre Nosotros"),v()(),_(38,"li")(39,"a",7),E(40,"Cuenta"),v()(),_(41,"li")(42,"a",8),E(43,"Carrito"),v()()()(),_(44,"div",14)(45,"h4"),E(46,"Atenci\xF3n al Cliente"),v(),_(47,"ul")(48,"li")(49,"a",15),E(50,"Preguntas Frecuentes"),v()(),_(51,"li")(52,"a",15),E(53,"T\xE9rminos y Condiciones"),v()(),_(54,"li")(55,"a",15),E(56,"Pol\xEDtica de Privacidad"),v()(),_(57,"li")(58,"a",15),E(59,"Contacto"),v()()()(),_(60,"div",14)(61,"h4"),E(62,"M\xE9todos de Pago"),v(),_(63,"div",16),_e(64,"img",17)(65,"img",18)(66,"img",19)(67,"img",20),v()()(),_(68,"div",21)(69,"p"),E(70),v()()()),t&2){let i=kc(25);G(21),me("ngIf",n.productosCarrito&&n.productosCarrito.length>0)("ngIfElse",i),G(),me("ngIf",n.mostrarResumen),G(),me("ngIf",n.mostrarPopupConfirmacionBoleano),G(47),Te("\xA9 ",n.currentYear," Techop E-commerce. Todos los derechos reservados.")}},dependencies:[Di,Oi,lt,b0,T0,Zn,tf,al,ji,Gs,nf,jr,hv],styles:['*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}@font-face{font-family:BasisGrotesque;src:url("./media/BasisGrotesqueArabicPro-Light-EN3UARNA.woff2") format("woff2");font-weight:bolder;font-style:normal}body[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#fff,#1e3c72)}.navbar[_ngcontent-%COMP%]{font-family:BasisGrotesque,sans-serif;position:absolute;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;z-index:1000}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-transform:uppercase;text-decoration:none;color:#333;letter-spacing:.15em;display:inline-block;padding:15px 0;position:relative}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.navbar-links[_ngcontent-%COMP%]{list-style:none;display:flex;gap:1.5rem;margin:0;padding:0}.navbar-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:table-cell;position:relative;padding:15px 0}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#333;text-transform:uppercase;text-decoration:none;letter-spacing:.15em;display:inline-block;padding:15px 20px;position:relative}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.carrito-container[_ngcontent-%COMP%]{margin:6rem auto 2rem;padding:2rem;max-width:800px;font-family:BasisGrotesque,sans-serif;background-color:#ffffffd9;border-radius:16px;box-shadow:0 8px 16px #0003}h2[_ngcontent-%COMP%]{font-family:BasisGrotesque,sans-serif;margin-bottom:2rem;text-align:center;color:#1e3c72}.producto-carrito[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:2rem;margin-bottom:2rem;border-bottom:1px solid #ccc;padding-bottom:1rem}.producto-precio[_ngcontent-%COMP%]{min-width:100px;text-align:right;font-weight:700;color:#1e3c72}.total-carrito[_ngcontent-%COMP%]{text-align:right;font-size:1.3rem;margin-top:1rem;font-weight:700;color:#1e3c72}.producto-img[_ngcontent-%COMP%]{width:100px;height:auto;border-radius:8px;object-fit:contain}.producto-info[_ngcontent-%COMP%]{flex:1;font-family:BasisGrotesque,sans-serif}.cantidad-control[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-top:1rem}.cantidad-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#1e3c72;color:#fff;border:none;padding:.5rem 1rem;font-size:1.2rem;border-radius:8px;cursor:pointer}.cantidad-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#00fffc;color:#000}.finalizar-btn[_ngcontent-%COMP%]{margin-top:2rem;display:block;width:100%;padding:1rem;background-color:#1e3c72;color:#fff;font-weight:700;border:none;border-radius:10px;cursor:pointer;transition:background-color .3s ease}.carrito-vacio[_ngcontent-%COMP%]{text-align:center;font-size:1.2rem;color:#333}.volver-productos[_ngcontent-%COMP%]{display:inline-block;margin-top:1rem;color:#1e3c72;text-decoration:underline;font-weight:700}.volver-productos[_ngcontent-%COMP%]:hover{color:#00fffc}.footer[_ngcontent-%COMP%]{background-color:#1e3c72;color:#fff;padding:3rem 2rem 1rem;font-family:BasisGrotesque,sans-serif}.footer-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;gap:2rem;max-width:1200px;margin:0 auto}.footer-column[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1.2rem;border-bottom:2px solid #00fffc;display:inline-block;padding-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#fff;transition:color .3s ease}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.payment-methods[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-top:1rem}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:35px;transition:transform .3s ease}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.footer-bottom[_ngcontent-%COMP%]{text-align:center;margin-top:2rem;font-size:.9rem;border-top:1px solid rgba(255,255,255,.2);padding-top:1rem}.popup[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:1rem;border-radius:12px;box-shadow:0 8px 16px #0000004d;z-index:1000;width:500px;text-align:center;font-family:BasisGrotesque,sans-serif}.popup-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.popup-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;color:#1e3c72;margin-bottom:1rem}.popup-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.popup-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:.5rem}.popup-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;font-size:1rem;color:#1e3c72;text-align:left}.popup-content[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .popup-content[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.8rem;border:2px solid #1e3c72;border-radius:8px;background-color:#fff;font-size:1rem;font-weight:700;color:#1e3c72;cursor:pointer;transition:all .3s ease;appearance:none}.popup-content[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .popup-content[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#00fffc;box-shadow:0 0 8px #00fffc80}.popup-content[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:hover{border-color:#00fffc;background-color:#f0f8ff}.popup-content[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{font-size:1rem;padding:.5rem;background-color:#fff;color:#1e3c72}.finalizar-btn[_ngcontent-%COMP%], .confirmar-btn[_ngcontent-%COMP%]{width:100%;padding:.5rem;font-size:1rem;font-weight:700;border:none;border-radius:8px;cursor:pointer;transition:background .3s ease}.finalizar-btn[_ngcontent-%COMP%]{background-color:#1e3c72;color:#fff}.finalizar-btn[_ngcontent-%COMP%]:hover{background-color:#00fffc;color:#000}.confirmar-btn[_ngcontent-%COMP%]{background-color:#ccc;color:#000}.confirmar-btn[_ngcontent-%COMP%]:hover{background-color:#999}.popup-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;color:#1e3c72;margin-top:1rem}.error-msg[_ngcontent-%COMP%]{color:red;font-size:.9rem;font-weight:700;margin-top:.3rem;text-align:left}.cancelar-btn[_ngcontent-%COMP%]{background-color:#ccc;color:#000;font-weight:700;padding:.8rem;border:none;border-radius:5px;cursor:pointer}.cancelar-btn[_ngcontent-%COMP%]:hover{background-color:#999}input[type=number][inputmode=numeric][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][inputmode=numeric][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}@media (max-width: 992px){.navbar[_ngcontent-%COMP%]{flex-direction:column;align-items:center;background-color:transparent;position:relative}.navbar-links[_ngcontent-%COMP%]{flex-direction:column;align-items:center;width:100%;gap:.5rem;padding-top:1rem}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:10px 0;display:block}.carrito[_ngcontent-%COMP%]{width:300px}.popup[_ngcontent-ng-c589122112][_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:1rem;border-radius:12px;box-shadow:0 8px 16px #0000004d;z-index:1000;width:300px;text-align:center;font-family:BasisGrotesque,sans-serif}.footer-content[_ngcontent-%COMP%]{flex-direction:column;align-items:center;gap:1.5rem}.footer-column[_ngcontent-%COMP%]{text-align:center}.payment-methods[_ngcontent-%COMP%]{justify-content:center}}']})};var Vl=class r{currentYear=new Date().getFullYear();static \u0275fac=function(t){return new(t||r)};static \u0275cmp=$e({type:r,selectors:[["app-profile"]],standalone:!1,decls:75,vars:1,consts:[[1,"navbar"],[1,"navbar-brand"],["routerLink","/"],[1,"navbar-links"],["routerLink","/about-us"],["routerLink","/products"],["routerLink","/account"],["routerLink","/cart"],[1,"bienvenida-container"],[1,"bienvenida-card"],[1,"footer"],[1,"footer-content"],[1,"footer-column"],["href","#"],[1,"payment-methods"],["src","assets/img/visa.svg","alt","Visa"],["src","assets/img/mastercard.svg","alt","Mastercard"],["src","assets/img/paypal.svg","alt","PayPal"],["src","assets/img/applePay.svg","alt","Apple Pay"],[1,"footer-bottom"]],template:function(t,n){t&1&&(_(0,"nav",0)(1,"div",1)(2,"a",2),E(3,"Techop"),v()(),_(4,"ul",3)(5,"li")(6,"a",4),E(7,"Sobre Nosotros"),v()(),_(8,"li")(9,"a",5),E(10,"Productos"),v()(),_(11,"li")(12,"a",6),E(13,"Cuenta"),v()(),_(14,"li")(15,"a",7),E(16,"Carrito de Compra"),v()()()(),_(17,"body")(18,"div",8)(19,"div",9)(20,"h1"),E(21,"\xA1Gracias por Formar parte Techop-Ecommerce! \u{1F389}"),v(),_(22,"p"),E(23,"Si eres un nuevo usuario te hemos enviado un correo de bienvenida a tu cuenta."),v(),_(24,"p"),E(25,"Tanto si eres un nuevo usuario como un cliente, podr\xE1s recibir informaci\xF3n detallada si realizas un pedido."),v(),_(26,"p"),E(27,"Explora nuestra tienda y encuentra los mejores productos tecnol\xF3gicos."),v(),_(28,"button",5),E(29,"Explorar Productos"),v()()()(),_(30,"footer",10)(31,"div",11)(32,"div",12)(33,"h4"),E(34,"Techop"),v(),_(35,"ul")(36,"li")(37,"a",5),E(38,"Productos"),v()(),_(39,"li")(40,"a",4),E(41,"Sobre Nosotros"),v()(),_(42,"li")(43,"a",6),E(44,"Cuenta"),v()(),_(45,"li")(46,"a",7),E(47,"Carrito"),v()()()(),_(48,"div",12)(49,"h4"),E(50,"Atenci\xF3n al Cliente"),v(),_(51,"ul")(52,"li")(53,"a",13),E(54,"Preguntas Frecuentes"),v()(),_(55,"li")(56,"a",13),E(57,"T\xE9rminos y Condiciones"),v()(),_(58,"li")(59,"a",13),E(60,"Pol\xEDtica de Privacidad"),v()(),_(61,"li")(62,"a",13),E(63,"Contacto"),v()()()(),_(64,"div",12)(65,"h4"),E(66,"M\xE9todos de Pago"),v(),_(67,"div",14),_e(68,"img",15)(69,"img",16)(70,"img",17)(71,"img",18),v()()(),_(72,"div",19)(73,"p"),E(74),v()()()),t&2&&(G(74),Te("\xA9 ",n.currentYear," Techop E-commerce. Todos los derechos reservados."))},dependencies:[lt],styles:['@font-face{font-family:BasisGrotesque;src:url("./media/BasisGrotesqueArabicPro-Light-EN3UARNA.woff2") format("woff2");font-weight:bolder;font-style:normal}*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box;font-family:BasisGrotesque}body[_ngcontent-%COMP%]{height:max-content;background:linear-gradient(to bottom,#fff,#1e3c72)}.navbar[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;z-index:1000}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-transform:uppercase;text-decoration:none;color:#333;letter-spacing:.15em;display:inline-block;padding:15px 0;position:relative}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.navbar-links[_ngcontent-%COMP%]{list-style:none;display:flex;gap:1.5rem;margin:0;padding:0}.navbar-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:table-cell;position:relative;padding:15px 0}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#333;text-transform:uppercase;text-decoration:none;letter-spacing:.15em;display:inline-block;padding:15px 20px;position:relative}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.bienvenida-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:80vh}.bienvenida-card[_ngcontent-%COMP%]{background:#fff;padding:30px;border-radius:10px;box-shadow:0 4px 8px #0003;text-align:center;max-width:500px}.bienvenida-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;margin-bottom:15px}.bienvenida-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#555;margin-bottom:10px}.bienvenida-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:10px;cursor:pointer;border-radius:5px;width:100%;font-size:16px}.bienvenida-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.footer[_ngcontent-%COMP%]{background-color:#1e3c72;color:#fff;padding:3rem 2rem 1rem;font-family:BasisGrotesque,sans-serif}.footer-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;gap:2rem;max-width:1200px;margin:0 auto}.footer-column[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1.2rem;border-bottom:2px solid #00fffc;display:inline-block;padding-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#fff;transition:color .3s ease}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.payment-methods[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-top:1rem}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:35px;transition:transform .3s ease}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.footer-bottom[_ngcontent-%COMP%]{text-align:center;margin-top:2rem;font-size:.9rem;border-top:1px solid rgba(255,255,255,.2);padding-top:1rem}']})};var Nl=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=$e({type:r,selectors:[["app-not-found"]],standalone:!1,decls:14,vars:0,consts:[[1,"contenedor-no-encontrado"],[1,"codigo-error"],[1,"mensaje-error"],[1,"descripcion-error"],["routerLink","/",1,"enlace-inicio"],["routerLink","/",1,"boton-volver-inicio"]],template:function(t,n){t&1&&(_(0,"div",0)(1,"h1",1),E(2,"404"),v(),_(3,"p",2),E(4,"\xA1Ups! No pudimos encontrar la p\xE1gina que est\xE1s buscando."),v(),_(5,"p",3),E(6," Es posible que la direcci\xF3n est\xE9 incorrecta o que la p\xE1gina haya sido eliminada. "),_e(7,"br"),E(8," Regresa a nuestra "),_(9,"a",4),E(10,"p\xE1gina de inicio"),v(),E(11," para seguir explorando. "),v(),_(12,"button",5),E(13,"Ir a la p\xE1gina principal"),v()())},dependencies:[lt],styles:[".contenedor-no-encontrado[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;background:linear-gradient(135deg,#1e90ff,#00bfff);color:#fff;font-family:Arial,sans-serif;text-align:center;animation:_ngcontent-%COMP%_desvanecer 1s ease-in-out}.codigo-error[_ngcontent-%COMP%]{font-size:8rem;font-weight:700;margin:0;animation:_ngcontent-%COMP%_deslizarEntrada 1s ease-in-out}.mensaje-error[_ngcontent-%COMP%]{font-size:2rem;margin:10px 0}.descripcion-error[_ngcontent-%COMP%]{font-size:1.2rem;margin:20px 0}.descripcion-error[_ngcontent-%COMP%]   .enlace-inicio[_ngcontent-%COMP%]{color:#ffdd57;text-decoration:none;font-weight:700}.descripcion-error[_ngcontent-%COMP%]   .enlace-inicio[_ngcontent-%COMP%]:hover{text-decoration:underline}.boton-volver-inicio[_ngcontent-%COMP%]{padding:10px 20px;font-size:1.2rem;color:#fff;background-color:#ffdd57;border:none;border-radius:5px;cursor:pointer;transition:transform .3s ease,background-color .3s ease}.boton-volver-inicio[_ngcontent-%COMP%]:hover{background-color:gold;transform:scale(1.1)}@keyframes _ngcontent-%COMP%_desvanecer{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_deslizarEntrada{0%{opacity:0;transform:translate(-100%)}to{opacity:1;transform:translate(0)}}"]})};var Ex=()=>({"--width":"100px","--height":"50px","--quantity":"10"}),Cx=r=>({"--position":r});function bx(r,e){if(r&1&&(_(0,"div",25),_e(1,"img",26),v()),r&2){let t=e.$implicit,n=e.index;me("ngStyle",ev(3,Cx,n+1)),G(),me("src",t.src,Yn)("alt",t.alt)}}var Fl=class r{currentYear=new Date().getFullYear();logos=[{src:"assets/img/aser.png",alt:"Aser"},{src:"assets/img/nvidia.png",alt:"Nvidia"},{src:"assets/img/lenovo.png",alt:"Lenovo"},{src:"assets/img/legion.png",alt:"Legion"},{src:"assets/img/ryzen.png",alt:"Ryzen"},{src:"assets/img/intel.png",alt:"Intel"},{src:"assets/img/msi.png",alt:"MSI"},{src:"assets/img/hp.jpg",alt:"HP"},{src:"assets/img/samsung.png",alt:"Samsung"},{src:"assets/img/apple.png",alt:"Apple"}];images=[{src:"assets/img/slider2_1.png",alt:"Slider 1"},{src:"assets/img/slider2_2.png",alt:"Slider 2"},{src:"assets/img/slider2_3.png",alt:"Slider 3"},{src:"assets/img/slider2_4.png",alt:"Slider 4"},{src:"assets/img/slider2_5.png",alt:"Slider 5"},{src:"assets/img/slider2_6.png",alt:"Slider 6"},{src:"assets/img/slider2_7.png",alt:"Slider 7"},{src:"assets/img/slider2_8.png",alt:"Slider 8"},{src:"assets/img/slider2_9.png",alt:"Slider 9"}];static \u0275fac=function(t){return new(t||r)};static \u0275cmp=$e({type:r,selectors:[["app-about-us"]],standalone:!1,decls:79,vars:4,consts:[[1,"navbar"],[1,"navbar-brand"],["routerLink","/"],[1,"navbar-links"],["routerLink","/about-us"],["routerLink","/products"],["routerLink","/account"],["routerLink","/cart"],[1,"slider",3,"ngStyle"],[1,"list"],["class","item",3,"ngStyle",4,"ngFor","ngForOf"],[1,"techop-container"],["src","assets/img/Techop-about-us.png","alt","Techop About Us",1,"techop"],[1,"text-container"],[1,"description"],[1,"footer"],[1,"footer-content"],[1,"footer-column"],["href","#"],[1,"payment-methods"],["src","assets/img/visa.svg","alt","Visa"],["src","assets/img/mastercard.svg","alt","Mastercard"],["src","assets/img/paypal.svg","alt","PayPal"],["src","assets/img/applePay.svg","alt","apple-pay"],[1,"footer-bottom"],[1,"item",3,"ngStyle"],[3,"src","alt"]],template:function(t,n){t&1&&(_(0,"main")(1,"nav",0)(2,"div",1)(3,"a",2),E(4,"Techop"),v()(),_(5,"ul",3)(6,"li")(7,"a",4),E(8,"Sobre Nosotros"),v()(),_(9,"li")(10,"a",5),E(11,"Productos"),v()(),_(12,"li")(13,"a",6),E(14,"Cuenta"),v()(),_(15,"li")(16,"a",7),E(17,"Carrito de Compra"),v()()()(),_(18,"h1"),E(19,"About us"),v(),_(20,"div",8)(21,"div",9),Le(22,bx,2,5,"div",10),v()(),_(23,"div",11),_e(24,"img",12),_(25,"div",13)(26,"p",14),E(27," En Techop, la tecnolog\xEDa no es solo nuestro negocio, es nuestra pasi\xF3n. Nacimos con la visi\xF3n de ofrecer lo mejor en innovaci\xF3n, rendimiento y calidad a entusiastas, profesionales y gamers que buscan potenciar su experiencia digital. "),v(),_(28,"p",14),E(29," Desde nuestros inicios, hemos trabajado con un compromiso claro: hacer que la tecnolog\xEDa de vanguardia sea accesible para todos. Por eso, seleccionamos cuidadosamente cada producto, desde potentes PCs y componentes de alto rendimiento hasta los \xFAltimos accesorios y perif\xE9ricos del mercado. "),v(),_(30,"p",14),E(31," Pero Techop es m\xE1s que una tienda, es una comunidad. Creemos en el poder de la tecnolog\xEDa para transformar vidas, impulsar ideas y desafiar l\xEDmites. Nos apasiona asesorarte en cada elecci\xF3n, ofreci\xE9ndote no solo productos, sino soluciones que se adapten a tus necesidades. "),v(),_(32,"p",14),E(33,"Bienvenido a Techop. Innovaci\xF3n, rendimiento y confianza en cada compra."),v()()(),_(34,"footer",15)(35,"div",16)(36,"div",17)(37,"h4"),E(38,"Techop"),v(),_(39,"ul")(40,"li")(41,"a",5),E(42,"Productos"),v()(),_(43,"li")(44,"a",4),E(45,"Sobre Nosotros"),v()(),_(46,"li")(47,"a",6),E(48,"Cuenta"),v()(),_(49,"li")(50,"a",7),E(51,"Carrito"),v()()()(),_(52,"div",17)(53,"h4"),E(54,"Atenci\xF3n al Cliente"),v(),_(55,"ul")(56,"li")(57,"a",18),E(58,"Preguntas Frecuentes"),v()(),_(59,"li")(60,"a",18),E(61,"T\xE9rminos y Condiciones"),v()(),_(62,"li")(63,"a",18),E(64,"Pol\xEDtica de Privacidad"),v()(),_(65,"li")(66,"a",18),E(67,"Contacto"),v()()()(),_(68,"div",17)(69,"h4"),E(70,"M\xE9todos de Pago"),v(),_(71,"div",19),_e(72,"img",20)(73,"img",21)(74,"img",22)(75,"img",23),v()()(),_(76,"div",24)(77,"p"),E(78),v()()()()),t&2&&(G(20),me("ngStyle",Z_(3,Ex)),G(2),me("ngForOf",n.logos),G(56),Te("\xA9 ",n.currentYear," Techop E-commerce. Todos los derechos reservados."))},dependencies:[Di,dv,lt],styles:['*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%]{margin:0;font-family:BasisGrotesque,sans-serif}@font-face{font-family:BasisGrotesque;src:url("./media/BasisGrotesqueArabicPro-Light-EN3UARNA.woff2") format("woff2");font-weight:bolder;font-style:normal}[_nghost-%COMP%]{display:block;height:max-content;color:#333;padding:20px;background:linear-gradient(to bottom,#fff,#1e3c72)}main[_ngcontent-%COMP%]{width:min(1200px,90vw);margin:auto}h1[_ngcontent-%COMP%]{font-family:BasisGrotesque,sans-serif;animation:_ngcontent-%COMP%_fadeIn 3s ease-in-out;font-size:4em;color:#333;text-align:center;margin-top:60px;text-transform:uppercase;margin-bottom:20px;letter-spacing:5px;font-weight:bolder;position:relative}h1[_ngcontent-%COMP%]:after{content:"";display:block;width:200px;height:4px;background:linear-gradient(to bottom,#fff,#1e3c72);margin:10px auto 0}.navbar[_ngcontent-%COMP%]{font-family:BasisGrotesque,sans-serif;position:absolute;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;z-index:1000}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-transform:uppercase;text-decoration:none;color:#333;letter-spacing:.15em;display:inline-block;padding:15px 0;position:relative}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.navbar-links[_ngcontent-%COMP%]{list-style:none;display:flex;gap:1.5rem;margin:0;padding:0}.navbar-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:table-cell;position:relative;padding:15px 0}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#333;text-transform:uppercase;text-decoration:none;letter-spacing:.15em;display:inline-block;padding:15px 20px;position:relative}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.techop-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin:20px 0;gap:20px}.techop[_ngcontent-%COMP%]{max-width:40%;height:auto;border-radius:10px}.text-container[_ngcontent-%COMP%]{flex:1;max-width:55%}.description[_ngcontent-%COMP%]{font-family:BasisGrotesque,sans-serif;font-size:1.1em;color:#333;text-align:justify;margin-bottom:20px;line-height:1.6}.slider[_ngcontent-%COMP%]{width:100%;height:var(--height);overflow:hidden;mask-image:linear-gradient(to right,transparent,#000 10% 90%,transparent)}.slider[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;width:100%;min-width:calc(var(--width) * var(--quantity));position:relative}.slider[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{width:var(--width);height:var(--height);position:absolute;left:100%;animation:_ngcontent-%COMP%_autoRun 10s linear infinite;transition:filter .5s;animation-delay:calc((10s / var(--quantity)) * (var(--position) - 1) - 10s)!important}.slider[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain}@keyframes _ngcontent-%COMP%_autoRun{0%{left:100%}to{left:calc(var(--width) * -1)}}.slider[_ngcontent-%COMP%]:hover   .item[_ngcontent-%COMP%]{animation-play-state:paused!important;filter:grayscale(1)}.slider[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover{filter:grayscale(0)}.slider[reverse=true][_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_reversePlay 10s linear infinite}@keyframes _ngcontent-%COMP%_reversePlay{0%{left:calc(var(--width) * -1)}to{left:100%}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.footer[_ngcontent-%COMP%]{background-color:transparent;color:#fff;padding:3rem 2rem 1rem;font-family:BasisGrotesque,sans-serif}.footer-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;gap:2rem;max-width:1200px;margin:0 auto}.footer-column[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1.2rem;border-bottom:2px solid #00fffc;display:inline-block;padding-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#fff;transition:color .3s ease}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.payment-methods[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-top:1rem}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:35px;transition:transform .3s ease}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.footer-bottom[_ngcontent-%COMP%]{text-align:center;margin-top:2rem;font-size:.9rem;border-top:1px solid rgba(255,255,255,.2);padding-top:1rem}@media (max-width: 992px){.techop-container[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:center}.techop[_ngcontent-%COMP%], .text-container[_ngcontent-%COMP%]{max-width:90%}.navbar[_ngcontent-%COMP%]{flex-direction:column;align-items:center;background-color:transparent;position:relative}.navbar-links[_ngcontent-%COMP%]{flex-direction:column;align-items:center;width:100%;gap:.5rem;padding-top:1rem}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:10px 0;display:block}h1[_ngcontent-%COMP%]{font-size:3em}}@media (max-width: 576px){h1[_ngcontent-%COMP%]{font-size:2.5em;letter-spacing:2px}.footer-content[_ngcontent-%COMP%]{flex-direction:column;align-items:center;gap:1.5rem}.footer-column[_ngcontent-%COMP%]{text-align:center}.payment-methods[_ngcontent-%COMP%]{justify-content:center}.slider[_ngcontent-%COMP%]{--width: 70px;--height: 40px}.slider[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{animation-duration:12s}}']})};var Ix="firebase",Tx="11.3.1";Xn(Ix,Tx,"app");var Ll={apiKey:"AIzaSyAaDXmrWh9CDVSf8nXy4OrP0RRRDhELy1k",authDomain:"techop-ecommerce.firebaseapp.com",projectId:"techop-ecommerce",storageBucket:"techop-ecommerce.firebasestorage.app",messagingSenderId:"197559304625",appId:"1:197559304625:web:3be6b770cfe02b9bcf3d90",measurementId:"G-M9C1P9G76T"};var Ul=class r{constructor(e){this.http=e}auth=kh(Cv(Ll));signUp(e){return Rh(this.auth,e.email,e.password).then(t=>(this.sendWelcomeEmail(e.email),t)).catch(t=>{throw console.error("Error al registrarse:",t.message),t})}login(e){return Mh(this.auth,e.email,e.password)}logInGoogle(){return Oh(this.auth,new Ph)}logLogout(){return Dh(this.auth)}resetPassword(e){return xh(this.auth,e)}isAuthenticated(){return this.auth.currentUser!==null}sendWelcomeEmail(e){this.http.post("https://techop-e-commerce.onrender.com/api/register",{email:e}).subscribe(t=>{console.log("Correo de bienvenida enviado:",t.message)},t=>{console.error("Error al enviar el correo:",t)})}static \u0275fac=function(t){return new(t||r)(q(Sn))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})};function Sx(r,e){if(r&1){let t=jt();_(0,"form",10),ye("ngSubmit",function(){Ee(t);let i=ce();return Ce(i.onSubmitLogin())}),_(1,"h2"),E(2,"Login"),v(),_(3,"div",11)(4,"input",12),bt("ngModelChange",function(i){Ee(t);let o=ce();return Ct(o.userData.email,i)||(o.userData.email=i),Ce(i)}),v(),_(5,"label"),E(6,"Email"),v()(),_(7,"div",11)(8,"input",13),bt("ngModelChange",function(i){Ee(t);let o=ce();return Ct(o.userData.password,i)||(o.userData.password=i),Ce(i)}),v(),_(9,"label"),E(10,"Password"),v()(),_(11,"div",34)(12,"a",35),ye("click",function(i){Ee(t);let o=ce();return Ce(o.toggleFormResetPassword(i,!0))}),E(13,"\xBFOlvidaste tu contrase\xF1a?"),v()(),_(14,"button",14),_e(15,"img",15),E(16," Login "),v(),_(17,"button",16),ye("click",function(){Ee(t);let i=ce();return Ce(i.signInWithGoogle())}),_e(18,"img",17),E(19," Login with Google "),v(),_(20,"div",18)(21,"p"),E(22,"Don't have an account? "),_(23,"a",36),ye("click",function(i){Ee(t);let o=ce();return Ce(o.toggleForm(i,!0))}),E(24,"Sign up"),v()()()()}if(r&2){let t=ce();G(4),Et("ngModel",t.userData.email),G(4),Et("ngModel",t.userData.password)}}function Px(r,e){if(r&1){let t=jt();_(0,"div")(1,"div",37)(2,"h2"),E(3,"Restablecer Contrase\xF1a"),v(),_(4,"div",11)(5,"input",38),bt("ngModelChange",function(i){Ee(t);let o=ce();return Ct(o.emailForReset,i)||(o.emailForReset=i),Ce(i)}),v(),_(6,"label"),E(7,"Correo Electr\xF3nico"),v()(),_(8,"button",39),ye("click",function(){Ee(t);let i=ce();return Ce(i.onResetPassword())}),E(9," Enviar Correo de Restablecimiento "),v(),_(10,"div",18)(11,"p"),E(12,"\xBFYa tienes una cuenta? "),_(13,"a",19),ye("click",function(i){Ee(t);let o=ce();return Ce(o.toggleForm(i,!1))}),E(14,"Iniciar sesi\xF3n"),v()()()()()}if(r&2){let t=ce();G(5),Et("ngModel",t.emailForReset)}}function xx(r,e){if(r&1&&(_(0,"div",40),E(1),v()),r&2){let t=ce();G(),Te(" ",t.errorMessage," ")}}var jl=class r{constructor(e,t){this.authService=e;this.router=t}emailReceived="";passwordReceived="";emailForReset="";currentYear=new Date().getFullYear();isSignUp=!0;showResetPasswordForm=!1;userData={email:"",password:""};errorMessage="";ngOnInit(){let e=document.querySelector(".wrapper"),t=document.querySelector(".signUp-link"),n=document.querySelector(".signIn-link");t?.addEventListener("click",i=>{i.preventDefault(),e?.classList.add("animate-signIn"),e?.classList.remove("animate-signUp")}),n?.addEventListener("click",i=>{i.preventDefault(),e?.classList.add("animate-signUp"),e?.classList.remove("animate-signIn")})}onSubmit(){let e=document.querySelector(".form-wrapper.sign-in")?.classList.contains("active");(e?this.authService.login:this.authService.signUp).call(this.authService,this.userData).then(()=>{console.log(e?"Usuario autenticado con \xE9xito":"Usuario registrado con \xE9xito"),this.clearForm(),this.router.navigate(["/profile"])}).catch(n=>{console.error("Error en la autenticaci\xF3n",n),this.showError("Error al procesar la solicitud. Intente nuevamente.")})}onSubmitSignUp(){!this.userData.email||!this.userData.email?this.showError("Uno o todos los campos de registro estan vacios. Intente nuevamente."):this.authService.signUp(this.userData).then(()=>{console.log("Usuario registrado con \xE9xito"),this.clearForm(),this.router.navigate(["/profile"])}).catch(e=>{console.error("Error en el registro",e),this.showError("Este usuario ha sido registrado. Intente nuevamente.")})}onResetPassword(){if(!this.emailForReset){this.showError("Por favor, ingresa tu correo electr\xF3nico.");return}this.authService.resetPassword(this.emailForReset).then(()=>{console.log("Correo de restablecimiento enviado."),this.showError("Te hemos enviado un correo para restablecer tu contrase\xF1a.")}).catch(e=>{console.error("Error al enviar el correo de restablecimiento",e),this.showError("Error al enviar el correo de restablecimiento. Intenta nuevamente.")})}toggleFormResetPassword(e,t){e.preventDefault(),this.clearForm(),this.isSignUp=!1,this.showResetPasswordForm=t}onSubmitLogin(){this.authService.login(this.userData).then(()=>{console.log("Usuario autenticado con \xE9xito"),this.clearForm(),this.router.navigate(["/profile"])}).catch(e=>{console.error("Error al iniciar sesi\xF3n",e),this.showError("Credenciales incorrectas. Verifique su correo y contrase\xF1a.")})}signInWithGoogle(){this.authService.logInGoogle().then(()=>{console.log("Inicio de sesi\xF3n con Google exitoso"),this.clearForm(),this.router.navigate(["/profile"])}).catch(e=>{console.error("Error al iniciar sesi\xF3n con Google",e)})}toggleForm(e,t){e.preventDefault(),this.isSignUp=t;let n=document.querySelector(".wrapper");this.isSignUp?(n?.classList.add("animate-signIn"),n?.classList.remove("animate-signUp")):(this.showResetPasswordForm=!1,n?.classList.add("animate-signUp"),n?.classList.remove("animate-signIn"))}showError(e){this.errorMessage=e,setTimeout(()=>{this.errorMessage=""},3e3)}clearForm(){this.userData.email="",this.userData.password="",this.emailForReset=""}static \u0275fac=function(t){return new(t||r)(oe(Ul),oe(Ot))};static \u0275cmp=$e({type:r,selectors:[["app-account"]],standalone:!1,decls:91,vars:6,consts:[[1,"navbar"],[1,"navbar-brand"],["routerLink","/"],[1,"navbar-links"],["routerLink","/about-us"],["routerLink","/products"],["routerLink","/account"],["routerLink","/cart"],[1,"wrapper"],[1,"form-wrapper","sign-up"],[3,"ngSubmit"],[1,"input-group"],["type","email","name","email","required","",3,"ngModelChange","ngModel"],["type","password","name","password","required","",3,"ngModelChange","ngModel"],["type","submit",1,"btn"],["src","../../assets/img/email-icon.png","alt","Email Logo"],["type","button",1,"btn","google-btn",3,"click"],["src","../../assets/img/google-icon.png","alt","Google Logo"],[1,"sign-link"],["href","#",1,"signIn-link",3,"click"],[1,"form-wrapper","sign-in"],[3,"ngSubmit",4,"ngIf"],[4,"ngIf"],["class","error-message",4,"ngIf"],[1,"footer"],[1,"footer-content"],[1,"footer-column"],["href","#"],[1,"payment-methods"],["src","assets/img/visa.svg","alt","Visa"],["src","assets/img/mastercard.svg","alt","Mastercard"],["src","assets/img/paypal.svg","alt","PayPal"],["src","assets/img/applePay.svg","alt","apple-pay"],[1,"footer-bottom"],[1,"forgot-pass"],["href","#",3,"click"],["href","#",1,"signUp-link",3,"click"],[1,"reset-password-form"],["type","email","name","emailForReset","required","",3,"ngModelChange","ngModel"],["type","button",1,"btn",3,"click"],[1,"error-message"]],template:function(t,n){t&1&&(_(0,"nav",0)(1,"div",1)(2,"a",2),E(3,"Techop"),v()(),_(4,"ul",3)(5,"li")(6,"a",4),E(7,"Sobre Nosotros"),v()(),_(8,"li")(9,"a",5),E(10,"Productos"),v()(),_(11,"li")(12,"a",6),E(13,"Cuenta"),v()(),_(14,"li")(15,"a",7),E(16,"Carrito de Compra"),v()()()(),_(17,"body")(18,"div",8)(19,"div",9)(20,"form",10),ye("ngSubmit",function(){return n.onSubmitSignUp()}),_(21,"h2"),E(22,"Sign Up"),v(),_(23,"div",11)(24,"input",12),bt("ngModelChange",function(o){return Ct(n.userData.email,o)||(n.userData.email=o),o}),v(),_(25,"label"),E(26,"Email"),v()(),_(27,"div",11)(28,"input",13),bt("ngModelChange",function(o){return Ct(n.userData.password,o)||(n.userData.password=o),o}),v(),_(29,"label"),E(30,"Password"),v()(),_(31,"button",14),_e(32,"img",15),E(33," Sign up "),v(),_(34,"button",16),ye("click",function(){return n.signInWithGoogle()}),_e(35,"img",17),E(36," Sign up with Google "),v(),_(37,"div",18)(38,"p"),E(39,"Already have an account? "),_(40,"a",19),ye("click",function(o){return n.toggleForm(o,!1)}),E(41,"Sign in"),v()()()()(),_(42,"div",20),Le(43,Sx,25,2,"form",21)(44,Px,15,1,"div",22),v(),Le(45,xx,2,1,"div",23),v()(),_(46,"footer",24)(47,"div",25)(48,"div",26)(49,"h4"),E(50,"Techop"),v(),_(51,"ul")(52,"li")(53,"a",5),E(54,"Productos"),v()(),_(55,"li")(56,"a",4),E(57,"Sobre Nosotros"),v()(),_(58,"li")(59,"a",6),E(60,"Cuenta"),v()(),_(61,"li")(62,"a",7),E(63,"Carrito"),v()()()(),_(64,"div",26)(65,"h4"),E(66,"Atenci\xF3n al Cliente"),v(),_(67,"ul")(68,"li")(69,"a",27),E(70,"Preguntas Frecuentes"),v()(),_(71,"li")(72,"a",27),E(73,"T\xE9rminos y Condiciones"),v()(),_(74,"li")(75,"a",27),E(76,"Pol\xEDtica de Privacidad"),v()(),_(77,"li")(78,"a",27),E(79,"Contacto"),v()()()(),_(80,"div",26)(81,"h4"),E(82,"M\xE9todos de Pago"),v(),_(83,"div",28),_e(84,"img",29)(85,"img",30)(86,"img",31)(87,"img",32),v()()(),_(88,"div",33)(89,"p"),E(90),v()()()),t&2&&(G(24),Et("ngModel",n.userData.email),G(4),Et("ngModel",n.userData.password),G(15),me("ngIf",!n.showResetPasswordForm),G(),me("ngIf",n.showResetPasswordForm),G(),me("ngIf",n.errorMessage),G(45),Te("\xA9 ",n.currentYear," Techop E-commerce. Todos los derechos reservados."))},dependencies:[Oi,lt,E0,Zn,ji,m0,Gs,jr,ef],styles:['@font-face{font-family:BasisGrotesque;src:url("./media/BasisGrotesqueArabicPro-Light-EN3UARNA.woff2") format("woff2");font-weight:bolder;font-style:normal}*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box;font-family:BasisGrotesque}.navbar[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;z-index:1000}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-transform:uppercase;text-decoration:none;color:#333;letter-spacing:.15em;display:inline-block;padding:15px 0}.navbar-brand[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.navbar-links[_ngcontent-%COMP%]{list-style:none;display:flex;gap:1.5rem}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#333;text-transform:uppercase;text-decoration:none;letter-spacing:.15em;padding:15px 20px}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}body[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(to bottom,#fff,#1e3c72);overflow:hidden}.wrapper[_ngcontent-%COMP%]{position:relative;width:400px;height:500px}.form-wrapper[_ngcontent-%COMP%]{position:absolute;top:0;left:0;display:flex;justify-content:center;align-items:center;width:100%;height:100%;background:#fff;box-shadow:0 0 10px #0003}.wrapper.animate-signUp[_ngcontent-%COMP%]   .form-wrapper.sign-in[_ngcontent-%COMP%]{transform:rotate(7deg);animation:_ngcontent-%COMP%_animateRotate .7s ease-in-out forwards;animation-delay:.3s}.wrapper.animate-signIn[_ngcontent-%COMP%]   .form-wrapper.sign-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_animateSignIn 1.5s ease-in-out forwards}.wrapper[_ngcontent-%COMP%]   .form-wrapper.sign-up[_ngcontent-%COMP%]{transform:rotate(7deg)}.wrapper.animate-signIn[_ngcontent-%COMP%]   .form-wrapper.sign-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_animateRotate .7s ease-in-out forwards;animation-delay:.3s}.wrapper.animate-signUp[_ngcontent-%COMP%]   .form-wrapper.sign-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_animateSignUp 1.5s ease-in-out forwards}@keyframes _ngcontent-%COMP%_animateSignIn{0%{transform:translate(0)}50%{transform:translate(-500px)}to{transform:translate(0) rotate(7deg)}}@keyframes _ngcontent-%COMP%_animateRotate{0%{transform:rotate(7deg)}to{transform:rotate(0);z-index:1}}@keyframes _ngcontent-%COMP%_animateSignUp{0%{transform:translate(0);z-index:1}50%{transform:translate(500px)}to{transform:translate(0) rotate(7deg)}}h2[_ngcontent-%COMP%]{font-size:30px;color:#555;text-align:center}.input-group[_ngcontent-%COMP%]{position:relative;width:320px;margin:30px 0}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:40px;font-size:16px;padding:0 10px;border:1px solid #333;border-radius:5px;background:transparent;color:#333;outline:none}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:50%;left:5px;transform:translateY(-50%);font-size:16px;color:#333;padding:0 5px;pointer-events:none;transition:.5s}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:valid ~ label[_ngcontent-%COMP%]{top:0;font-size:12px;background:#fff}.forgot-pass[_ngcontent-%COMP%]{margin:-15px 0 15px;font-size:14px}.forgot-pass[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#333;text-decoration:none}.forgot-pass[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.btn[_ngcontent-%COMP%]{width:100%;color:#fff;background:linear-gradient(to right,#2196f3,#e91e63);box-shadow:0 2px 10px #0006;font-size:16px;gap:10px;padding:10px;font-weight:500;border-radius:5px;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease-in-out}.btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.google-btn[_ngcontent-%COMP%]{margin-top:10px}.google-btn[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.sign-link[_ngcontent-%COMP%]{font-size:14px;text-align:center;margin:25px 0}.sign-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#e91e63;font-weight:600;text-decoration:none}.sign-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.error-message[_ngcontent-%COMP%]{background:linear-gradient(to right,#2196f3,#e91e63);color:#fff;padding:10px;border-radius:5px;position:absolute;top:-15px;left:50%;transform:translate(-50%);z-index:1000;animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.footer[_ngcontent-%COMP%]{background-color:#1e3c72;color:#fff;padding:3rem 2rem 1rem}.footer-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;gap:2rem;max-width:1200px;margin:0 auto}.footer-column[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1.2rem;border-bottom:2px solid #00fffc;padding-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.footer-column[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem}.footer-column[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;transition:color .3s ease}.footer-column[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00fffc}.payment-methods[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-top:1rem}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:35px;transition:transform .3s ease}.payment-methods[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.footer-bottom[_ngcontent-%COMP%]{text-align:center;margin-top:2rem;font-size:.9rem;border-top:1px solid rgba(255,255,255,.2);padding-top:1rem}@media (max-width: 768px){.navbar[_ngcontent-%COMP%]{flex-direction:column;align-items:center;background-color:transparent;position:relative}.navbar-links[_ngcontent-%COMP%]{flex-direction:column;align-items:center;width:100%;gap:.5rem;padding-top:1rem}.navbar-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:10px 0;display:block}.footer-content[_ngcontent-%COMP%]{flex-direction:column;align-items:center}.payment-methods[_ngcontent-%COMP%]{justify-content:center}}']})};var ww=[{path:"",component:xl,title:"Home"},{path:"products",component:Rl,title:"Product List"},{path:"products/:id",component:Ml,title:"Product Detail"},{path:"cart",component:kl,title:"Cart"},{path:"account",component:jl,title:"Account"},{path:"profile",component:Vl,title:"Profile"},{path:"about-us",component:Fl,title:"About us"},{path:"**",component:Nl,title:"404 - Not Found"}];var Bl=class r{static \u0275fac=function(t){return new(t||r)};static \u0275mod=Ze({type:r});static \u0275inj=Je({imports:[qf.forRoot(ww),qf]})};function gt(r){r===void 0&&(U_(gt),r=$(on));let e=r.get(ph);return t=>new tn(n=>{let i=e.add(),o=!1;function s(){o||(i(),o=!0)}let c=t.subscribe({next:l=>{n.next(l),s()},complete:()=>{n.complete(),s()},error:l=>{n.error(l),s()}});return c.add(()=>{n.unsubscribe(),s()}),c})}var eo=new Ts("ANGULARFIRE2_VERSION");var Ew=(r,e)=>{let t=e?[e]:bv(),n=[];return t.forEach(i=>{i.container.getProvider(r).instances.forEach(s=>{n.includes(s)||n.push(s)})}),n},zf=function(r){return r[r.SILENT=0]="SILENT",r[r.WARN=1]="WARN",r[r.VERBOSE=2]="VERBOSE",r}(zf||{}),TV=As()&&typeof Zone<"u"?zf.WARN:zf.SILENT;var ql=class{zone;delegate;constructor(e,t=P_){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){let i=this.zone,o=function(s){i?i.runGuarded(()=>{e.apply(this,[s])}):e.apply(this,[s])};return this.delegate.schedule(o,t,n)}},da=(()=>{class r{outsideAngular;insideAngular;constructor(){let t=$(Ne);this.outsideAngular=t.runOutsideAngular(()=>new ql(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new ql(typeof Zone>"u"?void 0:Zone.current,Ic))}static \u0275fac=function(n){return new(n||r)};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var Rx="firebase",Mx="11.3.1";It.registerVersion(Rx,Mx,"app-compat");var Dx=["ngOnDestroy"],Iw=(r,e,t,n={})=>new Proxy(r,{get:(i,o)=>t.runOutsideAngular(()=>{if(r[o])return n?.spy?.get&&n.spy.get(o,r[o]),r[o];if(Dx.indexOf(o)>-1)return()=>{};let s=e.toPromise().then(c=>{let l=c?.[o];return typeof l=="function"?l.bind(c):l?.then?l.then(d=>t.run(()=>d)):t.run(()=>l)});return new Proxy(()=>{},{get:(c,l)=>s[l],apply:(c,l,d)=>s.then(f=>{let p=f?.(...d);return n?.spy?.apply&&n.spy.apply(o,d,p),p})})})});var zl=class{constructor(e){return e}},to=new te("angularfire2.app.options"),no=new te("angularfire2.app.name");function ha(r,e,t){let n=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||n;let s=It.apps.filter(c=>c&&c.name===i.name)[0]||e.runOutsideAngular(()=>It.initializeApp(r,i));try{if(JSON.stringify(r)!==JSON.stringify(s.options)){let c=!!module.hot;Ox("error",`${s.name} Firebase App already initialized with different options${c?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new zl(s)}var Ox=(r,...e)=>{As()&&typeof console<"u"&&console[r](...e)},kx={provide:zl,useFactory:ha,deps:[to,Ne,[new hh,no]]},Tw=(()=>{class r{static initializeApp(t,n){return{ngModule:r,providers:[{provide:to,useValue:t},{provide:no,useValue:n}]}}constructor(t){It.registerVersion("angularfire",eo.full,"core"),It.registerVersion("angularfire",eo.full,"app-compat"),It.registerVersion("angular",tv.full,t.toString())}static \u0275fac=function(n){return new(n||r)(q(Lt))};static \u0275mod=Ze({type:r});static \u0275inj=Je({providers:[kx]})}return r})();function $l(r,e,t,n,i){let[,o,s]=globalThis.\u0275AngularfireInstanceCache.find(c=>c[0]===r)||[];if(o)return Vx(i,s)||(bw("error",`${e} was already initialized on the ${t} Firebase App with different settings.${Nx?" You may need to reload as Firebase is not HMR aware.":""}`),bw("warn",{is:i,was:s})),o;{let c=n();return globalThis.\u0275AngularfireInstanceCache.push([r,c,i]),c}}function Vx(r,e){try{return r.toString()===e.toString()}catch{return r===e}}var Nx=typeof module<"u"&&!!module.hot,bw=(r,...e)=>{As()&&typeof console<"u"&&console[r](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Ux=new Map,jx={activated:!1,tokenObservers:[]},Bx={initialized:!1,enabled:!1};function Kt(r){return Ux.get(r)||Object.assign({},jx)}function Rw(){return Bx}var qx="https://content-firebaseappcheck.googleapis.com/v1";var zx="exchangeDebugToken",Aw={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},qV=24*60*60*1e3;var Gf=class{constructor(e,t,n,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return k(this,null,function*(){this.stop();try{this.pending=new Th,this.pending.promise.catch(t=>{}),yield $x(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Th,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function $x(r){return new Promise(e=>{setTimeout(e,r)})}var Gx={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},rr=new vv("appCheck","AppCheck",Gx);function Mw(r){if(!Kt(r).activated)throw rr.create("use-before-activation",{appName:r.name})}function Dw(n,i){return k(this,arguments,function*({url:r,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let b=yield s.getHeartbeatsHeader();b&&(o["X-Firebase-Client"]=b)}let c={method:"POST",body:JSON.stringify(e),headers:o},l;try{l=yield fetch(r,c)}catch(b){throw rr.create("fetch-network-error",{originalErrorMessage:b?.message})}if(l.status!==200)throw rr.create("fetch-status-error",{httpStatus:l.status});let d;try{d=yield l.json()}catch(b){throw rr.create("fetch-parse-error",{originalErrorMessage:b?.message})}let f=d.ttl.match(/^([\d.]+)(s)$/);if(!f||!f[2]||isNaN(Number(f[1])))throw rr.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let p=Number(f[1])*1e3,g=Date.now();return{token:d.token,expireTimeMillis:g+p,issuedAtTimeMillis:g}})}function Ow(r,e){let{projectId:t,appId:n,apiKey:i}=r.options;return{url:`${qx}/projects/${t}/apps/${n}:${zx}?key=${i}`,body:{debug_token:e}}}var Wx="firebase-app-check-database",Kx=1,Wf="firebase-app-check-store";var Gl=null;function Hx(){return Gl||(Gl=new Promise((r,e)=>{try{let t=indexedDB.open(Wx,Kx);t.onsuccess=n=>{r(n.target.result)},t.onerror=n=>{var i;e(rr.create("storage-open",{originalErrorMessage:(i=n.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=n=>{let i=n.target.result;switch(n.oldVersion){case 0:i.createObjectStore(Wf,{keyPath:"compositeKey"})}}}catch(t){e(rr.create("storage-open",{originalErrorMessage:t?.message}))}}),Gl)}function Qx(r,e){return Yx(Xx(r),e)}function Yx(r,e){return k(this,null,function*(){let n=(yield Hx()).transaction(Wf,"readwrite"),o=n.objectStore(Wf).put({compositeKey:r,value:e});return new Promise((s,c)=>{o.onsuccess=l=>{s()},n.onerror=l=>{var d;c(rr.create("storage-set",{originalErrorMessage:(d=l.target.error)===null||d===void 0?void 0:d.message}))}})})}function Xx(r){return`${r.options.appId}-${r.name}`}var Kf=new jc("@firebase/app-check");function $f(r,e){return Uc()?Qx(r,e).catch(t=>{Kf.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function kw(){return Rw().enabled}function Vw(){return k(this,null,function*(){let r=Rw();if(r.enabled&&r.token)return r.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Jx={error:"UNKNOWN_ERROR"};function Zx(r){return gv.encodeString(JSON.stringify(r),!1)}function Hf(r,e=!1){return k(this,null,function*(){let t=r.app;Mw(t);let n=Kt(t),i=n.token,o;if(i&&!fa(i)&&(n.token=void 0,i=void 0),!i){let l=yield n.cachedTokenPromise;l&&(fa(l)?i=l:yield $f(t,void 0))}if(!e&&i&&fa(i))return{token:i.token};let s=!1;if(kw()){n.exchangeTokenPromise||(n.exchangeTokenPromise=Dw(Ow(t,yield Vw()),r.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),s=!0);let l=yield n.exchangeTokenPromise;return yield $f(t,l),n.token=l,{token:l.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),s=!0),i=yield Kt(t).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"?Kf.warn(l.message):Kf.error(l),o=l}let c;return i?o?fa(i)?c={token:i.token,internalError:o}:c=Pw(o):(c={token:i.token},n.token=i,yield $f(t,i)):c=Pw(o),s&&r1(t,c),c})}function e1(r){return k(this,null,function*(){let e=r.app;Mw(e);let{provider:t}=Kt(e);if(kw()){let n=yield Vw(),{token:i}=yield Dw(Ow(e,n),r.heartbeatServiceProvider);return{token:i}}else{let{token:n}=yield t.getToken();return{token:n}}})}function t1(r,e,t,n){let{app:i}=r,o=Kt(i),s={next:t,error:n,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&fa(o.token)){let c=o.token;Promise.resolve().then(()=>{t({token:c.token}),Sw(r)}).catch(()=>{})}o.cachedTokenPromise.then(()=>Sw(r))}function Nw(r,e){let t=Kt(r),n=t.tokenObservers.filter(i=>i.next!==e);n.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function Sw(r){let{app:e}=r,t=Kt(e),n=t.tokenRefresher;n||(n=n1(r),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function n1(r){let{app:e}=r;return new Gf(()=>k(this,null,function*(){let t=Kt(e),n;if(t.token?n=yield Hf(r,!0):n=yield Hf(r),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{let t=Kt(e);if(t.token){let n=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return n=Math.min(n,i),Math.max(0,n-Date.now())}else return 0},Aw.RETRIAL_MIN_WAIT,Aw.RETRIAL_MAX_WAIT)}function r1(r,e){let t=Kt(r).tokenObservers;for(let n of t)try{n.type==="EXTERNAL"&&e.error!=null?n.error(e.error):n.next(e)}catch{}}function fa(r){return r.expireTimeMillis-Date.now()>0}function Pw(r){return{token:Zx(Jx),error:r}}var Qf=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Kt(this.app);for(let t of e)Nw(this.app,t.next);return Promise.resolve()}};function i1(r,e){return new Qf(r,e)}function o1(r){return{getToken:e=>Hf(r,e),getLimitedUseToken:()=>e1(r),addTokenListener:e=>t1(r,"INTERNAL",e),removeTokenListener:e=>Nw(r.app,e)}}var s1="@firebase/app-check",a1="0.8.11";var c1="app-check",xw="app-check-internal";function l1(){Ms(new Lr(c1,r=>{let e=r.getProvider("app").getImmediate(),t=r.getProvider("heartbeat");return i1(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((r,e,t)=>{r.getProvider(xw).initialize()})),Ms(new Lr(xw,r=>{let e=r.getProvider("app-check").getImmediate();return o1(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Xn(s1,a1)}l1();var u1="app-check";var ro=class{constructor(){return Ew(u1)}};var d1=["localhost","0.0.0.0","127.0.0.1"],rN=typeof window<"u"&&d1.includes(window.location.hostname);var Yf=new te("angularfire2.auth.use-emulator"),Xf=new te("angularfire2.auth.settings"),Jf=new te("angularfire2.auth.tenant-id"),Zf=new te("angularfire2.auth.langugage-code"),ep=new te("angularfire2.auth.use-device-language"),tp=new te("angularfire.auth.persistence"),np=(r,e,t,n,i,o,s,c)=>$l(`${r.name}.auth`,"AngularFireAuth",r.name,()=>{let l=e.runOutsideAngular(()=>r.auth());if(t&&l.useEmulator(...t),n&&(l.tenantId=n),l.languageCode=i,o&&l.useDeviceLanguage(),s)for(let[d,f]of Object.entries(s))l.settings[d]=f;return c&&l.setPersistence(c),l},[t,n,i,o,s,c]),Lw=(()=>{class r{injector=$(wt);authState;idToken;user;idTokenResult;credential;constructor(t,n,i,o,s,c,l,d,f,p,g,b){let V=new Pt,O=X(void 0).pipe(vs(s.outsideAngular),ze(()=>o.runOutsideAngular(()=>import("./chunk-OCD2STI7.js"))),Z(()=>ha(t,o,n)),Z(R=>np(R,o,c,d,f,p,l,g)),lh({bufferSize:1,refCount:!1}));if(Fr(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=X(null);else{O.pipe(nn()).subscribe();let R=O.pipe(ze(L=>L.getRedirectResult().then(J=>J,()=>null)),gt(this.injector),lh({bufferSize:1,refCount:!1})),K=O.pipe(ze(L=>new tn(J=>({unsubscribe:o.runOutsideAngular(()=>L.onAuthStateChanged(ne=>J.next(ne),ne=>J.error(ne),()=>J.complete()))})))),Q=O.pipe(ze(L=>new tn(J=>({unsubscribe:o.runOutsideAngular(()=>L.onIdTokenChanged(ne=>J.next(ne),ne=>J.error(ne),()=>J.complete()))}))));this.authState=R.pipe(uh(K),Tc(s.outsideAngular),vs(s.insideAngular)),this.user=R.pipe(uh(Q),Tc(s.outsideAngular),vs(s.insideAngular)),this.idToken=this.user.pipe(ze(L=>L?Pe(L.getIdToken()):X(null))),this.idTokenResult=this.user.pipe(ze(L=>L?Pe(L.getIdTokenResult()):X(null))),this.credential=O_(R,V,this.authState.pipe(vt(L=>!L))).pipe(Z(L=>L?.user?L:null),Tc(s.outsideAngular),vs(s.insideAngular))}return Iw(this,O,o,{spy:{apply:(R,K,Q)=>{(R.startsWith("signIn")||R.startsWith("createUser"))&&Q.then(L=>V.next(L))}}})}static \u0275fac=function(n){return new(n||r)(q(to),q(no,8),q(Lt),q(Ne),q(da),q(Yf,8),q(Xf,8),q(Jf,8),q(Zf,8),q(ep,8),q(tp,8),q(ro,8))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"any"})}return r})();var Uw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},jw={};var Dn,rp;(function(){var r;function e(I,y){function C(){}C.prototype=y.prototype,I.D=y.prototype,I.prototype=new C,I.prototype.constructor=I,I.C=function(T,A,P){for(var w=Array(arguments.length-2),wn=2;wn<arguments.length;wn++)w[wn-2]=arguments[wn];return y.prototype[A].apply(T,w)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,y,C){C||(C=0);var T=Array(16);if(typeof y=="string")for(var A=0;16>A;++A)T[A]=y.charCodeAt(C++)|y.charCodeAt(C++)<<8|y.charCodeAt(C++)<<16|y.charCodeAt(C++)<<24;else for(A=0;16>A;++A)T[A]=y[C++]|y[C++]<<8|y[C++]<<16|y[C++]<<24;y=I.g[0],C=I.g[1],A=I.g[2];var P=I.g[3],w=y+(P^C&(A^P))+T[0]+3614090360&4294967295;y=C+(w<<7&4294967295|w>>>25),w=P+(A^y&(C^A))+T[1]+3905402710&4294967295,P=y+(w<<12&4294967295|w>>>20),w=A+(C^P&(y^C))+T[2]+606105819&4294967295,A=P+(w<<17&4294967295|w>>>15),w=C+(y^A&(P^y))+T[3]+3250441966&4294967295,C=A+(w<<22&4294967295|w>>>10),w=y+(P^C&(A^P))+T[4]+4118548399&4294967295,y=C+(w<<7&4294967295|w>>>25),w=P+(A^y&(C^A))+T[5]+1200080426&4294967295,P=y+(w<<12&4294967295|w>>>20),w=A+(C^P&(y^C))+T[6]+2821735955&4294967295,A=P+(w<<17&4294967295|w>>>15),w=C+(y^A&(P^y))+T[7]+4249261313&4294967295,C=A+(w<<22&4294967295|w>>>10),w=y+(P^C&(A^P))+T[8]+1770035416&4294967295,y=C+(w<<7&4294967295|w>>>25),w=P+(A^y&(C^A))+T[9]+2336552879&4294967295,P=y+(w<<12&4294967295|w>>>20),w=A+(C^P&(y^C))+T[10]+4294925233&4294967295,A=P+(w<<17&4294967295|w>>>15),w=C+(y^A&(P^y))+T[11]+2304563134&4294967295,C=A+(w<<22&4294967295|w>>>10),w=y+(P^C&(A^P))+T[12]+1804603682&4294967295,y=C+(w<<7&4294967295|w>>>25),w=P+(A^y&(C^A))+T[13]+4254626195&4294967295,P=y+(w<<12&4294967295|w>>>20),w=A+(C^P&(y^C))+T[14]+2792965006&4294967295,A=P+(w<<17&4294967295|w>>>15),w=C+(y^A&(P^y))+T[15]+1236535329&4294967295,C=A+(w<<22&4294967295|w>>>10),w=y+(A^P&(C^A))+T[1]+4129170786&4294967295,y=C+(w<<5&4294967295|w>>>27),w=P+(C^A&(y^C))+T[6]+3225465664&4294967295,P=y+(w<<9&4294967295|w>>>23),w=A+(y^C&(P^y))+T[11]+643717713&4294967295,A=P+(w<<14&4294967295|w>>>18),w=C+(P^y&(A^P))+T[0]+3921069994&4294967295,C=A+(w<<20&4294967295|w>>>12),w=y+(A^P&(C^A))+T[5]+3593408605&4294967295,y=C+(w<<5&4294967295|w>>>27),w=P+(C^A&(y^C))+T[10]+38016083&4294967295,P=y+(w<<9&4294967295|w>>>23),w=A+(y^C&(P^y))+T[15]+3634488961&4294967295,A=P+(w<<14&4294967295|w>>>18),w=C+(P^y&(A^P))+T[4]+3889429448&4294967295,C=A+(w<<20&4294967295|w>>>12),w=y+(A^P&(C^A))+T[9]+568446438&4294967295,y=C+(w<<5&4294967295|w>>>27),w=P+(C^A&(y^C))+T[14]+3275163606&4294967295,P=y+(w<<9&4294967295|w>>>23),w=A+(y^C&(P^y))+T[3]+4107603335&4294967295,A=P+(w<<14&4294967295|w>>>18),w=C+(P^y&(A^P))+T[8]+1163531501&4294967295,C=A+(w<<20&4294967295|w>>>12),w=y+(A^P&(C^A))+T[13]+2850285829&4294967295,y=C+(w<<5&4294967295|w>>>27),w=P+(C^A&(y^C))+T[2]+4243563512&4294967295,P=y+(w<<9&4294967295|w>>>23),w=A+(y^C&(P^y))+T[7]+1735328473&4294967295,A=P+(w<<14&4294967295|w>>>18),w=C+(P^y&(A^P))+T[12]+2368359562&4294967295,C=A+(w<<20&4294967295|w>>>12),w=y+(C^A^P)+T[5]+4294588738&4294967295,y=C+(w<<4&4294967295|w>>>28),w=P+(y^C^A)+T[8]+2272392833&4294967295,P=y+(w<<11&4294967295|w>>>21),w=A+(P^y^C)+T[11]+1839030562&4294967295,A=P+(w<<16&4294967295|w>>>16),w=C+(A^P^y)+T[14]+4259657740&4294967295,C=A+(w<<23&4294967295|w>>>9),w=y+(C^A^P)+T[1]+2763975236&4294967295,y=C+(w<<4&4294967295|w>>>28),w=P+(y^C^A)+T[4]+1272893353&4294967295,P=y+(w<<11&4294967295|w>>>21),w=A+(P^y^C)+T[7]+4139469664&4294967295,A=P+(w<<16&4294967295|w>>>16),w=C+(A^P^y)+T[10]+3200236656&4294967295,C=A+(w<<23&4294967295|w>>>9),w=y+(C^A^P)+T[13]+681279174&4294967295,y=C+(w<<4&4294967295|w>>>28),w=P+(y^C^A)+T[0]+3936430074&4294967295,P=y+(w<<11&4294967295|w>>>21),w=A+(P^y^C)+T[3]+3572445317&4294967295,A=P+(w<<16&4294967295|w>>>16),w=C+(A^P^y)+T[6]+76029189&4294967295,C=A+(w<<23&4294967295|w>>>9),w=y+(C^A^P)+T[9]+3654602809&4294967295,y=C+(w<<4&4294967295|w>>>28),w=P+(y^C^A)+T[12]+3873151461&4294967295,P=y+(w<<11&4294967295|w>>>21),w=A+(P^y^C)+T[15]+530742520&4294967295,A=P+(w<<16&4294967295|w>>>16),w=C+(A^P^y)+T[2]+3299628645&4294967295,C=A+(w<<23&4294967295|w>>>9),w=y+(A^(C|~P))+T[0]+4096336452&4294967295,y=C+(w<<6&4294967295|w>>>26),w=P+(C^(y|~A))+T[7]+1126891415&4294967295,P=y+(w<<10&4294967295|w>>>22),w=A+(y^(P|~C))+T[14]+2878612391&4294967295,A=P+(w<<15&4294967295|w>>>17),w=C+(P^(A|~y))+T[5]+4237533241&4294967295,C=A+(w<<21&4294967295|w>>>11),w=y+(A^(C|~P))+T[12]+1700485571&4294967295,y=C+(w<<6&4294967295|w>>>26),w=P+(C^(y|~A))+T[3]+2399980690&4294967295,P=y+(w<<10&4294967295|w>>>22),w=A+(y^(P|~C))+T[10]+4293915773&4294967295,A=P+(w<<15&4294967295|w>>>17),w=C+(P^(A|~y))+T[1]+2240044497&4294967295,C=A+(w<<21&4294967295|w>>>11),w=y+(A^(C|~P))+T[8]+1873313359&4294967295,y=C+(w<<6&4294967295|w>>>26),w=P+(C^(y|~A))+T[15]+4264355552&4294967295,P=y+(w<<10&4294967295|w>>>22),w=A+(y^(P|~C))+T[6]+2734768916&4294967295,A=P+(w<<15&4294967295|w>>>17),w=C+(P^(A|~y))+T[13]+1309151649&4294967295,C=A+(w<<21&4294967295|w>>>11),w=y+(A^(C|~P))+T[4]+4149444226&4294967295,y=C+(w<<6&4294967295|w>>>26),w=P+(C^(y|~A))+T[11]+3174756917&4294967295,P=y+(w<<10&4294967295|w>>>22),w=A+(y^(P|~C))+T[2]+718787259&4294967295,A=P+(w<<15&4294967295|w>>>17),w=C+(P^(A|~y))+T[9]+3951481745&4294967295,I.g[0]=I.g[0]+y&4294967295,I.g[1]=I.g[1]+(A+(w<<21&4294967295|w>>>11))&4294967295,I.g[2]=I.g[2]+A&4294967295,I.g[3]=I.g[3]+P&4294967295}n.prototype.u=function(I,y){y===void 0&&(y=I.length);for(var C=y-this.blockSize,T=this.B,A=this.h,P=0;P<y;){if(A==0)for(;P<=C;)i(this,I,P),P+=this.blockSize;if(typeof I=="string"){for(;P<y;)if(T[A++]=I.charCodeAt(P++),A==this.blockSize){i(this,T),A=0;break}}else for(;P<y;)if(T[A++]=I[P++],A==this.blockSize){i(this,T),A=0;break}}this.h=A,this.o+=y},n.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var y=1;y<I.length-8;++y)I[y]=0;var C=8*this.o;for(y=I.length-8;y<I.length;++y)I[y]=C&255,C/=256;for(this.u(I),I=Array(16),y=C=0;4>y;++y)for(var T=0;32>T;T+=8)I[C++]=this.g[y]>>>T&255;return I};function o(I,y){var C=c;return Object.prototype.hasOwnProperty.call(C,I)?C[I]:C[I]=y(I)}function s(I,y){this.h=y;for(var C=[],T=!0,A=I.length-1;0<=A;A--){var P=I[A]|0;T&&P==y||(C[A]=P,T=!1)}this.g=C}var c={};function l(I){return-128<=I&&128>I?o(I,function(y){return new s([y|0],0>y?-1:0)}):new s([I|0],0>I?-1:0)}function d(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return R(d(-I));for(var y=[],C=1,T=0;I>=C;T++)y[T]=I/C|0,C*=4294967296;return new s(y,0)}function f(I,y){if(I.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(I.charAt(0)=="-")return R(f(I.substring(1),y));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=d(Math.pow(y,8)),T=p,A=0;A<I.length;A+=8){var P=Math.min(8,I.length-A),w=parseInt(I.substring(A,A+P),y);8>P?(P=d(Math.pow(y,P)),T=T.j(P).add(d(w))):(T=T.j(C),T=T.add(d(w)))}return T}var p=l(0),g=l(1),b=l(16777216);r=s.prototype,r.m=function(){if(O(this))return-R(this).m();for(var I=0,y=1,C=0;C<this.g.length;C++){var T=this.i(C);I+=(0<=T?T:4294967296+T)*y,y*=4294967296}return I},r.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(V(this))return"0";if(O(this))return"-"+R(this).toString(I);for(var y=d(Math.pow(I,6)),C=this,T="";;){var A=J(C,y).g;C=K(C,A.j(y));var P=((0<C.g.length?C.g[0]:C.h)>>>0).toString(I);if(C=A,V(C))return P+T;for(;6>P.length;)P="0"+P;T=P+T}},r.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function V(I){if(I.h!=0)return!1;for(var y=0;y<I.g.length;y++)if(I.g[y]!=0)return!1;return!0}function O(I){return I.h==-1}r.l=function(I){return I=K(this,I),O(I)?-1:V(I)?0:1};function R(I){for(var y=I.g.length,C=[],T=0;T<y;T++)C[T]=~I.g[T];return new s(C,~I.h).add(g)}r.abs=function(){return O(this)?R(this):this},r.add=function(I){for(var y=Math.max(this.g.length,I.g.length),C=[],T=0,A=0;A<=y;A++){var P=T+(this.i(A)&65535)+(I.i(A)&65535),w=(P>>>16)+(this.i(A)>>>16)+(I.i(A)>>>16);T=w>>>16,P&=65535,w&=65535,C[A]=w<<16|P}return new s(C,C[C.length-1]&-2147483648?-1:0)};function K(I,y){return I.add(R(y))}r.j=function(I){if(V(this)||V(I))return p;if(O(this))return O(I)?R(this).j(R(I)):R(R(this).j(I));if(O(I))return R(this.j(R(I)));if(0>this.l(b)&&0>I.l(b))return d(this.m()*I.m());for(var y=this.g.length+I.g.length,C=[],T=0;T<2*y;T++)C[T]=0;for(T=0;T<this.g.length;T++)for(var A=0;A<I.g.length;A++){var P=this.i(T)>>>16,w=this.i(T)&65535,wn=I.i(A)>>>16,es=I.i(A)&65535;C[2*T+2*A]+=w*es,Q(C,2*T+2*A),C[2*T+2*A+1]+=P*es,Q(C,2*T+2*A+1),C[2*T+2*A+1]+=w*wn,Q(C,2*T+2*A+1),C[2*T+2*A+2]+=P*wn,Q(C,2*T+2*A+2)}for(T=0;T<y;T++)C[T]=C[2*T+1]<<16|C[2*T];for(T=y;T<2*y;T++)C[T]=0;return new s(C,0)};function Q(I,y){for(;(I[y]&65535)!=I[y];)I[y+1]+=I[y]>>>16,I[y]&=65535,y++}function L(I,y){this.g=I,this.h=y}function J(I,y){if(V(y))throw Error("division by zero");if(V(I))return new L(p,p);if(O(I))return y=J(R(I),y),new L(R(y.g),R(y.h));if(O(y))return y=J(I,R(y)),new L(R(y.g),y.h);if(30<I.g.length){if(O(I)||O(y))throw Error("slowDivide_ only works with positive integers.");for(var C=g,T=y;0>=T.l(I);)C=ne(C),T=ne(T);var A=re(C,1),P=re(T,1);for(T=re(T,2),C=re(C,2);!V(T);){var w=P.add(T);0>=w.l(I)&&(A=A.add(C),P=w),T=re(T,1),C=re(C,1)}return y=K(I,A.j(y)),new L(A,y)}for(A=p;0<=I.l(y);){for(C=Math.max(1,Math.floor(I.m()/y.m())),T=Math.ceil(Math.log(C)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),P=d(C),w=P.j(y);O(w)||0<w.l(I);)C-=T,P=d(C),w=P.j(y);V(P)&&(P=g),A=A.add(P),I=K(I,w)}return new L(A,I)}r.A=function(I){return J(this,I).h},r.and=function(I){for(var y=Math.max(this.g.length,I.g.length),C=[],T=0;T<y;T++)C[T]=this.i(T)&I.i(T);return new s(C,this.h&I.h)},r.or=function(I){for(var y=Math.max(this.g.length,I.g.length),C=[],T=0;T<y;T++)C[T]=this.i(T)|I.i(T);return new s(C,this.h|I.h)},r.xor=function(I){for(var y=Math.max(this.g.length,I.g.length),C=[],T=0;T<y;T++)C[T]=this.i(T)^I.i(T);return new s(C,this.h^I.h)};function ne(I){for(var y=I.g.length+1,C=[],T=0;T<y;T++)C[T]=I.i(T)<<1|I.i(T-1)>>>31;return new s(C,I.h)}function re(I,y){var C=y>>5;y%=32;for(var T=I.g.length-C,A=[],P=0;P<T;P++)A[P]=0<y?I.i(P+C)>>>y|I.i(P+C+1)<<32-y:I.i(P+C);return new s(A,I.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,rp=jw.Md5=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=d,s.fromString=f,Dn=jw.Integer=s}).apply(typeof Uw<"u"?Uw:typeof self<"u"?self:typeof window<"u"?window:{});var Wl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},On={};var ip,f1,io,op,pa,Kl,sp,ap,cp;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,u,h){return a==Array.prototype||a==Object.prototype||(a[u]=h.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wl=="object"&&Wl];for(var u=0;u<a.length;++u){var h=a[u];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var n=t(this);function i(a,u){if(u)e:{var h=n;a=a.split(".");for(var m=0;m<a.length-1;m++){var S=a[m];if(!(S in h))break e;h=h[S]}a=a[a.length-1],m=h[a],u=u(m),u!=m&&u!=null&&e(h,a,{configurable:!0,writable:!0,value:u})}}function o(a,u){a instanceof String&&(a+="");var h=0,m=!1,S={next:function(){if(!m&&h<a.length){var D=h++;return{value:u(D,a[D]),done:!1}}return m=!0,{done:!0,value:void 0}}};return S[Symbol.iterator]=function(){return S},S}i("Array.prototype.values",function(a){return a||function(){return o(this,function(u,h){return h})}});var s=s||{},c=this||self;function l(a){var u=typeof a;return u=u!="object"?u:a?Array.isArray(a)?"array":u:"null",u=="array"||u=="object"&&typeof a.length=="number"}function d(a){var u=typeof a;return u=="object"&&a!=null||u=="function"}function f(a,u,h){return a.call.apply(a.bind,arguments)}function p(a,u,h){if(!a)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var S=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(S,m),a.apply(u,S)}}return function(){return a.apply(u,arguments)}}function g(a,u,h){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function b(a,u){var h=Array.prototype.slice.call(arguments,1);return function(){var m=h.slice();return m.push.apply(m,arguments),a.apply(this,m)}}function V(a,u){function h(){}h.prototype=u.prototype,a.aa=u.prototype,a.prototype=new h,a.prototype.constructor=a,a.Qb=function(m,S,D){for(var U=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)U[Ie-2]=arguments[Ie];return u.prototype[S].apply(m,U)}}function O(a){let u=a.length;if(0<u){let h=Array(u);for(let m=0;m<u;m++)h[m]=a[m];return h}return[]}function R(a,u){for(let h=1;h<arguments.length;h++){let m=arguments[h];if(l(m)){let S=a.length||0,D=m.length||0;a.length=S+D;for(let U=0;U<D;U++)a[S+U]=m[U]}else a.push(m)}}class K{constructor(u,h){this.i=u,this.j=h,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function Q(a){return/^[\s\xa0]*$/.test(a)}function L(){var a=c.navigator;return a&&(a=a.userAgent)?a:""}function J(a){return J[" "](a),a}J[" "]=function(){};var ne=L().indexOf("Gecko")!=-1&&!(L().toLowerCase().indexOf("webkit")!=-1&&L().indexOf("Edge")==-1)&&!(L().indexOf("Trident")!=-1||L().indexOf("MSIE")!=-1)&&L().indexOf("Edge")==-1;function re(a,u,h){for(let m in a)u.call(h,a[m],m,a)}function I(a,u){for(let h in a)u.call(void 0,a[h],h,a)}function y(a){let u={};for(let h in a)u[h]=a[h];return u}let C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(a,u){let h,m;for(let S=1;S<arguments.length;S++){m=arguments[S];for(h in m)a[h]=m[h];for(let D=0;D<C.length;D++)h=C[D],Object.prototype.hasOwnProperty.call(m,h)&&(a[h]=m[h])}}function A(a){var u=1;a=a.split(":");let h=[];for(;0<u&&a.length;)h.push(a.shift()),u--;return a.length&&h.push(a.join(":")),h}function P(a){c.setTimeout(()=>{throw a},0)}function w(){var a=Md;let u=null;return a.g&&(u=a.g,a.g=a.g.next,a.g||(a.h=null),u.next=null),u}class wn{constructor(){this.h=this.g=null}add(u,h){let m=es.get();m.set(u,h),this.h?this.h.next=m:this.g=m,this.h=m}}var es=new K(()=>new QI,a=>a.reset());class QI{constructor(){this.next=this.g=this.h=null}set(u,h){this.h=u,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let ts,ns=!1,Md=new wn,Ty=()=>{let a=c.Promise.resolve(void 0);ts=()=>{a.then(YI)}};var YI=()=>{for(var a;a=w();){try{a.h.call(a.g)}catch(h){P(h)}var u=es;u.j(a),100>u.h&&(u.h++,a.next=u.g,u.g=a)}ns=!1};function $n(){this.s=this.s,this.C=this.C}$n.prototype.s=!1,$n.prototype.ma=function(){this.s||(this.s=!0,this.N())},$n.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ot(a,u){this.type=a,this.g=this.target=u,this.defaultPrevented=!1}ot.prototype.h=function(){this.defaultPrevented=!0};var XI=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var a=!1,u=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let h=()=>{};c.addEventListener("test",h,u),c.removeEventListener("test",h,u)}catch{}return a}();function rs(a,u){if(ot.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var h=this.type=a.type,m=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=u,u=a.relatedTarget){if(ne){e:{try{J(u.nodeName);var S=!0;break e}catch{}S=!1}S||(u=null)}}else h=="mouseover"?u=a.fromElement:h=="mouseout"&&(u=a.toElement);this.relatedTarget=u,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:JI[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&rs.aa.h.call(this)}}V(rs,ot);var JI={2:"touch",3:"pen",4:"mouse"};rs.prototype.h=function(){rs.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var is="closure_listenable_"+(1e6*Math.random()|0),ZI=0;function eT(a,u,h,m,S){this.listener=a,this.proxy=null,this.src=u,this.type=h,this.capture=!!m,this.ha=S,this.key=++ZI,this.da=this.fa=!1}function ac(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function cc(a){this.src=a,this.g={},this.h=0}cc.prototype.add=function(a,u,h,m,S){var D=a.toString();a=this.g[D],a||(a=this.g[D]=[],this.h++);var U=Od(a,u,m,S);return-1<U?(u=a[U],h||(u.fa=!1)):(u=new eT(u,this.src,D,!!m,S),u.fa=h,a.push(u)),u};function Dd(a,u){var h=u.type;if(h in a.g){var m=a.g[h],S=Array.prototype.indexOf.call(m,u,void 0),D;(D=0<=S)&&Array.prototype.splice.call(m,S,1),D&&(ac(u),a.g[h].length==0&&(delete a.g[h],a.h--))}}function Od(a,u,h,m){for(var S=0;S<a.length;++S){var D=a[S];if(!D.da&&D.listener==u&&D.capture==!!h&&D.ha==m)return S}return-1}var kd="closure_lm_"+(1e6*Math.random()|0),Vd={};function Ay(a,u,h,m,S){if(m&&m.once)return Py(a,u,h,m,S);if(Array.isArray(u)){for(var D=0;D<u.length;D++)Ay(a,u[D],h,m,S);return null}return h=Ud(h),a&&a[is]?a.K(u,h,d(m)?!!m.capture:!!m,S):Sy(a,u,h,!1,m,S)}function Sy(a,u,h,m,S,D){if(!u)throw Error("Invalid event type");var U=d(S)?!!S.capture:!!S,Ie=Fd(a);if(Ie||(a[kd]=Ie=new cc(a)),h=Ie.add(u,h,m,U,D),h.proxy)return h;if(m=tT(),h.proxy=m,m.src=a,m.listener=h,a.addEventListener)XI||(S=U),S===void 0&&(S=!1),a.addEventListener(u.toString(),m,S);else if(a.attachEvent)a.attachEvent(Ry(u.toString()),m);else if(a.addListener&&a.removeListener)a.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return h}function tT(){function a(h){return u.call(a.src,a.listener,h)}let u=nT;return a}function Py(a,u,h,m,S){if(Array.isArray(u)){for(var D=0;D<u.length;D++)Py(a,u[D],h,m,S);return null}return h=Ud(h),a&&a[is]?a.L(u,h,d(m)?!!m.capture:!!m,S):Sy(a,u,h,!0,m,S)}function xy(a,u,h,m,S){if(Array.isArray(u))for(var D=0;D<u.length;D++)xy(a,u[D],h,m,S);else m=d(m)?!!m.capture:!!m,h=Ud(h),a&&a[is]?(a=a.i,u=String(u).toString(),u in a.g&&(D=a.g[u],h=Od(D,h,m,S),-1<h&&(ac(D[h]),Array.prototype.splice.call(D,h,1),D.length==0&&(delete a.g[u],a.h--)))):a&&(a=Fd(a))&&(u=a.g[u.toString()],a=-1,u&&(a=Od(u,h,m,S)),(h=-1<a?u[a]:null)&&Nd(h))}function Nd(a){if(typeof a!="number"&&a&&!a.da){var u=a.src;if(u&&u[is])Dd(u.i,a);else{var h=a.type,m=a.proxy;u.removeEventListener?u.removeEventListener(h,m,a.capture):u.detachEvent?u.detachEvent(Ry(h),m):u.addListener&&u.removeListener&&u.removeListener(m),(h=Fd(u))?(Dd(h,a),h.h==0&&(h.src=null,u[kd]=null)):ac(a)}}}function Ry(a){return a in Vd?Vd[a]:Vd[a]="on"+a}function nT(a,u){if(a.da)a=!0;else{u=new rs(u,this);var h=a.listener,m=a.ha||a.src;a.fa&&Nd(a),a=h.call(m,u)}return a}function Fd(a){return a=a[kd],a instanceof cc?a:null}var Ld="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ud(a){return typeof a=="function"?a:(a[Ld]||(a[Ld]=function(u){return a.handleEvent(u)}),a[Ld])}function st(){$n.call(this),this.i=new cc(this),this.M=this,this.F=null}V(st,$n),st.prototype[is]=!0,st.prototype.removeEventListener=function(a,u,h,m){xy(this,a,u,h,m)};function ft(a,u){var h,m=a.F;if(m)for(h=[];m;m=m.F)h.push(m);if(a=a.M,m=u.type||u,typeof u=="string")u=new ot(u,a);else if(u instanceof ot)u.target=u.target||a;else{var S=u;u=new ot(m,a),T(u,S)}if(S=!0,h)for(var D=h.length-1;0<=D;D--){var U=u.g=h[D];S=lc(U,m,!0,u)&&S}if(U=u.g=a,S=lc(U,m,!0,u)&&S,S=lc(U,m,!1,u)&&S,h)for(D=0;D<h.length;D++)U=u.g=h[D],S=lc(U,m,!1,u)&&S}st.prototype.N=function(){if(st.aa.N.call(this),this.i){var a=this.i,u;for(u in a.g){for(var h=a.g[u],m=0;m<h.length;m++)ac(h[m]);delete a.g[u],a.h--}}this.F=null},st.prototype.K=function(a,u,h,m){return this.i.add(String(a),u,!1,h,m)},st.prototype.L=function(a,u,h,m){return this.i.add(String(a),u,!0,h,m)};function lc(a,u,h,m){if(u=a.i.g[String(u)],!u)return!0;u=u.concat();for(var S=!0,D=0;D<u.length;++D){var U=u[D];if(U&&!U.da&&U.capture==h){var Ie=U.listener,tt=U.ha||U.src;U.fa&&Dd(a.i,U),S=Ie.call(tt,m)!==!1&&S}}return S&&!m.defaultPrevented}function My(a,u,h){if(typeof a=="function")h&&(a=g(a,h));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:c.setTimeout(a,u||0)}function Dy(a){a.g=My(()=>{a.g=null,a.i&&(a.i=!1,Dy(a))},a.l);let u=a.h;a.h=null,a.m.apply(null,u)}class rT extends $n{constructor(u,h){super(),this.m=u,this.l=h,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:Dy(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function os(a){$n.call(this),this.h=a,this.g={}}V(os,$n);var Oy=[];function ky(a){re(a.g,function(u,h){this.g.hasOwnProperty(h)&&Nd(u)},a),a.g={}}os.prototype.N=function(){os.aa.N.call(this),ky(this)},os.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var jd=c.JSON.stringify,iT=c.JSON.parse,oT=class{stringify(a){return c.JSON.stringify(a,void 0)}parse(a){return c.JSON.parse(a,void 0)}};function Bd(){}Bd.prototype.h=null;function Vy(a){return a.h||(a.h=a.i())}function Ny(){}var ss={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function qd(){ot.call(this,"d")}V(qd,ot);function zd(){ot.call(this,"c")}V(zd,ot);var Pr={},Fy=null;function uc(){return Fy=Fy||new st}Pr.La="serverreachability";function Ly(a){ot.call(this,Pr.La,a)}V(Ly,ot);function as(a){let u=uc();ft(u,new Ly(u))}Pr.STAT_EVENT="statevent";function Uy(a,u){ot.call(this,Pr.STAT_EVENT,a),this.stat=u}V(Uy,ot);function pt(a){let u=uc();ft(u,new Uy(u,a))}Pr.Ma="timingevent";function jy(a,u){ot.call(this,Pr.Ma,a),this.size=u}V(jy,ot);function cs(a,u){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){a()},u)}function ls(){this.g=!0}ls.prototype.xa=function(){this.g=!1};function sT(a,u,h,m,S,D){a.info(function(){if(a.g)if(D)for(var U="",Ie=D.split("&"),tt=0;tt<Ie.length;tt++){var pe=Ie[tt].split("=");if(1<pe.length){var at=pe[0];pe=pe[1];var ct=at.split("_");U=2<=ct.length&&ct[1]=="type"?U+(at+"="+pe+"&"):U+(at+"=redacted&")}}else U=null;else U=D;return"XMLHTTP REQ ("+m+") [attempt "+S+"]: "+u+`
`+h+`
`+U})}function aT(a,u,h,m,S,D,U){a.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+S+"]: "+u+`
`+h+`
`+D+" "+U})}function _i(a,u,h,m){a.info(function(){return"XMLHTTP TEXT ("+u+"): "+lT(a,h)+(m?" "+m:"")})}function cT(a,u){a.info(function(){return"TIMEOUT: "+u})}ls.prototype.info=function(){};function lT(a,u){if(!a.g)return u;if(!u)return null;try{var h=JSON.parse(u);if(h){for(a=0;a<h.length;a++)if(Array.isArray(h[a])){var m=h[a];if(!(2>m.length)){var S=m[1];if(Array.isArray(S)&&!(1>S.length)){var D=S[0];if(D!="noop"&&D!="stop"&&D!="close")for(var U=1;U<S.length;U++)S[U]=""}}}}return jd(h)}catch{return u}}var dc={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},By={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},$d;function hc(){}V(hc,Bd),hc.prototype.g=function(){return new XMLHttpRequest},hc.prototype.i=function(){return{}},$d=new hc;function Gn(a,u,h,m){this.j=a,this.i=u,this.l=h,this.R=m||1,this.U=new os(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new qy}function qy(){this.i=null,this.g="",this.h=!1}var zy={},Gd={};function Wd(a,u,h){a.L=1,a.v=gc(En(u)),a.m=h,a.P=!0,$y(a,null)}function $y(a,u){a.F=Date.now(),fc(a),a.A=En(a.v);var h=a.A,m=a.R;Array.isArray(m)||(m=[String(m)]),i_(h.i,"t",m),a.C=0,h=a.j.J,a.h=new qy,a.g=C_(a.j,h?u:null,!a.m),0<a.O&&(a.M=new rT(g(a.Y,a,a.g),a.O)),u=a.U,h=a.g,m=a.ca;var S="readystatechange";Array.isArray(S)||(S&&(Oy[0]=S.toString()),S=Oy);for(var D=0;D<S.length;D++){var U=Ay(h,S[D],m||u.handleEvent,!1,u.h||u);if(!U)break;u.g[U.key]=U}u=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,u)):(a.u="GET",a.g.ea(a.A,a.u,null,u)),as(),sT(a.i,a.u,a.A,a.l,a.R,a.m)}Gn.prototype.ca=function(a){a=a.target;let u=this.M;u&&Cn(a)==3?u.j():this.Y(a)},Gn.prototype.Y=function(a){try{if(a==this.g)e:{let ct=Cn(this.g);var u=this.g.Ba();let Ei=this.g.Z();if(!(3>ct)&&(ct!=3||this.g&&(this.h.h||this.g.oa()||d_(this.g)))){this.J||ct!=4||u==7||(u==8||0>=Ei?as(3):as(2)),Kd(this);var h=this.g.Z();this.X=h;t:if(Gy(this)){var m=d_(this.g);a="";var S=m.length,D=Cn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xr(this),us(this);var U="";break t}this.h.i=new c.TextDecoder}for(u=0;u<S;u++)this.h.h=!0,a+=this.h.i.decode(m[u],{stream:!(D&&u==S-1)});m.length=0,this.h.g+=a,this.C=0,U=this.h.g}else U=this.g.oa();if(this.o=h==200,aT(this.i,this.u,this.A,this.l,this.R,ct,h),this.o){if(this.T&&!this.K){t:{if(this.g){var Ie,tt=this.g;if((Ie=tt.g?tt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(Ie)){var pe=Ie;break t}}pe=null}if(h=pe)_i(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hd(this,h);else{this.o=!1,this.s=3,pt(12),xr(this),us(this);break e}}if(this.P){h=!0;let $t;for(;!this.J&&this.C<U.length;)if($t=uT(this,U),$t==Gd){ct==4&&(this.s=4,pt(14),h=!1),_i(this.i,this.l,null,"[Incomplete Response]");break}else if($t==zy){this.s=4,pt(15),_i(this.i,this.l,U,"[Invalid Chunk]"),h=!1;break}else _i(this.i,this.l,$t,null),Hd(this,$t);if(Gy(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ct!=4||U.length!=0||this.h.h||(this.s=1,pt(16),h=!1),this.o=this.o&&h,!h)_i(this.i,this.l,U,"[Invalid Chunked Response]"),xr(this),us(this);else if(0<U.length&&!this.W){this.W=!0;var at=this.j;at.g==this&&at.ba&&!at.M&&(at.j.info("Great, no buffering proxy detected. Bytes received: "+U.length),eh(at),at.M=!0,pt(11))}}else _i(this.i,this.l,U,null),Hd(this,U);ct==4&&xr(this),this.o&&!this.J&&(ct==4?__(this.j,this):(this.o=!1,fc(this)))}else ST(this.g),h==400&&0<U.indexOf("Unknown SID")?(this.s=3,pt(12)):(this.s=0,pt(13)),xr(this),us(this)}}}catch{}finally{}};function Gy(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function uT(a,u){var h=a.C,m=u.indexOf(`
`,h);return m==-1?Gd:(h=Number(u.substring(h,m)),isNaN(h)?zy:(m+=1,m+h>u.length?Gd:(u=u.slice(m,m+h),a.C=m+h,u)))}Gn.prototype.cancel=function(){this.J=!0,xr(this)};function fc(a){a.S=Date.now()+a.I,Wy(a,a.I)}function Wy(a,u){if(a.B!=null)throw Error("WatchDog timer not null");a.B=cs(g(a.ba,a),u)}function Kd(a){a.B&&(c.clearTimeout(a.B),a.B=null)}Gn.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(cT(this.i,this.A),this.L!=2&&(as(),pt(17)),xr(this),this.s=2,us(this)):Wy(this,this.S-a)};function us(a){a.j.G==0||a.J||__(a.j,a)}function xr(a){Kd(a);var u=a.M;u&&typeof u.ma=="function"&&u.ma(),a.M=null,ky(a.U),a.g&&(u=a.g,a.g=null,u.abort(),u.ma())}function Hd(a,u){try{var h=a.j;if(h.G!=0&&(h.g==a||Qd(h.h,a))){if(!a.K&&Qd(h.h,a)&&h.G==3){try{var m=h.Da.g.parse(u)}catch{m=null}if(Array.isArray(m)&&m.length==3){var S=m;if(S[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<a.F)Ec(h),vc(h);else break e;Zd(h),pt(18)}}else h.za=S[1],0<h.za-h.T&&37500>S[2]&&h.F&&h.v==0&&!h.C&&(h.C=cs(g(h.Za,h),6e3));if(1>=Qy(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else Mr(h,11)}else if((a.K||h.g==a)&&Ec(h),!Q(u))for(S=h.Da.g.parse(u),u=0;u<S.length;u++){let pe=S[u];if(h.T=pe[0],pe=pe[1],h.G==2)if(pe[0]=="c"){h.K=pe[1],h.ia=pe[2];let at=pe[3];at!=null&&(h.la=at,h.j.info("VER="+h.la));let ct=pe[4];ct!=null&&(h.Aa=ct,h.j.info("SVER="+h.Aa));let Ei=pe[5];Ei!=null&&typeof Ei=="number"&&0<Ei&&(m=1.5*Ei,h.L=m,h.j.info("backChannelRequestTimeoutMs_="+m)),m=h;let $t=a.g;if($t){let bc=$t.g?$t.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bc){var D=m.h;D.g||bc.indexOf("spdy")==-1&&bc.indexOf("quic")==-1&&bc.indexOf("h2")==-1||(D.j=D.l,D.g=new Set,D.h&&(Yd(D,D.h),D.h=null))}if(m.D){let th=$t.g?$t.g.getResponseHeader("X-HTTP-Session-Id"):null;th&&(m.ya=th,Se(m.I,m.D,th))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-a.F,h.j.info("Handshake RTT: "+h.R+"ms")),m=h;var U=a;if(m.qa=E_(m,m.J?m.ia:null,m.W),U.K){Yy(m.h,U);var Ie=U,tt=m.L;tt&&(Ie.I=tt),Ie.B&&(Kd(Ie),fc(Ie)),m.g=U}else g_(m);0<h.i.length&&wc(h)}else pe[0]!="stop"&&pe[0]!="close"||Mr(h,7);else h.G==3&&(pe[0]=="stop"||pe[0]=="close"?pe[0]=="stop"?Mr(h,7):Jd(h):pe[0]!="noop"&&h.l&&h.l.ta(pe),h.v=0)}}as(4)}catch{}}var dT=class{constructor(a,u){this.g=a,this.map=u}};function Ky(a){this.l=a||10,c.PerformanceNavigationTiming?(a=c.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Hy(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Qy(a){return a.h?1:a.g?a.g.size:0}function Qd(a,u){return a.h?a.h==u:a.g?a.g.has(u):!1}function Yd(a,u){a.g?a.g.add(u):a.h=u}function Yy(a,u){a.h&&a.h==u?a.h=null:a.g&&a.g.has(u)&&a.g.delete(u)}Ky.prototype.cancel=function(){if(this.i=Xy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function Xy(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let u=a.i;for(let h of a.g.values())u=u.concat(h.D);return u}return O(a.i)}function hT(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(l(a)){for(var u=[],h=a.length,m=0;m<h;m++)u.push(a[m]);return u}u=[],h=0;for(m in a)u[h++]=a[m];return u}function fT(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(l(a)||typeof a=="string"){var u=[];a=a.length;for(var h=0;h<a;h++)u.push(h);return u}u=[],h=0;for(let m in a)u[h++]=m;return u}}}function Jy(a,u){if(a.forEach&&typeof a.forEach=="function")a.forEach(u,void 0);else if(l(a)||typeof a=="string")Array.prototype.forEach.call(a,u,void 0);else for(var h=fT(a),m=hT(a),S=m.length,D=0;D<S;D++)u.call(void 0,m[D],h&&h[D],a)}var Zy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pT(a,u){if(a){a=a.split("&");for(var h=0;h<a.length;h++){var m=a[h].indexOf("="),S=null;if(0<=m){var D=a[h].substring(0,m);S=a[h].substring(m+1)}else D=a[h];u(D,S?decodeURIComponent(S.replace(/\+/g," ")):"")}}}function Rr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof Rr){this.h=a.h,pc(this,a.j),this.o=a.o,this.g=a.g,mc(this,a.s),this.l=a.l;var u=a.i,h=new fs;h.i=u.i,u.g&&(h.g=new Map(u.g),h.h=u.h),e_(this,h),this.m=a.m}else a&&(u=String(a).match(Zy))?(this.h=!1,pc(this,u[1]||"",!0),this.o=ds(u[2]||""),this.g=ds(u[3]||"",!0),mc(this,u[4]),this.l=ds(u[5]||"",!0),e_(this,u[6]||"",!0),this.m=ds(u[7]||"")):(this.h=!1,this.i=new fs(null,this.h))}Rr.prototype.toString=function(){var a=[],u=this.j;u&&a.push(hs(u,t_,!0),":");var h=this.g;return(h||u=="file")&&(a.push("//"),(u=this.o)&&a.push(hs(u,t_,!0),"@"),a.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&a.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&a.push("/"),a.push(hs(h,h.charAt(0)=="/"?yT:gT,!0))),(h=this.i.toString())&&a.push("?",h),(h=this.m)&&a.push("#",hs(h,vT)),a.join("")};function En(a){return new Rr(a)}function pc(a,u,h){a.j=h?ds(u,!0):u,a.j&&(a.j=a.j.replace(/:$/,""))}function mc(a,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);a.s=u}else a.s=null}function e_(a,u,h){u instanceof fs?(a.i=u,wT(a.i,a.h)):(h||(u=hs(u,_T)),a.i=new fs(u,a.h))}function Se(a,u,h){a.i.set(u,h)}function gc(a){return Se(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function ds(a,u){return a?u?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function hs(a,u,h){return typeof a=="string"?(a=encodeURI(a).replace(u,mT),h&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function mT(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var t_=/[#\/\?@]/g,gT=/[#\?:]/g,yT=/[#\?]/g,_T=/[#\?@]/g,vT=/#/g;function fs(a,u){this.h=this.g=null,this.i=a||null,this.j=!!u}function Wn(a){a.g||(a.g=new Map,a.h=0,a.i&&pT(a.i,function(u,h){a.add(decodeURIComponent(u.replace(/\+/g," ")),h)}))}r=fs.prototype,r.add=function(a,u){Wn(this),this.i=null,a=vi(this,a);var h=this.g.get(a);return h||this.g.set(a,h=[]),h.push(u),this.h+=1,this};function n_(a,u){Wn(a),u=vi(a,u),a.g.has(u)&&(a.i=null,a.h-=a.g.get(u).length,a.g.delete(u))}function r_(a,u){return Wn(a),u=vi(a,u),a.g.has(u)}r.forEach=function(a,u){Wn(this),this.g.forEach(function(h,m){h.forEach(function(S){a.call(u,S,m,this)},this)},this)},r.na=function(){Wn(this);let a=Array.from(this.g.values()),u=Array.from(this.g.keys()),h=[];for(let m=0;m<u.length;m++){let S=a[m];for(let D=0;D<S.length;D++)h.push(u[m])}return h},r.V=function(a){Wn(this);let u=[];if(typeof a=="string")r_(this,a)&&(u=u.concat(this.g.get(vi(this,a))));else{a=Array.from(this.g.values());for(let h=0;h<a.length;h++)u=u.concat(a[h])}return u},r.set=function(a,u){return Wn(this),this.i=null,a=vi(this,a),r_(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[u]),this.h+=1,this},r.get=function(a,u){return a?(a=this.V(a),0<a.length?String(a[0]):u):u};function i_(a,u,h){n_(a,u),0<h.length&&(a.i=null,a.g.set(vi(a,u),O(h)),a.h+=h.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],u=Array.from(this.g.keys());for(var h=0;h<u.length;h++){var m=u[h];let D=encodeURIComponent(String(m)),U=this.V(m);for(m=0;m<U.length;m++){var S=D;U[m]!==""&&(S+="="+encodeURIComponent(String(U[m]))),a.push(S)}}return this.i=a.join("&")};function vi(a,u){return u=String(u),a.j&&(u=u.toLowerCase()),u}function wT(a,u){u&&!a.j&&(Wn(a),a.i=null,a.g.forEach(function(h,m){var S=m.toLowerCase();m!=S&&(n_(this,m),i_(this,S,h))},a)),a.j=u}function ET(a,u){let h=new ls;if(c.Image){let m=new Image;m.onload=b(Kn,h,"TestLoadImage: loaded",!0,u,m),m.onerror=b(Kn,h,"TestLoadImage: error",!1,u,m),m.onabort=b(Kn,h,"TestLoadImage: abort",!1,u,m),m.ontimeout=b(Kn,h,"TestLoadImage: timeout",!1,u,m),c.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=a}else u(!1)}function CT(a,u){let h=new ls,m=new AbortController,S=setTimeout(()=>{m.abort(),Kn(h,"TestPingServer: timeout",!1,u)},1e4);fetch(a,{signal:m.signal}).then(D=>{clearTimeout(S),D.ok?Kn(h,"TestPingServer: ok",!0,u):Kn(h,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(S),Kn(h,"TestPingServer: error",!1,u)})}function Kn(a,u,h,m,S){try{S&&(S.onload=null,S.onerror=null,S.onabort=null,S.ontimeout=null),m(h)}catch{}}function bT(){this.g=new oT}function IT(a,u,h){let m=h||"";try{Jy(a,function(S,D){let U=S;d(S)&&(U=jd(S)),u.push(m+D+"="+encodeURIComponent(U))})}catch(S){throw u.push(m+"type="+encodeURIComponent("_badmap")),S}}function ps(a){this.l=a.Ub||null,this.j=a.eb||!1}V(ps,Bd),ps.prototype.g=function(){return new yc(this.l,this.j)},ps.prototype.i=function(a){return function(){return a}}({});function yc(a,u){st.call(this),this.D=a,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}V(yc,st),r=yc.prototype,r.open=function(a,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=u,this.readyState=1,gs(this)},r.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(u.body=a),(this.D||c).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ms(this)),this.readyState=0},r.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,gs(this)),this.g&&(this.readyState=3,gs(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;o_(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function o_(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}r.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var u=a.value?a.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!a.done}))&&(this.response=this.responseText+=u)}a.done?ms(this):gs(this),this.readyState==3&&o_(this)}},r.Ra=function(a){this.g&&(this.response=this.responseText=a,ms(this))},r.Qa=function(a){this.g&&(this.response=a,ms(this))},r.ga=function(){this.g&&ms(this)};function ms(a){a.readyState=4,a.l=null,a.j=null,a.v=null,gs(a)}r.setRequestHeader=function(a,u){this.u.append(a,u)},r.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],u=this.h.entries();for(var h=u.next();!h.done;)h=h.value,a.push(h[0]+": "+h[1]),h=u.next();return a.join(`\r
`)};function gs(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(yc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function s_(a){let u="";return re(a,function(h,m){u+=m,u+=":",u+=h,u+=`\r
`}),u}function Xd(a,u,h){e:{for(m in h){var m=!1;break e}m=!0}m||(h=s_(h),typeof a=="string"?h!=null&&encodeURIComponent(String(h)):Se(a,u,h))}function Ve(a){st.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}V(Ve,st);var TT=/^https?$/i,AT=["POST","PUT"];r=Ve.prototype,r.Ha=function(a){this.J=a},r.ea=function(a,u,h,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);u=u?u.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():$d.g(),this.v=this.o?Vy(this.o):Vy($d),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(u,String(a),!0),this.B=!1}catch(D){a_(this,D);return}if(a=h||"",h=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var S in m)h.set(S,m[S]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let D of m.keys())h.set(D,m.get(D));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(h.keys()).find(D=>D.toLowerCase()=="content-type"),S=c.FormData&&a instanceof c.FormData,!(0<=Array.prototype.indexOf.call(AT,u,void 0))||m||S||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[D,U]of h)this.g.setRequestHeader(D,U);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{u_(this),this.u=!0,this.g.send(a),this.u=!1}catch(D){a_(this,D)}};function a_(a,u){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=u,a.m=5,c_(a),_c(a)}function c_(a){a.A||(a.A=!0,ft(a,"complete"),ft(a,"error"))}r.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,ft(this,"complete"),ft(this,"abort"),_c(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_c(this,!0)),Ve.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?l_(this):this.bb())},r.bb=function(){l_(this)};function l_(a){if(a.h&&typeof s<"u"&&(!a.v[1]||Cn(a)!=4||a.Z()!=2)){if(a.u&&Cn(a)==4)My(a.Ea,0,a);else if(ft(a,"readystatechange"),Cn(a)==4){a.h=!1;try{let U=a.Z();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var h;if(!(h=u)){var m;if(m=U===0){var S=String(a.D).match(Zy)[1]||null;!S&&c.self&&c.self.location&&(S=c.self.location.protocol.slice(0,-1)),m=!TT.test(S?S.toLowerCase():"")}h=m}if(h)ft(a,"complete"),ft(a,"success");else{a.m=6;try{var D=2<Cn(a)?a.g.statusText:""}catch{D=""}a.l=D+" ["+a.Z()+"]",c_(a)}}finally{_c(a)}}}}function _c(a,u){if(a.g){u_(a);let h=a.g,m=a.v[0]?()=>{}:null;a.g=null,a.v=null,u||ft(a,"ready");try{h.onreadystatechange=m}catch{}}}function u_(a){a.I&&(c.clearTimeout(a.I),a.I=null)}r.isActive=function(){return!!this.g};function Cn(a){return a.g?a.g.readyState:0}r.Z=function(){try{return 2<Cn(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(a){if(this.g){var u=this.g.responseText;return a&&u.indexOf(a)==0&&(u=u.substring(a.length)),iT(u)}};function d_(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function ST(a){let u={};a=(a.g&&2<=Cn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<a.length;m++){if(Q(a[m]))continue;var h=A(a[m]);let S=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let D=u[S]||[];u[S]=D,D.push(h)}I(u,function(m){return m.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ys(a,u,h){return h&&h.internalChannelParams&&h.internalChannelParams[a]||u}function h_(a){this.Aa=0,this.i=[],this.j=new ls,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ys("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ys("baseRetryDelayMs",5e3,a),this.cb=ys("retryDelaySeedMs",1e4,a),this.Wa=ys("forwardChannelMaxRetries",2,a),this.wa=ys("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Ky(a&&a.concurrentRequestLimit),this.Da=new bT,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=h_.prototype,r.la=8,r.G=1,r.connect=function(a,u,h,m){pt(0),this.W=a,this.H=u||{},h&&m!==void 0&&(this.H.OSID=h,this.H.OAID=m),this.F=this.X,this.I=E_(this,null,this.W),wc(this)};function Jd(a){if(f_(a),a.G==3){var u=a.U++,h=En(a.I);if(Se(h,"SID",a.K),Se(h,"RID",u),Se(h,"TYPE","terminate"),_s(a,h),u=new Gn(a,a.j,u),u.L=2,u.v=gc(En(h)),h=!1,c.navigator&&c.navigator.sendBeacon)try{h=c.navigator.sendBeacon(u.v.toString(),"")}catch{}!h&&c.Image&&(new Image().src=u.v,h=!0),h||(u.g=C_(u.j,null),u.g.ea(u.v)),u.F=Date.now(),fc(u)}w_(a)}function vc(a){a.g&&(eh(a),a.g.cancel(),a.g=null)}function f_(a){vc(a),a.u&&(c.clearTimeout(a.u),a.u=null),Ec(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&c.clearTimeout(a.s),a.s=null)}function wc(a){if(!Hy(a.h)&&!a.s){a.s=!0;var u=a.Ga;ts||Ty(),ns||(ts(),ns=!0),Md.add(u,a),a.B=0}}function PT(a,u){return Qy(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=u.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=cs(g(a.Ga,a,u),v_(a,a.B)),a.B++,!0)}r.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let S=new Gn(this,this.j,a),D=this.o;if(this.S&&(D?(D=y(D),T(D,this.S)):D=this.S),this.m!==null||this.O||(S.H=D,D=null),this.P)e:{for(var u=0,h=0;h<this.i.length;h++){t:{var m=this.i[h];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(u+=m,4096<u){u=h;break e}if(u===4096||h===this.i.length-1){u=h+1;break e}}u=1e3}else u=1e3;u=m_(this,S,u),h=En(this.I),Se(h,"RID",a),Se(h,"CVER",22),this.D&&Se(h,"X-HTTP-Session-Id",this.D),_s(this,h),D&&(this.O?u="headers="+encodeURIComponent(String(s_(D)))+"&"+u:this.m&&Xd(h,this.m,D)),Yd(this.h,S),this.Ua&&Se(h,"TYPE","init"),this.P?(Se(h,"$req",u),Se(h,"SID","null"),S.T=!0,Wd(S,h,null)):Wd(S,h,u),this.G=2}}else this.G==3&&(a?p_(this,a):this.i.length==0||Hy(this.h)||p_(this))};function p_(a,u){var h;u?h=u.l:h=a.U++;let m=En(a.I);Se(m,"SID",a.K),Se(m,"RID",h),Se(m,"AID",a.T),_s(a,m),a.m&&a.o&&Xd(m,a.m,a.o),h=new Gn(a,a.j,h,a.B+1),a.m===null&&(h.H=a.o),u&&(a.i=u.D.concat(a.i)),u=m_(a,h,1e3),h.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Yd(a.h,h),Wd(h,m,u)}function _s(a,u){a.H&&re(a.H,function(h,m){Se(u,m,h)}),a.l&&Jy({},function(h,m){Se(u,m,h)})}function m_(a,u,h){h=Math.min(a.i.length,h);var m=a.l?g(a.l.Na,a.l,a):null;e:{var S=a.i;let D=-1;for(;;){let U=["count="+h];D==-1?0<h?(D=S[0].g,U.push("ofs="+D)):D=0:U.push("ofs="+D);let Ie=!0;for(let tt=0;tt<h;tt++){let pe=S[tt].g,at=S[tt].map;if(pe-=D,0>pe)D=Math.max(0,S[tt].g-100),Ie=!1;else try{IT(at,U,"req"+pe+"_")}catch{m&&m(at)}}if(Ie){m=U.join("&");break e}}}return a=a.i.splice(0,h),u.D=a,m}function g_(a){if(!a.g&&!a.u){a.Y=1;var u=a.Fa;ts||Ty(),ns||(ts(),ns=!0),Md.add(u,a),a.v=0}}function Zd(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=cs(g(a.Fa,a),v_(a,a.v)),a.v++,!0)}r.Fa=function(){if(this.u=null,y_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=cs(g(this.ab,this),a)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,pt(10),vc(this),y_(this))};function eh(a){a.A!=null&&(c.clearTimeout(a.A),a.A=null)}function y_(a){a.g=new Gn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var u=En(a.qa);Se(u,"RID","rpc"),Se(u,"SID",a.K),Se(u,"AID",a.T),Se(u,"CI",a.F?"0":"1"),!a.F&&a.ja&&Se(u,"TO",a.ja),Se(u,"TYPE","xmlhttp"),_s(a,u),a.m&&a.o&&Xd(u,a.m,a.o),a.L&&(a.g.I=a.L);var h=a.g;a=a.ia,h.L=1,h.v=gc(En(u)),h.m=null,h.P=!0,$y(h,a)}r.Za=function(){this.C!=null&&(this.C=null,vc(this),Zd(this),pt(19))};function Ec(a){a.C!=null&&(c.clearTimeout(a.C),a.C=null)}function __(a,u){var h=null;if(a.g==u){Ec(a),eh(a),a.g=null;var m=2}else if(Qd(a.h,u))h=u.D,Yy(a.h,u),m=1;else return;if(a.G!=0){if(u.o)if(m==1){h=u.m?u.m.length:0,u=Date.now()-u.F;var S=a.B;m=uc(),ft(m,new jy(m,h)),wc(a)}else g_(a);else if(S=u.s,S==3||S==0&&0<u.X||!(m==1&&PT(a,u)||m==2&&Zd(a)))switch(h&&0<h.length&&(u=a.h,u.i=u.i.concat(h)),S){case 1:Mr(a,5);break;case 4:Mr(a,10);break;case 3:Mr(a,6);break;default:Mr(a,2)}}}function v_(a,u){let h=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(h*=2),h*u}function Mr(a,u){if(a.j.info("Error code "+u),u==2){var h=g(a.fb,a),m=a.Xa;let S=!m;m=new Rr(m||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||pc(m,"https"),gc(m),S?ET(m.toString(),h):CT(m.toString(),h)}else pt(2);a.G=0,a.l&&a.l.sa(u),w_(a),f_(a)}r.fb=function(a){a?(this.j.info("Successfully pinged google.com"),pt(2)):(this.j.info("Failed to ping google.com"),pt(1))};function w_(a){if(a.G=0,a.ka=[],a.l){let u=Xy(a.h);(u.length!=0||a.i.length!=0)&&(R(a.ka,u),R(a.ka,a.i),a.h.i.length=0,O(a.i),a.i.length=0),a.l.ra()}}function E_(a,u,h){var m=h instanceof Rr?En(h):new Rr(h);if(m.g!="")u&&(m.g=u+"."+m.g),mc(m,m.s);else{var S=c.location;m=S.protocol,u=u?u+"."+S.hostname:S.hostname,S=+S.port;var D=new Rr(null);m&&pc(D,m),u&&(D.g=u),S&&mc(D,S),h&&(D.l=h),m=D}return h=a.D,u=a.ya,h&&u&&Se(m,h,u),Se(m,"VER",a.la),_s(a,m),m}function C_(a,u,h){if(u&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=a.Ca&&!a.pa?new Ve(new ps({eb:h})):new Ve(a.pa),u.Ha(a.J),u}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function b_(){}r=b_.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Cc(){}Cc.prototype.g=function(a,u){return new St(a,u)};function St(a,u){st.call(this),this.g=new h_(u),this.l=a,this.h=u&&u.messageUrlParams||null,a=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(a?a["X-WebChannel-Content-Type"]=u.messageContentType:a={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(a?a["X-WebChannel-Client-Profile"]=u.va:a={"X-WebChannel-Client-Profile":u.va}),this.g.S=a,(a=u&&u.Sb)&&!Q(a)&&(this.g.m=a),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!Q(u)&&(this.g.D=u,a=this.h,a!==null&&u in a&&(a=this.h,u in a&&delete a[u])),this.j=new wi(this)}V(St,st),St.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},St.prototype.close=function(){Jd(this.g)},St.prototype.o=function(a){var u=this.g;if(typeof a=="string"){var h={};h.__data__=a,a=h}else this.u&&(h={},h.__data__=jd(a),a=h);u.i.push(new dT(u.Ya++,a)),u.G==3&&wc(u)},St.prototype.N=function(){this.g.l=null,delete this.j,Jd(this.g),delete this.g,St.aa.N.call(this)};function I_(a){qd.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var u=a.__sm__;if(u){e:{for(let h in u){a=h;break e}a=void 0}(this.i=a)&&(a=this.i,u=u!==null&&a in u?u[a]:void 0),this.data=u}else this.data=a}V(I_,qd);function T_(){zd.call(this),this.status=1}V(T_,zd);function wi(a){this.g=a}V(wi,b_),wi.prototype.ua=function(){ft(this.g,"a")},wi.prototype.ta=function(a){ft(this.g,new I_(a))},wi.prototype.sa=function(a){ft(this.g,new T_)},wi.prototype.ra=function(){ft(this.g,"b")},Cc.prototype.createWebChannel=Cc.prototype.g,St.prototype.send=St.prototype.o,St.prototype.open=St.prototype.m,St.prototype.close=St.prototype.close,cp=On.createWebChannelTransport=function(){return new Cc},ap=On.getStatEventTarget=function(){return uc()},sp=On.Event=Pr,Kl=On.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},dc.NO_ERROR=0,dc.TIMEOUT=8,dc.HTTP_ERROR=6,pa=On.ErrorCode=dc,By.COMPLETE="complete",op=On.EventType=By,Ny.EventType=ss,ss.OPEN="a",ss.CLOSE="b",ss.ERROR="c",ss.MESSAGE="d",st.prototype.listen=st.prototype.K,io=On.WebChannel=Ny,f1=On.FetchXmlHttpFactory=ps,Ve.prototype.listenOnce=Ve.prototype.L,Ve.prototype.getLastError=Ve.prototype.Ka,Ve.prototype.getLastErrorCode=Ve.prototype.Ba,Ve.prototype.getStatus=Ve.prototype.Z,Ve.prototype.getResponseJson=Ve.prototype.Oa,Ve.prototype.getResponseText=Ve.prototype.oa,Ve.prototype.send=Ve.prototype.ea,Ve.prototype.setWithCredentials=Ve.prototype.Ha,ip=On.XhrIo=Ve}).apply(typeof Wl<"u"?Wl:typeof self<"u"?self:typeof window<"u"?window:{});var Bw="@firebase/firestore",qw="4.7.8";var He=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};He.UNAUTHENTICATED=new He(null),He.GOOGLE_CREDENTIALS=new He("google-credentials-uid"),He.FIRST_PARTY=new He("first-party-uid"),He.MOCK_USER=new He("mock-user");var $o="11.3.1";var hr=new jc("@firebase/firestore");function ho(){return hr.logLevel}function eC(r){hr.setLogLevel(r)}function F(r,...e){if(hr.logLevel<=an.DEBUG){let t=e.map(Eg);hr.debug(`Firestore (${$o}): ${r}`,...t)}}function Ue(r,...e){if(hr.logLevel<=an.ERROR){let t=e.map(Eg);hr.error(`Firestore (${$o}): ${r}`,...t)}}function Qt(r,...e){if(hr.logLevel<=an.WARN){let t=e.map(Eg);hr.warn(`Firestore (${$o}): ${r}`,...t)}}function Eg(r){if(typeof r=="string")return r;try{return function(t){return JSON.stringify(t)}(r)}catch{return r}}function W(r="Unexpected state"){let e=`FIRESTORE (${$o}) INTERNAL ASSERTION FAILED: `+r;throw Ue(e),new Error(e)}function H(r,e){r||W()}function tC(r,e){r||W()}function j(r,e){return r}var M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},N=class extends _v{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Ye=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var su=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},gp=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(He.UNAUTHENTICATED))}shutdown(){}},yp=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},_p=class{constructor(e){this.t=e,this.currentUser=He.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){H(this.o===void 0);let n=this.i,i=l=>this.i!==n?(n=this.i,t(l)):Promise.resolve(),o=new Ye;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ye,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let l=o;e.enqueueRetryable(()=>k(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},c=l=>{F("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?c(l):(F("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ye)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(F("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(H(typeof n.accessToken=="string"),new su(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return H(e===null||typeof e=="string"),new He(e)}},vp=class{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=He.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);let e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}},wp=class{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new vp(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(He.FIRST_PARTY))}shutdown(){}invalidateToken(){}},au=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Ep=class{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,wv(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){H(this.o===void 0);let n=o=>{o.error!=null&&F("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,F("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};let i=o=>{F("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):F("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new au(this.V));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(H(typeof t.token=="string"),this.R=t.token,new au(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function p1(r){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}var cu=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),n="";for(;n.length<20;){let i=p1(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<t&&(n+=e.charAt(i[o]%62))}return n}};function ie(r,e){return r<e?-1:r>e?1:0}function Eo(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}function nC(r){return r+"\0"}var zw=-62135596800,$w=1e6,Oe=class r{static now(){return r.fromMillis(Date.now())}static fromDate(e){return r.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*$w);return new r(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new N(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new N(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<zw)throw new N(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new N(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/$w}_compareTo(e){return this.seconds===e.seconds?ie(this.nanoseconds,e.nanoseconds):ie(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-zw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var Y=class r{static fromTimestamp(e){return new r(e)}static min(){return new r(new Oe(0,0))}static max(){return new r(new Oe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Gw="__name__",lu=class r{constructor(e,t,n){t===void 0?t=0:t>e.length&&W(),n===void 0?n=e.length-t:n>e.length-t&&W(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return r.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof r?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let n=Math.min(e.length,t.length);for(let i=0;i<n;i++){let o=r.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Math.sign(e.length-t.length)}static compareSegments(e,t){let n=r.isNumericId(e),i=r.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?r.extractNumericId(e).compare(r.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Dn.fromString(e.substring(4,e.length-2))}},de=class r extends lu{construct(e,t,n){return new r(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let n of e){if(n.indexOf("//")>=0)throw new N(M.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new r(t)}static emptyPath(){return new r([])}},m1=/^[_a-zA-Z][_a-zA-Z0-9]*$/,je=class r extends lu{construct(e,t,n){return new r(e,t,n)}static isValidIdentifier(e){return m1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),r.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Gw}static keyField(){return new r([Gw])}static fromServerFormat(e){let t=[],n="",i=0,o=()=>{if(n.length===0)throw new N(M.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""},s=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new N(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new N(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else c==="`"?(s=!s,i++):c!=="."||s?(n+=c,i++):(o(),i++)}if(o(),s)throw new N(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new r(t)}static emptyPath(){return new r([])}};var B=class r{constructor(e){this.path=e}static fromPath(e){return new r(de.fromString(e))}static fromName(e){return new r(de.fromString(e).popFirst(5))}static empty(){return new r(de.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&de.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return de.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new r(new de(e.slice()))}};var Co=-1,bo=class{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}};function Cp(r){return r.fields.find(e=>e.kind===2)}function Gr(r){return r.fields.filter(e=>e.kind!==2)}bo.UNKNOWN_ID=-1;var _o=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Sa=class r{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new r(0,qt.min())}};function rC(r,e){let t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=Y.fromTimestamp(n===1e9?new Oe(t+1,0):new Oe(t,n));return new qt(i,B.empty(),e)}function iC(r){return new qt(r.readTime,r.key,Co)}var qt=class r{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new r(Y.min(),B.empty(),Co)}static max(){return new r(Y.max(),B.empty(),Co)}};function Cg(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(r.documentKey,e.documentKey),t!==0?t:ie(r.largestBatchId,e.largestBatchId))}var oC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",uu=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function br(r){return k(this,null,function*(){if(r.code!==M.FAILED_PRECONDITION||r.message!==oC)throw r;F("LocalStore","Unexpectedly lost primary lease")})}var x=class r{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new r((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof r?t:r.resolve(t)}catch(t){return r.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):r.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):r.reject(t)}static resolve(e){return new r((t,n)=>{t(e)})}static reject(e){return new r((t,n)=>{n(e)})}static waitFor(e){return new r((t,n)=>{let i=0,o=0,s=!1;e.forEach(c=>{++i,c.next(()=>{++o,s&&o===i&&t()},l=>n(l))}),s=!0,o===i&&t()})}static or(e){let t=r.resolve(!1);for(let n of e)t=t.next(i=>i?r.resolve(i):n());return t}static forEach(e,t){let n=[];return e.forEach((i,o)=>{n.push(t.call(this,i,o))}),this.waitFor(n)}static mapArray(e,t){return new r((n,i)=>{let o=e.length,s=new Array(o),c=0;for(let l=0;l<o;l++){let d=l;t(e[d]).next(f=>{s[d]=f,++c,c===o&&n(s)},f=>i(f))}})}static doWhile(e,t){return new r((n,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):n()};o()})}};var kt="SimpleDb",du=class r{static open(e,t,n,i){try{return new r(t,e.transaction(i,n))}catch(o){throw new Zr(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.m=new Ye,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{t.error?this.m.reject(new Zr(e,t.error)):this.m.resolve()},this.transaction.onerror=n=>{let i=bg(n.target.error);this.m.reject(new Zr(e,i))}}get p(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(F(kt,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}S(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new Ip(t)}},fr=class r{static delete(e){return F(kt,"Removing database:",e),Kr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Uc())return!1;if(r.v())return!0;let e=Rs(),t=r.C(e),n=0<t&&t<10,i=sC(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,t){return e.store(t)}static C(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.O=n,r.C(Rs())===12.2&&Ue("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}N(e){return k(this,null,function*(){return this.db||(F(kt,"Opening database:",this.name),this.db=yield new Promise((t,n)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{n(new Zr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?n(new N(M.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?n(new N(M.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):n(new Zr(e,s))},i.onupgradeneeded=o=>{F(kt,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;this.O.B(s,i.transaction,o.oldVersion,this.version).next(()=>{F(kt,"Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=t=>this.L(t)),this.db})}k(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,n,i){return k(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.N(e);let c=du.open(this.db,e,o?"readonly":"readwrite",n),l=i(c).next(d=>(c.S(),d)).catch(d=>(c.abort(d),x.reject(d))).toPromise();return l.catch(()=>{}),yield c.p,l}catch(c){let l=c,d=l.name!=="FirebaseError"&&s<3;if(F(kt,"Transaction failed with error:",l.message,"Retrying:",d),this.close(),!d)return Promise.reject(l)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function sC(r){let e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var bp=class{constructor(e){this.q=e,this.$=!1,this.K=null}get isDone(){return this.$}get U(){return this.K}set cursor(e){this.q=e}done(){this.$=!0}W(e){this.K=e}delete(){return Kr(this.q.delete())}},Zr=class extends N{constructor(e,t){super(M.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Ir(r){return r.name==="IndexedDbTransactionError"}var Ip=class{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(F(kt,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(F(kt,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Kr(n)}add(e){return F(kt,"ADD",this.store.name,e,e),Kr(this.store.add(e))}get(e){return Kr(this.store.get(e)).next(t=>(t===void 0&&(t=null),F(kt,"GET",this.store.name,e,t),t))}delete(e){return F(kt,"DELETE",this.store.name,e),Kr(this.store.delete(e))}count(){return F(kt,"COUNT",this.store.name),Kr(this.store.count())}G(e,t){let n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(n.range);return new x((s,c)=>{o.onerror=l=>{c(l.target.error)},o.onsuccess=l=>{s(l.target.result)}})}{let o=this.cursor(n),s=[];return this.j(o,(c,l)=>{s.push(l)}).next(()=>s)}}H(e,t){let n=this.store.getAll(e,t===null?void 0:t);return new x((i,o)=>{n.onerror=s=>{o(s.target.error)},n.onsuccess=s=>{i(s.target.result)}})}J(e,t){F(kt,"DELETE ALL",this.store.name);let n=this.options(e,t);n.Y=!1;let i=this.cursor(n);return this.j(i,(o,s,c)=>c.delete())}Z(e,t){let n;t?n=e:(n={},t=e);let i=this.cursor(n);return this.j(i,t)}X(e){let t=this.cursor({});return new x((n,i)=>{t.onerror=o=>{let s=bg(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(c=>{c?s.continue():n()}):n()}})}j(e,t){let n=[];return new x((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let c=s.target.result;if(!c)return void i();let l=new bp(c),d=t(c.primaryKey,c.value,l);if(d instanceof x){let f=d.catch(p=>(l.done(),x.reject(p)));n.push(f)}l.isDone?i():l.U===null?c.continue():c.continue(l.U)}}).next(()=>x.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Kr(r){return new x((e,t)=>{r.onsuccess=n=>{let i=n.target.result;e(i)},r.onerror=n=>{let i=bg(n.target.error);t(i)}})}var Ww=!1;function bg(r){let e=fr.C(Rs());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){let n=new N("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Ww||(Ww=!0,setTimeout(()=>{throw n},0)),n}}return r}var Ea="IndexBackfiller",Tp=class{constructor(e,t){this.asyncQueue=e,this.ee=t,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}te(e){F(Ea,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>k(this,null,function*(){this.task=null;try{let t=yield this.ee.ne();F(Ea,`Documents written: ${t}`)}catch(t){Ir(t)?F(Ea,"Ignoring IndexedDB error during index backfill: ",t):yield br(t)}yield this.te(6e4)}))}},Ap=class{constructor(e,t){this.localStore=e,this.persistence=t}ne(e=50){return k(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.re(t,e))})}re(e,t){let n=new Set,i=t,o=!0;return x.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!n.has(s))return F(Ea,`Processing collection: ${s}`),this.ie(e,s,i).next(c=>{i-=c,n.add(s)});o=!1})).next(()=>t-i)}ie(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.se(i,o)).next(c=>(F(Ea,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c))).next(()=>s.size)}))}se(e,t){let n=e;return t.changes.forEach((i,o)=>{let s=iC(o);Cg(s,n)>0&&(n=s)}),new qt(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Vt=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.oe(i),this._e=i=>n.writeSequenceNumber(i))}oe(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this._e&&this._e(t),t}}r.ae=-1;return r})(),ur=-1;function Ja(r){return r==null}function Pa(r){return r===0&&1/r==-1/0}function aC(r){return typeof r=="number"&&Number.isInteger(r)&&!Pa(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}var hu="";function ht(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=Kw(e)),e=g1(r.get(t),e);return Kw(e)}function g1(r,e){let t=e,n=r.length;for(let i=0;i<n;i++){let o=r.charAt(i);switch(o){case"\0":t+="";break;case hu:t+="";break;default:t+=o}}return t}function Kw(r){return r+hu+""}function dn(r){let e=r.length;if(H(e>=2),e===2)return H(r.charAt(0)===hu&&r.charAt(1)===""),de.emptyPath();let t=e-2,n=[],i="";for(let o=0;o<e;){let s=r.indexOf(hu,o);switch((s<0||s>t)&&W(),r.charAt(s+1)){case"":let c=r.substring(o,s),l;i.length===0?l=c:(i+=c,l=i,i=""),n.push(l);break;case"":i+=r.substring(o,s),i+="\0";break;case"":i+=r.substring(o,s+1);break;default:W()}o=s+2}return new de(n)}var Wr="remoteDocuments",Za="owner",oo="owner",xa="mutationQueues",y1="userId",Ht="mutations",Hw="batchId",Xr="userMutationsIndex",Qw=["userId","batchId"];function Zl(r,e){return[r,ht(e)]}function cC(r,e,t){return[r,ht(e),t]}var _1={},Io="documentMutations",fu="remoteDocumentsV14",v1=["prefixPath","collectionGroup","readTime","documentId"],eu="documentKeyIndex",w1=["prefixPath","collectionGroup","documentId"],lC="collectionGroupIndex",E1=["collectionGroup","readTime","prefixPath","documentId"],Ra="remoteDocumentGlobal",Sp="remoteDocumentGlobalKey",To="targets",uC="queryTargetsIndex",C1=["canonicalId","targetId"],Ao="targetDocuments",b1=["targetId","path"],Ig="documentTargetsIndex",I1=["path","targetId"],pu="targetGlobalKey",ei="targetGlobal",Ma="collectionParents",T1=["collectionId","parent"],So="clientMetadata",A1="clientId",ud="bundles",S1="bundleId",dd="namedQueries",P1="name",Tg="indexConfiguration",x1="indexId",Pp="collectionGroupIndex",R1="collectionGroup",mu="indexState",M1=["indexId","uid"],dC="sequenceNumberIndex",D1=["uid","sequenceNumber"],gu="indexEntries",O1=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],hC="documentKeyIndex",k1=["indexId","uid","orderedDocumentKey"],hd="documentOverlays",V1=["userId","collectionPath","documentId"],xp="collectionPathOverlayIndex",N1=["userId","collectionPath","largestBatchId"],fC="collectionGroupOverlayIndex",F1=["userId","collectionGroup","largestBatchId"],Ag="globals",L1="name",pC=[xa,Ht,Io,Wr,To,Za,ei,Ao,So,Ra,Ma,ud,dd],U1=[...pC,hd],mC=[xa,Ht,Io,fu,To,Za,ei,Ao,So,Ra,Ma,ud,dd,hd],gC=mC,Sg=[...gC,Tg,mu,gu],j1=Sg,B1=[...Sg,Ag];var Da=class extends uu{constructor(e,t){super(),this.ue=e,this.currentSequenceNumber=t}};function Xe(r,e){let t=j(r);return fr.M(t.ue,e)}function Yw(r){let e=0;for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Tr(r,e){for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function yC(r){for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}var xe=class r{constructor(e,t){this.comparator=e,this.root=t||fn.EMPTY}insert(e,t){return new r(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,fn.BLACK,null,null))}remove(e){return new r(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){let e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yo(this.root,e,this.comparator,!1)}getReverseIterator(){return new yo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yo(this.root,e,this.comparator,!0)}},yo=class{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},fn=class r{constructor(e,t,n,i,o){this.key=e,this.value=t,this.color=n??r.RED,this.left=i??r.EMPTY,this.right=o??r.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,o){return new r(e??this.key,t??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this,o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,n),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return r.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return r.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,r.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();let e=this.left.check();if(e!==this.right.check())throw W();return e+(this.isRed()?0:1)}};fn.EMPTY=null,fn.RED=!0,fn.BLACK=!1;fn.EMPTY=new class{constructor(){this.size=0}get key(){throw W()}get value(){throw W()}get color(){throw W()}get left(){throw W()}get right(){throw W()}copy(e,t,n,i,o){return this}insert(e,t,n){return new fn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var be=class r{constructor(e){this.comparator=e,this.data=new xe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new yu(this.data.getIterator())}getIteratorFrom(e){return new yu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof r)||this.size!==e.size)return!1;let t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new r(this.comparator);return t.data=e,t}},yu=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function so(r){return r.hasNext()?r.getNext():void 0}var Nt=class r{constructor(e){this.fields=e,e.sort(je.comparator)}static empty(){return new r([])}unionWith(e){let t=new be(je.comparator);for(let n of this.fields)t=t.add(n);for(let n of e)t=t.add(n);return new r(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Eo(this.fields,e.fields,(t,n)=>t.isEqual(n))}};var _u=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function _C(){return typeof atob<"u"}var qe=class r{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new _u("Invalid base64 string: "+o):o}}(e);return new r(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new r(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ie(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};qe.EMPTY_BYTE_STRING=new qe("");var q1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Nn(r){if(H(!!r),typeof r=="string"){let e=0,t=q1.exec(r);if(H(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Me(r.seconds),nanos:Me(r.nanos)}}function Me(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Fn(r){return typeof r=="string"?qe.fromBase64String(r):qe.fromUint8Array(r)}var vC="server_timestamp",wC="__type__",EC="__previous_value__",CC="__local_write_time__";function fd(r){var e,t;return((t=(((e=r?.mapValue)===null||e===void 0?void 0:e.fields)||{})[wC])===null||t===void 0?void 0:t.stringValue)===vC}function pd(r){let e=r.mapValue.fields[EC];return fd(e)?pd(e):e}function Oa(r){let e=Nn(r.mapValue.fields[CC].timestampValue);return new Oe(e.seconds,e.nanos)}var Rp=class{constructor(e,t,n,i,o,s,c,l,d){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=d}},Mp="(default)",pr=class r{constructor(e,t){this.projectId=e,this.database=t||Mp}static empty(){return new r("","")}get isDefaultDatabase(){return this.database===Mp}isEqual(e){return e instanceof r&&e.projectId===this.projectId&&e.database===this.database}};var Pg="__type__",bC="__max__",cr={mapValue:{fields:{__type__:{stringValue:bC}}}},xg="__vector__",Po="value",tu={nullValue:"NULL_VALUE"};function mr(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?fd(r)?4:IC(r)?9007199254740991:md(r)?10:11:W()}function gn(r,e){if(r===e)return!0;let t=mr(r);if(t!==mr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Oa(r).isEqual(Oa(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=Nn(i.timestampValue),c=Nn(o.timestampValue);return s.seconds===c.seconds&&s.nanos===c.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,o){return Fn(i.bytesValue).isEqual(Fn(o.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,o){return Me(i.geoPointValue.latitude)===Me(o.geoPointValue.latitude)&&Me(i.geoPointValue.longitude)===Me(o.geoPointValue.longitude)}(r,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Me(i.integerValue)===Me(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=Me(i.doubleValue),c=Me(o.doubleValue);return s===c?Pa(s)===Pa(c):isNaN(s)&&isNaN(c)}return!1}(r,e);case 9:return Eo(r.arrayValue.values||[],e.arrayValue.values||[],gn);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},c=o.mapValue.fields||{};if(Yw(s)!==Yw(c))return!1;for(let l in s)if(s.hasOwnProperty(l)&&(c[l]===void 0||!gn(s[l],c[l])))return!1;return!0}(r,e);default:return W()}}function ka(r,e){return(r.values||[]).find(t=>gn(t,e))!==void 0}function gr(r,e){if(r===e)return 0;let t=mr(r),n=mr(e);if(t!==n)return ie(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return ie(r.booleanValue,e.booleanValue);case 2:return function(o,s){let c=Me(o.integerValue||o.doubleValue),l=Me(s.integerValue||s.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1}(r,e);case 3:return Xw(r.timestampValue,e.timestampValue);case 4:return Xw(Oa(r),Oa(e));case 5:return ie(r.stringValue,e.stringValue);case 6:return function(o,s){let c=Fn(o),l=Fn(s);return c.compareTo(l)}(r.bytesValue,e.bytesValue);case 7:return function(o,s){let c=o.split("/"),l=s.split("/");for(let d=0;d<c.length&&d<l.length;d++){let f=ie(c[d],l[d]);if(f!==0)return f}return ie(c.length,l.length)}(r.referenceValue,e.referenceValue);case 8:return function(o,s){let c=ie(Me(o.latitude),Me(s.latitude));return c!==0?c:ie(Me(o.longitude),Me(s.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return Jw(r.arrayValue,e.arrayValue);case 10:return function(o,s){var c,l,d,f;let p=o.fields||{},g=s.fields||{},b=(c=p[Po])===null||c===void 0?void 0:c.arrayValue,V=(l=g[Po])===null||l===void 0?void 0:l.arrayValue,O=ie(((d=b?.values)===null||d===void 0?void 0:d.length)||0,((f=V?.values)===null||f===void 0?void 0:f.length)||0);return O!==0?O:Jw(b,V)}(r.mapValue,e.mapValue);case 11:return function(o,s){if(o===cr.mapValue&&s===cr.mapValue)return 0;if(o===cr.mapValue)return 1;if(s===cr.mapValue)return-1;let c=o.fields||{},l=Object.keys(c),d=s.fields||{},f=Object.keys(d);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){let g=ie(l[p],f[p]);if(g!==0)return g;let b=gr(c[l[p]],d[f[p]]);if(b!==0)return b}return ie(l.length,f.length)}(r.mapValue,e.mapValue);default:throw W()}}function Xw(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return ie(r,e);let t=Nn(r),n=Nn(e),i=ie(t.seconds,n.seconds);return i!==0?i:ie(t.nanos,n.nanos)}function Jw(r,e){let t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){let o=gr(t[i],n[i]);if(o)return o}return ie(t.length,n.length)}function xo(r){return Dp(r)}function Dp(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){let n=Nn(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Fn(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return B.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(let o of t.values||[])i?i=!1:n+=",",n+=Dp(o);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){let n=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of n)o?o=!1:i+=",",i+=`${s}:${Dp(t.fields[s])}`;return i+"}"}(r.mapValue):W()}function nu(r){switch(mr(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=pd(r);return e?16+nu(e):16;case 5:return 2*r.stringValue.length;case 6:return Fn(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+nu(o),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return Tr(n.fields,(o,s)=>{i+=o.length+nu(s)}),i}(r.mapValue);default:throw W()}}function ti(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function Op(r){return!!r&&"integerValue"in r}function Va(r){return!!r&&"arrayValue"in r}function Zw(r){return!!r&&"nullValue"in r}function eE(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function ru(r){return!!r&&"mapValue"in r}function md(r){var e,t;return((t=(((e=r?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Pg])===null||t===void 0?void 0:t.stringValue)===xg}function Ca(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){let e={mapValue:{fields:{}}};return Tr(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Ca(n)),e}if(r.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ca(r.arrayValue.values[t]);return e}return Object.assign({},r)}function IC(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===bC}var TC={mapValue:{fields:{[Pg]:{stringValue:xg},[Po]:{arrayValue:{}}}}};function z1(r){return"nullValue"in r?tu:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?ti(pr.empty(),B.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?md(r)?TC:{mapValue:{}}:W()}function $1(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?ti(pr.empty(),B.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?TC:"mapValue"in r?md(r)?{mapValue:{}}:cr:W()}function tE(r,e){let t=gr(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function nE(r,e){let t=gr(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}var dt=class r{constructor(e){this.value=e}static empty(){return new r({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!ru(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ca(t)}setAll(e){let t=je.emptyPath(),n={},i=[];e.forEach((s,c)=>{if(!t.isImmediateParentOf(c)){let l=this.getFieldsMap(t);this.applyChanges(l,n,i),n={},i=[],t=c.popLast()}s?n[c.lastSegment()]=Ca(s):i.push(c.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,n,i)}delete(e){let t=this.field(e.popLast());ru(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];ru(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Tr(t,(i,o)=>e[i]=o);for(let i of n)delete e[i]}clone(){return new r(Ca(this.value))}};function AC(r){let e=[];return Tr(r.fields,(t,n)=>{let i=new je([t]);if(ru(n)){let o=AC(n.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new Nt(e)}var Qe=class r{constructor(e,t,n,i,o,s,c){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=o,this.data=s,this.documentState=c}static newInvalidDocument(e){return new r(e,0,Y.min(),Y.min(),Y.min(),dt.empty(),0)}static newFoundDocument(e,t,n,i){return new r(e,1,t,Y.min(),n,i,0)}static newNoDocument(e,t){return new r(e,2,t,Y.min(),Y.min(),dt.empty(),0)}static newUnknownDocument(e,t){return new r(e,3,t,Y.min(),Y.min(),dt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Y.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Y.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof r&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new r(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var yn=class{constructor(e,t){this.position=e,this.inclusive=t}};function rE(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){let o=e[i],s=r.position[i];if(o.field.isKeyField()?n=B.comparator(B.fromName(s.referenceValue),t.key):n=gr(s,t.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function iE(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!gn(r.position[t],e.position[t]))return!1;return!0}var ni=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function G1(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}var vu=class{},le=class r extends vu{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new Np(e,t,n):t==="array-contains"?new Up(e,n):t==="in"?new wu(e,n):t==="not-in"?new jp(e,n):t==="array-contains-any"?new Bp(e,n):new r(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Fp(e,n):new Lp(e,n)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(gr(t,this.value)):t!==null&&mr(this.value)===mr(t)&&this.matchesComparison(gr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return W()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},we=class r extends vu{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new r(e,t)}matches(e){return Ro(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}};function Ro(r){return r.op==="and"}function kp(r){return r.op==="or"}function Rg(r){return SC(r)&&Ro(r)}function SC(r){for(let e of r.filters)if(e instanceof we)return!1;return!0}function Vp(r){if(r instanceof le)return r.field.canonicalString()+r.op.toString()+xo(r.value);if(Rg(r))return r.filters.map(e=>Vp(e)).join(",");{let e=r.filters.map(t=>Vp(t)).join(",");return`${r.op}(${e})`}}function PC(r,e){return r instanceof le?function(n,i){return i instanceof le&&n.op===i.op&&n.field.isEqual(i.field)&&gn(n.value,i.value)}(r,e):r instanceof we?function(n,i){return i instanceof we&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,s,c)=>o&&PC(s,i.filters[c]),!0):!1}(r,e):void W()}function xC(r,e){let t=r.filters.concat(e);return we.create(t,r.op)}function RC(r){return r instanceof le?function(t){return`${t.field.canonicalString()} ${t.op} ${xo(t.value)}`}(r):r instanceof we?function(t){return t.op.toString()+" {"+t.getFilters().map(RC).join(" ,")+"}"}(r):"Filter"}var Np=class extends le{constructor(e,t,n){super(e,t,n),this.key=B.fromName(n.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},Fp=class extends le{constructor(e,t){super(e,"in",t),this.keys=MC("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Lp=class extends le{constructor(e,t){super(e,"not-in",t),this.keys=MC("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function MC(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>B.fromName(n.referenceValue))}var Up=class extends le{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Va(t)&&ka(t.arrayValue,this.value)}},wu=class extends le{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&ka(this.value.arrayValue,t)}},jp=class extends le{constructor(e,t){super(e,"not-in",t)}matches(e){if(ka(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!ka(this.value.arrayValue,t)}},Bp=class extends le{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Va(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>ka(this.value.arrayValue,n))}};var qp=class{constructor(e,t=null,n=[],i=[],o=null,s=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=s,this.endAt=c,this.le=null}};function zp(r,e=null,t=[],n=[],i=null,o=null,s=null){return new qp(r,e,t,n,i,o,s)}function ri(r){let e=j(r);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>Vp(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),Ja(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>xo(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>xo(n)).join(",")),e.le=t}return e.le}function ec(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!G1(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!PC(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!iE(r.startAt,e.startAt)&&iE(r.endAt,e.endAt)}function Eu(r){return B.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function Cu(r,e){return r.filters.filter(t=>t instanceof le&&t.field.isEqual(e))}function oE(r,e,t){let n=tu,i=!0;for(let o of Cu(r,e)){let s=tu,c=!0;switch(o.op){case"<":case"<=":s=z1(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,c=!1;break;case"!=":case"not-in":s=tu}tE({value:n,inclusive:i},{value:s,inclusive:c})<0&&(n=s,i=c)}if(t!==null){for(let o=0;o<r.orderBy.length;++o)if(r.orderBy[o].field.isEqual(e)){let s=t.position[o];tE({value:n,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(n=s,i=t.inclusive);break}}return{value:n,inclusive:i}}function sE(r,e,t){let n=cr,i=!0;for(let o of Cu(r,e)){let s=cr,c=!0;switch(o.op){case">=":case">":s=$1(o.value),c=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,c=!1;break;case"!=":case"not-in":s=cr}nE({value:n,inclusive:i},{value:s,inclusive:c})>0&&(n=s,i=c)}if(t!==null){for(let o=0;o<r.orderBy.length;++o)if(r.orderBy[o].field.isEqual(e)){let s=t.position[o];nE({value:n,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(n=s,i=t.inclusive);break}}return{value:n,inclusive:i}}var Yt=class{constructor(e,t=null,n=[],i=[],o=null,s="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=s,this.startAt=c,this.endAt=l,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}};function DC(r,e,t,n,i,o,s,c){return new Yt(r,e,t,n,i,o,s,c)}function Go(r){return new Yt(r)}function aE(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function Mg(r){return r.collectionGroup!==null}function vo(r){let e=j(r);if(e.he===null){e.he=[];let t=new Set;for(let o of e.explicitOrderBy)e.he.push(o),t.add(o.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let c=new be(je.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.he.push(new ni(o,n))}),t.has(je.keyField().canonicalString())||e.he.push(new ni(je.keyField(),n))}return e.he}function yt(r){let e=j(r);return e.Pe||(e.Pe=W1(e,vo(r))),e.Pe}function W1(r,e){if(r.limitType==="F")return zp(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new ni(i.field,o)});let t=r.endAt?new yn(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new yn(r.startAt.position,r.startAt.inclusive):null;return zp(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function $p(r,e){let t=r.filters.concat([e]);return new Yt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function bu(r,e,t){return new Yt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function tc(r,e){return ec(yt(r),yt(e))&&r.limitType===e.limitType}function OC(r){return`${ri(yt(r))}|lt:${r.limitType}`}function fo(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>RC(i)).join(", ")}]`),Ja(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>xo(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>xo(i)).join(",")),`Target(${n})`}(yt(r))}; limitType=${r.limitType})`}function nc(r,e){return e.isFoundDocument()&&function(n,i){let o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):B.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(r,e)&&function(n,i){for(let o of vo(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(r,e)&&function(n,i){for(let o of n.filters)if(!o.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(s,c,l){let d=rE(s,c,l);return s.inclusive?d<=0:d<0}(n.startAt,vo(n),i)||n.endAt&&!function(s,c,l){let d=rE(s,c,l);return s.inclusive?d>=0:d>0}(n.endAt,vo(n),i))}(r,e)}function kC(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function VC(r){return(e,t)=>{let n=!1;for(let i of vo(r)){let o=K1(i,e,t);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function K1(r,e,t){let n=r.field.isKeyField()?B.comparator(e.key,t.key):function(o,s,c){let l=s.data.field(o),d=c.data.field(o);return l!==null&&d!==null?gr(l,d):W()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return W()}}var Xt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(let[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Tr(this.inner,(t,n)=>{for(let[i,o]of n)e(i,o)})}isEmpty(){return yC(this.inner)}size(){return this.innerSize}};var H1=new xe(B.comparator);function At(){return H1}var NC=new xe(B.comparator);function va(...r){let e=NC;for(let t of r)e=e.insert(t.key,t);return e}function FC(r){let e=NC;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function hn(){return ba()}function LC(){return ba()}function ba(){return new Xt(r=>r.toString(),(r,e)=>r.isEqual(e))}var Q1=new xe(B.comparator),Y1=new be(B.comparator);function se(...r){let e=Y1;for(let t of r)e=e.add(t);return e}var X1=new be(ie);function Dg(){return X1}function Og(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pa(e)?"-0":e}}function UC(r){return{integerValue:""+r}}function jC(r,e){return aC(e)?UC(e):Og(r,e)}var Mo=class{constructor(){this._=void 0}};function J1(r,e,t){return r instanceof yr?function(i,o){let s={fields:{[wC]:{stringValue:vC},[CC]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&fd(o)&&(o=pd(o)),o&&(s.fields[EC]=o),{mapValue:s}}(t,e):r instanceof Ln?qC(r,e):r instanceof Un?zC(r,e):function(i,o){let s=BC(i,o),c=cE(s)+cE(i.Ie);return Op(s)&&Op(i.Ie)?UC(c):Og(i.serializer,c)}(r,e)}function Z1(r,e,t){return r instanceof Ln?qC(r,e):r instanceof Un?zC(r,e):t}function BC(r,e){return r instanceof _r?function(n){return Op(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}var yr=class extends Mo{},Ln=class extends Mo{constructor(e){super(),this.elements=e}};function qC(r,e){let t=$C(e);for(let n of r.elements)t.some(i=>gn(i,n))||t.push(n);return{arrayValue:{values:t}}}var Un=class extends Mo{constructor(e){super(),this.elements=e}};function zC(r,e){let t=$C(e);for(let n of r.elements)t=t.filter(i=>!gn(i,n));return{arrayValue:{values:t}}}var _r=class extends Mo{constructor(e,t){super(),this.serializer=e,this.Ie=t}};function cE(r){return Me(r.integerValue||r.doubleValue)}function $C(r){return Va(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}var ii=class{constructor(e,t){this.field=e,this.transform=t}};function eR(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof Ln&&i instanceof Ln||n instanceof Un&&i instanceof Un?Eo(n.elements,i.elements,gn):n instanceof _r&&i instanceof _r?gn(n.Ie,i.Ie):n instanceof yr&&i instanceof yr}(r.transform,e.transform)}var Gp=class{constructor(e,t){this.version=e,this.transformResults=t}},Fe=class r{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new r}static exists(e){return new r(void 0,e)}static updateTime(e){return new r(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function iu(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}var Do=class{};function GC(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new wr(r.key,Fe.none()):new vr(r.key,r.data,Fe.none());{let t=r.data,n=dt.empty(),i=new be(je.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?n.delete(o):n.set(o,s),i=i.add(o)}return new Jt(r.key,n,new Nt(i.toArray()),Fe.none())}}function tR(r,e,t){r instanceof vr?function(i,o,s){let c=i.value.clone(),l=uE(i.fieldTransforms,o,s.transformResults);c.setAll(l),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(r,e,t):r instanceof Jt?function(i,o,s){if(!iu(i.precondition,o))return void o.convertToUnknownDocument(s.version);let c=uE(i.fieldTransforms,o,s.transformResults),l=o.data;l.setAll(WC(i)),l.setAll(c),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(r,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function Ia(r,e,t,n){return r instanceof vr?function(o,s,c,l){if(!iu(o.precondition,s))return c;let d=o.value.clone(),f=dE(o.fieldTransforms,l,s);return d.setAll(f),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),null}(r,e,t,n):r instanceof Jt?function(o,s,c,l){if(!iu(o.precondition,s))return c;let d=dE(o.fieldTransforms,l,s),f=s.data;return f.setAll(WC(o)),f.setAll(d),s.convertToFoundDocument(s.version,f).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(r,e,t,n):function(o,s,c){return iu(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):c}(r,e,t)}function nR(r,e){let t=null;for(let n of r.fieldTransforms){let i=e.data.field(n.field),o=BC(n.transform,i||null);o!=null&&(t===null&&(t=dt.empty()),t.set(n.field,o))}return t||null}function lE(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Eo(n,i,(o,s)=>eR(o,s))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}var vr=class extends Do{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Jt=class extends Do{constructor(e,t,n,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function WC(r){let e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let n=r.data.field(t);e.set(t,n)}}),e}function uE(r,e,t){let n=new Map;H(r.length===t.length);for(let i=0;i<t.length;i++){let o=r[i],s=o.transform,c=e.data.field(o.field);n.set(o.field,Z1(s,c,t[i]))}return n}function dE(r,e,t){let n=new Map;for(let i of r){let o=i.transform,s=t.data.field(i.field);n.set(i.field,J1(o,s,e))}return n}var wr=class extends Do{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Na=class extends Do{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Fa=class{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&tR(o,e,n[i])}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ia(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=Ia(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=LC();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,c=this.applyToLocalView(s,o.mutatedFields);c=t.has(i.key)?null:c;let l=GC(s,c);l!==null&&n.set(i.key,l),s.isValidDocument()||s.convertToNoDocument(Y.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),se())}isEqual(e){return this.batchId===e.batchId&&Eo(this.mutations,e.mutations,(t,n)=>lE(t,n))&&Eo(this.baseMutations,e.baseMutations,(t,n)=>lE(t,n))}},Wp=class r{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){H(e.mutations.length===n.length);let i=function(){return Q1}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,n[s].version);return new r(e,t,n,i)}};var La=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Kp=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var We,ue;function KC(r){switch(r){case M.OK:return W();case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return W()}}function HC(r){if(r===void 0)return Ue("GRPC error has no .code"),M.UNKNOWN;switch(r){case We.OK:return M.OK;case We.CANCELLED:return M.CANCELLED;case We.UNKNOWN:return M.UNKNOWN;case We.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case We.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case We.INTERNAL:return M.INTERNAL;case We.UNAVAILABLE:return M.UNAVAILABLE;case We.UNAUTHENTICATED:return M.UNAUTHENTICATED;case We.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case We.NOT_FOUND:return M.NOT_FOUND;case We.ALREADY_EXISTS:return M.ALREADY_EXISTS;case We.PERMISSION_DENIED:return M.PERMISSION_DENIED;case We.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case We.ABORTED:return M.ABORTED;case We.OUT_OF_RANGE:return M.OUT_OF_RANGE;case We.UNIMPLEMENTED:return M.UNIMPLEMENTED;case We.DATA_LOSS:return M.DATA_LOSS;default:return W()}}(ue=We||(We={}))[ue.OK=0]="OK",ue[ue.CANCELLED=1]="CANCELLED",ue[ue.UNKNOWN=2]="UNKNOWN",ue[ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ue[ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ue[ue.NOT_FOUND=5]="NOT_FOUND",ue[ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",ue[ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",ue[ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",ue[ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ue[ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ue[ue.ABORTED=10]="ABORTED",ue[ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",ue[ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",ue[ue.INTERNAL=13]="INTERNAL",ue[ue.UNAVAILABLE=14]="UNAVAILABLE",ue[ue.DATA_LOSS=15]="DATA_LOSS";var hE=null;function QC(){return new TextEncoder}var rR=new Dn([4294967295,4294967295],0);function fE(r){let e=QC().encode(r),t=new rp;return t.update(e),new Uint8Array(t.digest())}function pE(r){let e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Dn([t,n],0),new Dn([i,o],0)]}var Hp=class r{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Jr(`Invalid padding: ${t}`);if(n<0)throw new Jr(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Jr(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Jr(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=Dn.fromNumber(this.Ee)}Ae(e,t,n){let i=e.add(t.multiply(Dn.fromNumber(n)));return i.compare(rR)===1&&(i=new Dn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;let t=fE(e),[n,i]=pE(t);for(let o=0;o<this.hashCount;o++){let s=this.Ae(n,i,o);if(!this.Re(s))return!1}return!0}static create(e,t,n){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new r(o,i,t);return n.forEach(c=>s.insert(c)),s}insert(e){if(this.Ee===0)return;let t=fE(e),[n,i]=pE(t);for(let o=0;o<this.hashCount;o++){let s=this.Ae(n,i,o);this.Ve(s)}}Ve(e){let t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}},Jr=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ua=class r{constructor(e,t,n,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,n){let i=new Map;return i.set(e,ja.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new r(Y.min(),i,new xe(ie),At(),se())}},ja=class r{constructor(e,t,n,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new r(n,t,se(),se(),se())}};var wo=class{constructor(e,t,n,i){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=i}},Iu=class{constructor(e,t){this.targetId=e,this.ge=t}},Tu=class{constructor(e,t,n=qe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}},Au=class{constructor(){this.pe=0,this.ye=mE(),this.we=qe.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=se(),t=se(),n=se();return this.ye.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:W()}}),new ja(this.we,this.Se,e,t,n)}Me(){this.be=!1,this.ye=mE()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,H(this.pe>=0)}Le(){this.be=!0,this.Se=!0}},Qp=class{constructor(e){this.ke=e,this.qe=new Map,this.Qe=At(),this.$e=Hl(),this.Ke=Hl(),this.Ue=new xe(ie)}We(e){for(let t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(let t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,t=>{let n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:W()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach((n,i)=>{this.Je(i)&&t(i)})}Ze(e){let t=e.targetId,n=e.ge.count,i=this.Xe(t);if(i){let o=i.target;if(Eu(o))if(n===0){let s=new B(o.path);this.ze(t,s,Qe.newNoDocument(s,Y.min()))}else H(n===1);else{let s=this.et(t);if(s!==n){let c=this.tt(e),l=c?this.nt(c,e,s):1;if(l!==0){this.Ye(t);let d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(t,d)}hE?.rt(function(f,p,g,b,V){var O,R,K,Q,L,J;let ne={localCacheCount:f,existenceFilterCount:p.count,databaseId:g.database,projectId:g.projectId},re=p.unchangedNames;return re&&(ne.bloomFilter={applied:V===0,hashCount:(O=re?.hashCount)!==null&&O!==void 0?O:0,bitmapLength:(Q=(K=(R=re?.bits)===null||R===void 0?void 0:R.bitmap)===null||K===void 0?void 0:K.length)!==null&&Q!==void 0?Q:0,padding:(J=(L=re?.bits)===null||L===void 0?void 0:L.padding)!==null&&J!==void 0?J:0,mightContain:I=>{var y;return(y=b?.mightContain(I))!==null&&y!==void 0&&y}}),ne}(s,e.ge,this.ke.it(),c,l))}}}}tt(e){let t=e.ge.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=t,s,c;try{s=Fn(n).toUint8Array()}catch(l){if(l instanceof _u)return Qt("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Hp(s,i,o)}catch(l){return Qt(l instanceof Jr?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.Ee===0?null:c}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){let n=this.ke.getRemoteKeysForTarget(t),i=0;return n.forEach(o=>{let s=this.ke.it(),c=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(c)||(this.ze(t,o,null),i++)}),i}ot(e){let t=new Map;this.qe.forEach((o,s)=>{let c=this.Xe(s);if(c){if(o.current&&Eu(c.target)){let l=new B(c.target.path);this._t(l).has(s)||this.ut(s,l)||this.ze(s,l,Qe.newNoDocument(l,e))}o.ve&&(t.set(s,o.Fe()),o.Me())}});let n=se();this.Ke.forEach((o,s)=>{let c=!0;s.forEachWhile(l=>{let d=this.Xe(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(o))}),this.Qe.forEach((o,s)=>s.setReadTime(e));let i=new Ua(e,t,this.Ue,this.Qe,n);return this.Qe=At(),this.$e=Hl(),this.Ke=Hl(),this.Ue=new xe(ie),i}Ge(e,t){if(!this.Je(e))return;let n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ke=this.Ke.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;let i=this.He(e);this.ut(e,t)?i.xe(t,1):i.Oe(t),this.Ke=this.Ke.insert(t,this.ct(t).delete(e)),this.Ke=this.Ke.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){let t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new Au,this.qe.set(e,t)),t}ct(e){let t=this.Ke.get(e);return t||(t=new be(ie),this.Ke=this.Ke.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new be(ie),this.$e=this.$e.insert(e,t)),t}Je(e){let t=this.Xe(e)!==null;return t||F("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){let t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new Au),this.ke.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}};function Hl(){return new xe(B.comparator)}function mE(){return new xe(B.comparator)}var iR={asc:"ASCENDING",desc:"DESCENDING"},oR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sR={and:"AND",or:"OR"},Yp=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Xp(r,e){return r.useProto3Json||Ja(e)?e:{value:e}}function Oo(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function YC(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function aR(r,e){return Oo(r,e.toTimestamp())}function Be(r){return H(!!r),Y.fromTimestamp(function(t){let n=Nn(t);return new Oe(n.seconds,n.nanos)}(r))}function kg(r,e){return Jp(r,e).canonicalString()}function Jp(r,e){let t=function(i){return new de(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function XC(r){let e=de.fromString(r);return H(ab(e)),e}function Ba(r,e){return kg(r.databaseId,e.path)}function pn(r,e){let t=XC(e);if(t.get(1)!==r.databaseId.projectId)throw new N(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new N(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new B(eb(t))}function JC(r,e){return kg(r.databaseId,e)}function ZC(r){let e=XC(r);return e.length===4?de.emptyPath():eb(e)}function Zp(r){return new de(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function eb(r){return H(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function gE(r,e,t){return{name:Ba(r,e),fields:t.value.mapValue.fields}}function tb(r,e,t){let n=pn(r,e.name),i=Be(e.updateTime),o=e.createTime?Be(e.createTime):Y.min(),s=new dt({mapValue:{fields:e.fields}}),c=Qe.newFoundDocument(n,i,o,s);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function cR(r,e){return"found"in e?function(n,i){H(!!i.found),i.found.name,i.found.updateTime;let o=pn(n,i.found.name),s=Be(i.found.updateTime),c=i.found.createTime?Be(i.found.createTime):Y.min(),l=new dt({mapValue:{fields:i.found.fields}});return Qe.newFoundDocument(o,s,c,l)}(r,e):"missing"in e?function(n,i){H(!!i.missing),H(!!i.readTime);let o=pn(n,i.missing),s=Be(i.readTime);return Qe.newNoDocument(o,s)}(r,e):W()}function lR(r,e){let t;if("targetChange"in e){e.targetChange;let n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:W()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,f){return d.useProto3Json?(H(f===void 0||typeof f=="string"),qe.fromBase64String(f||"")):(H(f===void 0||f instanceof Buffer||f instanceof Uint8Array),qe.fromUint8Array(f||new Uint8Array))}(r,e.targetChange.resumeToken),s=e.targetChange.cause,c=s&&function(d){let f=d.code===void 0?M.UNKNOWN:HC(d.code);return new N(f,d.message||"")}(s);t=new Tu(n,i,o,c||null)}else if("documentChange"in e){e.documentChange;let n=e.documentChange;n.document,n.document.name,n.document.updateTime;let i=pn(r,n.document.name),o=Be(n.document.updateTime),s=n.document.createTime?Be(n.document.createTime):Y.min(),c=new dt({mapValue:{fields:n.document.fields}}),l=Qe.newFoundDocument(i,o,s,c),d=n.targetIds||[],f=n.removedTargetIds||[];t=new wo(d,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;let n=e.documentDelete;n.document;let i=pn(r,n.document),o=n.readTime?Be(n.readTime):Y.min(),s=Qe.newNoDocument(i,o),c=n.removedTargetIds||[];t=new wo([],c,s.key,s)}else if("documentRemove"in e){e.documentRemove;let n=e.documentRemove;n.document;let i=pn(r,n.document),o=n.removedTargetIds||[];t=new wo([],o,i,null)}else{if(!("filter"in e))return W();{e.filter;let n=e.filter;n.targetId;let{count:i=0,unchangedNames:o}=n,s=new Kp(i,o),c=n.targetId;t=new Iu(c,s)}}return t}function qa(r,e){let t;if(e instanceof vr)t={update:gE(r,e.key,e.value)};else if(e instanceof wr)t={delete:Ba(r,e.key)};else if(e instanceof Jt)t={update:gE(r,e.key,e.data),updateMask:mR(e.fieldMask)};else{if(!(e instanceof Na))return W();t={verify:Ba(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(o,s){let c=s.transform;if(c instanceof yr)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ln)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Un)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof _r)return{fieldPath:s.field.canonicalString(),increment:c.Ie};throw W()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:aR(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:W()}(r,e.precondition)),t}function em(r,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?Fe.updateTime(Be(o.updateTime)):o.exists!==void 0?Fe.exists(o.exists):Fe.none()}(e.currentDocument):Fe.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(s,c){let l=null;if("setToServerValue"in c)H(c.setToServerValue==="REQUEST_TIME"),l=new yr;else if("appendMissingElements"in c){let f=c.appendMissingElements.values||[];l=new Ln(f)}else if("removeAllFromArray"in c){let f=c.removeAllFromArray.values||[];l=new Un(f)}else"increment"in c?l=new _r(s,c.increment):W();let d=je.fromServerFormat(c.fieldPath);return new ii(d,l)}(r,i)):[];if(e.update){e.update.name;let i=pn(r,e.update.name),o=new dt({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(l){let d=l.fieldPaths||[];return new Nt(d.map(f=>je.fromServerFormat(f)))}(e.updateMask);return new Jt(i,o,s,t,n)}return new vr(i,o,t,n)}if(e.delete){let i=pn(r,e.delete);return new wr(i,t)}if(e.verify){let i=pn(r,e.verify);return new Na(i,t)}return W()}function uR(r,e){return r&&r.length>0?(H(e!==void 0),r.map(t=>function(i,o){let s=i.updateTime?Be(i.updateTime):Be(o);return s.isEqual(Y.min())&&(s=Be(o)),new Gp(s,i.transformResults||[])}(t,e))):[]}function nb(r,e){return{documents:[JC(r,e.path)]}}function rb(r,e){let t={structuredQuery:{}},n=e.path,i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=JC(r,i);let o=function(d){if(d.length!==0)return sb(we.create(d,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(d){if(d.length!==0)return d.map(f=>function(g){return{field:po(g.field),direction:hR(g.dir)}}(f))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let c=Xp(r,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ht:t,parent:i}}function ib(r){let e=ZC(r.parent),t=r.structuredQuery,n=t.from?t.from.length:0,i=null;if(n>0){H(n===1);let f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let o=[];t.where&&(o=function(p){let g=ob(p);return g instanceof we&&Rg(g)?g.getFilters():[g]}(t.where));let s=[];t.orderBy&&(s=function(p){return p.map(g=>function(V){return new ni(mo(V.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(V.direction))}(g))}(t.orderBy));let c=null;t.limit&&(c=function(p){let g;return g=typeof p=="object"?p.value:p,Ja(g)?null:g}(t.limit));let l=null;t.startAt&&(l=function(p){let g=!!p.before,b=p.values||[];return new yn(b,g)}(t.startAt));let d=null;return t.endAt&&(d=function(p){let g=!p.before,b=p.values||[];return new yn(b,g)}(t.endAt)),DC(e,i,s,o,c,"F",l,d)}function dR(r,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function ob(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let n=mo(t.unaryFilter.field);return le.create(n,"==",{doubleValue:NaN});case"IS_NULL":let i=mo(t.unaryFilter.field);return le.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=mo(t.unaryFilter.field);return le.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=mo(t.unaryFilter.field);return le.create(s,"!=",{nullValue:"NULL_VALUE"});default:return W()}}(r):r.fieldFilter!==void 0?function(t){return le.create(mo(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return W()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return we.create(t.compositeFilter.filters.map(n=>ob(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return W()}}(t.compositeFilter.op))}(r):W()}function hR(r){return iR[r]}function fR(r){return oR[r]}function pR(r){return sR[r]}function po(r){return{fieldPath:r.canonicalString()}}function mo(r){return je.fromServerFormat(r.fieldPath)}function sb(r){return r instanceof le?function(t){if(t.op==="=="){if(eE(t.value))return{unaryFilter:{field:po(t.field),op:"IS_NAN"}};if(Zw(t.value))return{unaryFilter:{field:po(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(eE(t.value))return{unaryFilter:{field:po(t.field),op:"IS_NOT_NAN"}};if(Zw(t.value))return{unaryFilter:{field:po(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:po(t.field),op:fR(t.op),value:t.value}}}(r):r instanceof we?function(t){let n=t.getFilters().map(i=>sb(i));return n.length===1?n[0]:{compositeFilter:{op:pR(t.op),filters:n}}}(r):W()}function mR(r){let e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function ab(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}var ko=class r{constructor(e,t,n,i,o=Y.min(),s=Y.min(),c=qe.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Su=class{constructor(e){this.Tt=e}};function gR(r,e){let t;if(e.document)t=tb(r.Tt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let n=B.fromSegments(e.noDocument.path),i=si(e.noDocument.readTime);t=Qe.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return W();{let n=B.fromSegments(e.unknownDocument.path),i=si(e.unknownDocument.version);t=Qe.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime(function(i){let o=new Oe(i[0],i[1]);return Y.fromTimestamp(o)}(e.readTime)),t}function yE(r,e){let t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Pu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(o,s){return{name:Ba(o,s.key),fields:s.data.value.mapValue.fields,updateTime:Oo(o,s.version.toTimestamp()),createTime:Oo(o,s.createTime.toTimestamp())}}(r.Tt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:oi(e.version)};else{if(!e.isUnknownDocument())return W();n.unknownDocument={path:t.path.toArray(),version:oi(e.version)}}return n}function Pu(r){let e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function oi(r){let e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function si(r){let e=new Oe(r.seconds,r.nanoseconds);return Y.fromTimestamp(e)}function Hr(r,e){let t=(e.baseMutations||[]).map(o=>em(r.Tt,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let c=e.mutations[o+1];s.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let n=e.mutations.map(o=>em(r.Tt,o)),i=Oe.fromMillis(e.localWriteTimeMs);return new Fa(e.batchId,i,t,n)}function wa(r){let e=si(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?si(r.lastLimboFreeSnapshotVersion):Y.min(),n;return n=function(o){return o.documents!==void 0}(r.query)?function(o){return H(o.documents.length===1),yt(Go(ZC(o.documents[0])))}(r.query):function(o){return yt(ib(o))}(r.query),new ko(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,qe.fromBase64String(r.resumeToken))}function cb(r,e){let t=oi(e.snapshotVersion),n=oi(e.lastLimboFreeSnapshotVersion),i;i=Eu(e.target)?nb(r.Tt,e.target):rb(r.Tt,e.target).ht;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ri(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function Vg(r){let e=ib({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?bu(e,e.limit,"L"):e}function lp(r,e){return new La(e.largestBatchId,em(r.Tt,e.overlayMutation))}function _E(r,e){let t=e.path.lastSegment();return[r,ht(e.path.popLast()),t]}function vE(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:oi(n.readTime),documentKey:ht(n.documentKey.path),largestBatchId:n.largestBatchId}}var tm=class{getBundleMetadata(e,t){return wE(e).get(t).next(n=>{if(n)return function(o){return{id:o.bundleId,createTime:si(o.createTime),version:o.version}}(n)})}saveBundleMetadata(e,t){return wE(e).put(function(i){return{bundleId:i.id,createTime:oi(Be(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return EE(e).get(t).next(n=>{if(n)return function(o){return{name:o.name,query:Vg(o.bundledQuery),readTime:si(o.readTime)}}(n)})}saveNamedQuery(e,t){return EE(e).put(function(i){return{name:i.name,readTime:oi(Be(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function wE(r){return Xe(r,ud)}function EE(r){return Xe(r,dd)}var xu=class r{constructor(e,t){this.serializer=e,this.userId=t}static It(e,t){let n=t.uid||"";return new r(e,n)}getOverlay(e,t){return ma(e).get(_E(this.userId,t)).next(n=>n?lp(this.serializer,n):null)}getOverlays(e,t){let n=hn();return x.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,t,n){let i=[];return n.forEach((o,s)=>{let c=new La(t,s);i.push(this.Et(e,c))}),x.waitFor(i)}removeOverlaysForBatchId(e,t,n){let i=new Set;t.forEach(s=>i.add(ht(s.getCollectionPath())));let o=[];return i.forEach(s=>{let c=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,n+1],!1,!0);o.push(ma(e).J(xp,c))}),x.waitFor(o)}getOverlaysForCollection(e,t,n){let i=hn(),o=ht(t),s=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,Number.POSITIVE_INFINITY],!0);return ma(e).G(xp,s).next(c=>{for(let l of c){let d=lp(this.serializer,l);i.set(d.getKey(),d)}return i})}getOverlaysForCollectionGroup(e,t,n,i){let o=hn(),s,c=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ma(e).Z({index:fC,range:c},(l,d,f)=>{let p=lp(this.serializer,d);o.size()<i||p.largestBatchId===s?(o.set(p.getKey(),p),s=p.largestBatchId):f.done()}).next(()=>o)}Et(e,t){return ma(e).put(function(i,o,s){let[c,l,d]=_E(o,s.mutation.key);return{userId:o,collectionPath:l,documentId:d,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:qa(i.Tt,s.mutation)}}(this.serializer,this.userId,t))}};function ma(r){return Xe(r,hd)}var nm=class{dt(e){return Xe(e,Ag)}getSessionToken(e){return this.dt(e).get("sessionToken").next(t=>{let n=t?.value;return n?qe.fromUint8Array(n):qe.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.dt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var kn=class{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(Me(e.integerValue));else if("doubleValue"in e){let n=Me(e.doubleValue);isNaN(n)?this.ft(t,13):(this.ft(t,15),Pa(n)?t.gt(0):t.gt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.ft(t,20),typeof n=="string"&&(n=Nn(n)),t.yt(`${n.seconds||""}`),t.gt(n.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.St(t);else if("bytesValue"in e)this.ft(t,30),t.bt(Fn(e.bytesValue)),this.St(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){let n=e.geoPointValue;this.ft(t,45),t.gt(n.latitude||0),t.gt(n.longitude||0)}else"mapValue"in e?IC(e)?this.ft(t,Number.MAX_SAFE_INTEGER):md(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.St(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.St(t)):W()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){let n=e.fields||{};this.ft(t,55);for(let i of Object.keys(n))this.wt(i,t),this.Rt(n[i],t)}vt(e,t){var n,i;let o=e.fields||{};this.ft(t,53);let s=Po,c=((i=(n=o[s].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.length)||0;this.ft(t,15),t.gt(Me(c)),this.wt(s,t),this.Rt(o[s],t)}Ft(e,t){let n=e.values||[];this.ft(t,50);for(let i of n)this.Rt(i,t)}Dt(e,t){this.ft(t,37),B.fromName(e).path.forEach(n=>{this.ft(t,60),this.Mt(n,t)})}ft(e,t){e.gt(t)}St(e){e.gt(2)}};kn.xt=new kn;var ao=255;function yR(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function CE(r){let e=64-function(n){let i=0;for(let o=0;o<8;++o){let s=yR(255&n[o]);if(i+=s,s!==8)break}return i}(r);return Math.ceil(e/8)}var rm=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ot(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Nt(n.value),n=t.next();this.Bt()}Lt(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.kt(n.value),n=t.next();this.qt()}Qt(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.Nt(n);else if(n<2048)this.Nt(960|n>>>6),this.Nt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Nt(480|n>>>12),this.Nt(128|63&n>>>6),this.Nt(128|63&n);else{let i=t.codePointAt(0);this.Nt(240|i>>>18),this.Nt(128|63&i>>>12),this.Nt(128|63&i>>>6),this.Nt(128|63&i)}}this.Bt()}$t(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.kt(n);else if(n<2048)this.kt(960|n>>>6),this.kt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.kt(480|n>>>12),this.kt(128|63&n>>>6),this.kt(128|63&n);else{let i=t.codePointAt(0);this.kt(240|i>>>18),this.kt(128|63&i>>>12),this.kt(128|63&i>>>6),this.kt(128|63&i)}}this.qt()}Kt(e){let t=this.Ut(e),n=CE(t);this.Wt(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Gt(e){let t=this.Ut(e),n=CE(t);this.Wt(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}zt(){this.jt(ao),this.jt(255)}Ht(){this.Jt(ao),this.Jt(255)}reset(){this.position=0}seed(e){this.Wt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Yt(){return this.buffer.slice(0,this.position)}Ut(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Nt(e){let t=255&e;t===0?(this.jt(0),this.jt(255)):t===ao?(this.jt(ao),this.jt(0)):this.jt(t)}kt(e){let t=255&e;t===0?(this.Jt(0),this.Jt(255)):t===ao?(this.Jt(ao),this.Jt(0)):this.Jt(e)}Bt(){this.jt(0),this.jt(1)}qt(){this.Jt(0),this.Jt(1)}jt(e){this.Wt(1),this.buffer[this.position++]=e}Jt(e){this.Wt(1),this.buffer[this.position++]=~e}Wt(e){let t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);let i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}},im=class{constructor(e){this.Zt=e}bt(e){this.Zt.Ot(e)}yt(e){this.Zt.Qt(e)}gt(e){this.Zt.Kt(e)}Vt(){this.Zt.zt()}},om=class{constructor(e){this.Zt=e}bt(e){this.Zt.Lt(e)}yt(e){this.Zt.$t(e)}gt(e){this.Zt.Gt(e)}Vt(){this.Zt.Ht()}},Qr=class{constructor(){this.Zt=new rm,this.Xt=new im(this.Zt),this.en=new om(this.Zt)}seed(e){this.Zt.seed(e)}tn(e){return e===0?this.Xt:this.en}Yt(){return this.Zt.Yt()}reset(){this.Zt.reset()}};var Yr=class r{constructor(e,t,n,i){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=i}nn(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new r(this.indexId,this.documentKey,this.arrayValue,n)}};function ir(r,e){let t=r.indexId-e.indexId;return t!==0?t:(t=bE(r.arrayValue,e.arrayValue),t!==0?t:(t=bE(r.directionalValue,e.directionalValue),t!==0?t:B.comparator(r.documentKey,e.documentKey)))}function bE(r,e){for(let t=0;t<r.length&&t<e.length;++t){let n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}var Ru=class{constructor(e){this.rn=new be((t,n)=>je.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.sn=e.orderBy,this._n=[];for(let t of e.filters){let n=t;n.isInequality()?this.rn=this.rn.add(n):this._n.push(n)}}get an(){return this.rn.size>1}un(e){if(H(e.collectionGroup===this.collectionId),this.an)return!1;let t=Cp(e);if(t!==void 0&&!this.cn(t))return!1;let n=Gr(e),i=new Set,o=0,s=0;for(;o<n.length&&this.cn(n[o]);++o)i=i.add(n[o].fieldPath.canonicalString());if(o===n.length)return!0;if(this.rn.size>0){let c=this.rn.getIterator().getNext();if(!i.has(c.field.canonicalString())){let l=n[o];if(!this.ln(c,l)||!this.hn(this.sn[s++],l))return!1}++o}for(;o<n.length;++o){let c=n[o];if(s>=this.sn.length||!this.hn(this.sn[s++],c))return!1}return!0}Pn(){if(this.an)return null;let e=new be(je.comparator),t=[];for(let n of this._n)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new _o(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new _o(n.field,0))}for(let n of this.sn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new _o(n.field,n.dir==="asc"?0:1)));return new bo(bo.UNKNOWN_ID,this.collectionId,t,Sa.empty())}cn(e){for(let t of this._n)if(this.ln(t,e))return!0;return!1}ln(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}hn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function lb(r){var e,t;if(H(r instanceof le||r instanceof we),r instanceof le){if(r instanceof wu){let i=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>le.create(r.field,"==",o)))||[];return we.create(i,"or")}return r}let n=r.filters.map(i=>lb(i));return we.create(n,r.op)}function _R(r){if(r.getFilters().length===0)return[];let e=cm(lb(r));return H(ub(e)),sm(e)||am(e)?[e]:e.getFilters()}function sm(r){return r instanceof le}function am(r){return r instanceof we&&Rg(r)}function ub(r){return sm(r)||am(r)||function(t){if(t instanceof we&&kp(t)){for(let n of t.getFilters())if(!sm(n)&&!am(n))return!1;return!0}return!1}(r)}function cm(r){if(H(r instanceof le||r instanceof we),r instanceof le)return r;if(r.filters.length===1)return cm(r.filters[0]);let e=r.filters.map(n=>cm(n)),t=we.create(e,r.op);return t=Mu(t),ub(t)?t:(H(t instanceof we),H(Ro(t)),H(t.filters.length>1),t.filters.reduce((n,i)=>Ng(n,i)))}function Ng(r,e){let t;return H(r instanceof le||r instanceof we),H(e instanceof le||e instanceof we),t=r instanceof le?e instanceof le?function(i,o){return we.create([i,o],"and")}(r,e):IE(r,e):e instanceof le?IE(e,r):function(i,o){if(H(i.filters.length>0&&o.filters.length>0),Ro(i)&&Ro(o))return xC(i,o.getFilters());let s=kp(i)?i:o,c=kp(i)?o:i,l=s.filters.map(d=>Ng(d,c));return we.create(l,"or")}(r,e),Mu(t)}function IE(r,e){if(Ro(e))return xC(e,r.getFilters());{let t=e.filters.map(n=>Ng(r,n));return we.create(t,"or")}}function Mu(r){if(H(r instanceof le||r instanceof we),r instanceof le)return r;let e=r.getFilters();if(e.length===1)return Mu(e[0]);if(SC(r))return r;let t=e.map(i=>Mu(i)),n=[];return t.forEach(i=>{i instanceof le?n.push(i):i instanceof we&&(i.op===r.op?n.push(...i.filters):n.push(i))}),n.length===1?n[0]:we.create(n,r.op)}var lm=class{constructor(){this.Tn=new za}addToCollectionParentIndex(e,t){return this.Tn.add(t),x.resolve()}getCollectionParents(e,t){return x.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return x.resolve()}deleteFieldIndex(e,t){return x.resolve()}deleteAllFieldIndexes(e){return x.resolve()}createTargetIndexes(e,t){return x.resolve()}getDocumentsMatchingTarget(e,t){return x.resolve(null)}getIndexType(e,t){return x.resolve(0)}getFieldIndexes(e,t){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,t){return x.resolve(qt.min())}getMinOffsetFromCollectionGroup(e,t){return x.resolve(qt.min())}updateCollectionGroup(e,t,n){return x.resolve()}updateIndexEntries(e,t){return x.resolve()}},za=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new be(de.comparator),o=!i.has(n);return this.index[t]=i.add(n),o}has(e){let t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new be(de.comparator)).toArray()}};var TE="IndexedDbIndexManager",Ql=new Uint8Array(0),um=class{constructor(e,t){this.databaseId=t,this.In=new za,this.En=new Xt(n=>ri(n),(n,i)=>ec(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.In.has(t)){let n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.In.add(t)});let o={collectionId:n,parent:ht(i)};return AE(e).put(o)}return x.resolve()}getCollectionParents(e,t){let n=[],i=IDBKeyRange.bound([t,""],[nC(t),""],!1,!0);return AE(e).G(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;n.push(dn(s.parent))}return n})}addFieldIndex(e,t){let n=ga(e),i=function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete i.indexId;let o=n.add(i);if(t.indexState){let s=lo(e);return o.next(c=>{s.put(vE(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let n=ga(e),i=lo(e),o=co(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=ga(e),n=co(e),i=lo(e);return t.J().next(()=>n.J()).next(()=>i.J())}createTargetIndexes(e,t){return x.forEach(this.dn(t),n=>this.getIndexType(e,n).next(i=>{if(i===0||i===1){let o=new Ru(n).Pn();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let n=co(e),i=!0,o=new Map;return x.forEach(this.dn(t),s=>this.An(e,s).next(c=>{i&&(i=!!c),o.set(s,c)})).next(()=>{if(i){let s=se(),c=[];return x.forEach(o,(l,d)=>{F(TE,`Using index ${function(L){return`id=${L.indexId}|cg=${L.collectionGroup}|f=${L.fields.map(J=>`${J.fieldPath}:${J.kind}`).join(",")}`}(l)} to execute ${ri(t)}`);let f=function(L,J){let ne=Cp(J);if(ne===void 0)return null;for(let re of Cu(L,ne.fieldPath))switch(re.op){case"array-contains-any":return re.value.arrayValue.values||[];case"array-contains":return[re.value]}return null}(d,l),p=function(L,J){let ne=new Map;for(let re of Gr(J))for(let I of Cu(L,re.fieldPath))switch(I.op){case"==":case"in":ne.set(re.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return ne.set(re.fieldPath.canonicalString(),I.value),Array.from(ne.values())}return null}(d,l),g=function(L,J){let ne=[],re=!0;for(let I of Gr(J)){let y=I.kind===0?oE(L,I.fieldPath,L.startAt):sE(L,I.fieldPath,L.startAt);ne.push(y.value),re&&(re=y.inclusive)}return new yn(ne,re)}(d,l),b=function(L,J){let ne=[],re=!0;for(let I of Gr(J)){let y=I.kind===0?sE(L,I.fieldPath,L.endAt):oE(L,I.fieldPath,L.endAt);ne.push(y.value),re&&(re=y.inclusive)}return new yn(ne,re)}(d,l),V=this.Rn(l,d,g),O=this.Rn(l,d,b),R=this.Vn(l,d,p),K=this.mn(l.indexId,f,V,g.inclusive,O,b.inclusive,R);return x.forEach(K,Q=>n.H(Q,t.limit).next(L=>{L.forEach(J=>{let ne=B.fromSegments(J.documentKey);s.has(ne)||(s=s.add(ne),c.push(ne))})}))}).next(()=>c)}return x.resolve(null)})}dn(e){let t=this.En.get(e);return t||(e.filters.length===0?t=[e]:t=_R(we.create(e.filters,"and")).map(n=>zp(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.En.set(e,t),t)}mn(e,t,n,i,o,s,c){let l=(t!=null?t.length:1)*Math.max(n.length,o.length),d=l/(t!=null?t.length:1),f=[];for(let p=0;p<l;++p){let g=t?this.fn(t[p/d]):Ql,b=this.gn(e,g,n[p%d],i),V=this.pn(e,g,o[p%d],s),O=c.map(R=>this.gn(e,g,R,!0));f.push(...this.createRange(b,V,O))}return f}gn(e,t,n,i){let o=new Yr(e,B.empty(),t,n);return i?o:o.nn()}pn(e,t,n,i){let o=new Yr(e,B.empty(),t,n);return i?o.nn():o}An(e,t){let n=new Ru(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let c of o)n.un(c)&&(!s||c.fields.length>s.fields.length)&&(s=c);return s})}getIndexType(e,t){let n=2,i=this.dn(t);return x.forEach(i,o=>this.An(e,o).next(s=>{s?n!==0&&s.fields.length<function(l){let d=new be(je.comparator),f=!1;for(let p of l.filters)for(let g of p.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?f=!0:d=d.add(g.field));for(let p of l.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(f?1:0)}(o)&&(n=1):n=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&n===2?1:n)}yn(e,t){let n=new Qr;for(let i of Gr(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=n.tn(i.kind);kn.xt.At(o,s)}return n.Yt()}fn(e){let t=new Qr;return kn.xt.At(e,t.tn(0)),t.Yt()}wn(e,t){let n=new Qr;return kn.xt.At(ti(this.databaseId,t),n.tn(function(o){let s=Gr(o);return s.length===0?0:s[s.length-1].kind}(e))),n.Yt()}Vn(e,t,n){if(n===null)return[];let i=[];i.push(new Qr);let o=0;for(let s of Gr(e)){let c=n[o++];for(let l of i)if(this.Sn(t,s.fieldPath)&&Va(c))i=this.bn(i,s,c);else{let d=l.tn(s.kind);kn.xt.At(c,d)}}return this.Dn(i)}Rn(e,t,n){return this.Vn(e,t,n.position)}Dn(e){let t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Yt();return t}bn(e,t,n){let i=[...e],o=[];for(let s of n.arrayValue.values||[])for(let c of i){let l=new Qr;l.seed(c.Yt()),kn.xt.At(s,l.tn(t.kind)),o.push(l)}return o}Sn(e,t){return!!e.filters.find(n=>n instanceof le&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){let n=ga(e),i=lo(e);return(t?n.G(Pp,IDBKeyRange.bound(t,t)):n.G()).next(o=>{let s=[];return x.forEach(o,c=>i.get([c.indexId,this.uid]).next(l=>{s.push(function(f,p){let g=p?new Sa(p.sequenceNumber,new qt(si(p.readTime),new B(dn(p.documentKey)),p.largestBatchId)):Sa.empty(),b=f.fields.map(([V,O])=>new _o(je.fromServerFormat(V),O));return new bo(f.indexId,f.collectionGroup,b,g)}(c,l))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,i)=>{let o=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:ie(n.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){let i=ga(e),o=lo(e);return this.vn(e).next(s=>i.G(Pp,IDBKeyRange.bound(t,t)).next(c=>x.forEach(c,l=>o.put(vE(l.indexId,this.uid,s,n)))))}updateIndexEntries(e,t){let n=new Map;return x.forEach(t,(i,o)=>{let s=n.get(i.collectionGroup);return(s?x.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(c=>(n.set(i.collectionGroup,c),x.forEach(c,l=>this.Cn(e,i,l).next(d=>{let f=this.Fn(o,l);return d.isEqual(f)?x.resolve():this.Mn(e,o,l,d,f)}))))})}xn(e,t,n,i){return co(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.wn(n,t.key),documentKey:t.key.path.toArray()})}On(e,t,n,i){return co(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.wn(n,t.key),t.key.path.toArray()])}Cn(e,t,n){let i=co(e),o=new be(ir);return i.Z({index:hC,range:IDBKeyRange.only([n.indexId,this.uid,this.wn(n,t)])},(s,c)=>{o=o.add(new Yr(n.indexId,t,c.arrayValue,c.directionalValue))}).next(()=>o)}Fn(e,t){let n=new be(ir),i=this.yn(t,e);if(i==null)return n;let o=Cp(t);if(o!=null){let s=e.data.field(o.fieldPath);if(Va(s))for(let c of s.arrayValue.values||[])n=n.add(new Yr(t.indexId,e.key,this.fn(c),i))}else n=n.add(new Yr(t.indexId,e.key,Ql,i));return n}Mn(e,t,n,i,o){F(TE,"Updating index entries for document '%s'",t.key);let s=[];return function(l,d,f,p,g){let b=l.getIterator(),V=d.getIterator(),O=so(b),R=so(V);for(;O||R;){let K=!1,Q=!1;if(O&&R){let L=f(O,R);L<0?Q=!0:L>0&&(K=!0)}else O!=null?Q=!0:K=!0;K?(p(R),R=so(V)):Q?(g(O),O=so(b)):(O=so(b),R=so(V))}}(i,o,ir,c=>{s.push(this.xn(e,t,n,c))},c=>{s.push(this.On(e,t,n,c))}),x.waitFor(s)}vn(e){let t=1;return lo(e).Z({index:dC,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((s,c)=>ir(s,c)).filter((s,c,l)=>!c||ir(s,l[c-1])!==0);let i=[];i.push(e);for(let s of n){let c=ir(s,e),l=ir(s,t);if(c===0)i[0]=e.nn();else if(c>0&&l<0)i.push(s),i.push(s.nn());else if(l>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.Nn(i[s],i[s+1]))return[];let c=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,Ql,[]],l=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,Ql,[]];o.push(IDBKeyRange.bound(c,l))}return o}Nn(e,t){return ir(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(SE)}getMinOffset(e,t){return x.mapArray(this.dn(t),n=>this.An(e,n).next(i=>i||W())).next(SE)}};function AE(r){return Xe(r,Ma)}function co(r){return Xe(r,gu)}function ga(r){return Xe(r,Tg)}function lo(r){return Xe(r,mu)}function SE(r){H(r.length!==0);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){let i=r[n].indexState.offset;Cg(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new qt(e.readTime,e.documentKey,t)}var PE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},db=41943040,Tt=class r{static withCacheSize(e){return new r(e,r.DEFAULT_COLLECTION_PERCENTILE,r.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}};function hb(r,e,t){let n=r.store(Ht),i=r.store(Io),o=[],s=IDBKeyRange.only(t.batchId),c=0,l=n.Z({range:s},(f,p,g)=>(c++,g.delete()));o.push(l.next(()=>{H(c===1)}));let d=[];for(let f of t.mutations){let p=cC(e,f.key.path,t.batchId);o.push(i.delete(p)),d.push(f.key)}return x.waitFor(o).next(()=>d)}function Du(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw W();e=r.noDocument}return JSON.stringify(e).length}Tt.DEFAULT_COLLECTION_PERCENTILE=10,Tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tt.DEFAULT=new Tt(db,Tt.DEFAULT_COLLECTION_PERCENTILE,Tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tt.DISABLED=new Tt(-1,0,0);var Ou=class r{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Bn={}}static It(e,t,n,i){H(e.uid!=="");let o=e.isAuthenticated()?e.uid:"";return new r(o,t,n,i)}checkEmpty(e){let t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return or(e).Z({index:Xr,range:n},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,n,i){let o=go(e),s=or(e);return s.add({}).next(c=>{H(typeof c=="number");let l=new Fa(c,t,n,i),d=function(b,V,O){let R=O.baseMutations.map(Q=>qa(b.Tt,Q)),K=O.mutations.map(Q=>qa(b.Tt,Q));return{userId:V,batchId:O.batchId,localWriteTimeMs:O.localWriteTime.toMillis(),baseMutations:R,mutations:K}}(this.serializer,this.userId,l),f=[],p=new be((g,b)=>ie(g.canonicalString(),b.canonicalString()));for(let g of i){let b=cC(this.userId,g.key.path,c);p=p.add(g.key.path.popLast()),f.push(s.put(d)),f.push(o.put(b,_1))}return p.forEach(g=>{f.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Bn[c]=l.keys()}),x.waitFor(f).next(()=>l)})}lookupMutationBatch(e,t){return or(e).get(t).next(n=>n?(H(n.userId===this.userId),Hr(this.serializer,n)):null)}Ln(e,t){return this.Bn[t]?x.resolve(this.Bn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){let i=n.keys();return this.Bn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]),o=null;return or(e).Z({index:Xr,range:i},(s,c,l)=>{c.userId===this.userId&&(H(c.batchId>=n),o=Hr(this.serializer,c)),l.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=ur;return or(e).Z({index:Xr,range:t,reverse:!0},(i,o,s)=>{n=o.batchId,s.done()}).next(()=>n)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,ur],[this.userId,Number.POSITIVE_INFINITY]);return or(e).G(Xr,t).next(n=>n.map(i=>Hr(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let n=Zl(this.userId,t.path),i=IDBKeyRange.lowerBound(n),o=[];return go(e).Z({range:i},(s,c,l)=>{let[d,f,p]=s,g=dn(f);if(d===this.userId&&t.path.isEqual(g))return or(e).get(p).next(b=>{if(!b)throw W();H(b.userId===this.userId),o.push(Hr(this.serializer,b))});l.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new be(ie),i=[];return t.forEach(o=>{let s=Zl(this.userId,o.path),c=IDBKeyRange.lowerBound(s),l=go(e).Z({range:c},(d,f,p)=>{let[g,b,V]=d,O=dn(b);g===this.userId&&o.path.isEqual(O)?n=n.add(V):p.done()});i.push(l)}),x.waitFor(i).next(()=>this.kn(e,n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,i=n.length+1,o=Zl(this.userId,n),s=IDBKeyRange.lowerBound(o),c=new be(ie);return go(e).Z({range:s},(l,d,f)=>{let[p,g,b]=l,V=dn(g);p===this.userId&&n.isPrefixOf(V)?V.length===i&&(c=c.add(b)):f.done()}).next(()=>this.kn(e,c))}kn(e,t){let n=[],i=[];return t.forEach(o=>{i.push(or(e).get(o).next(s=>{if(s===null)throw W();H(s.userId===this.userId),n.push(Hr(this.serializer,s))}))}),x.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return hb(e.ue,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.qn(t.batchId)}),x.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}qn(e){delete this.Bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return x.resolve();let n=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return go(e).Z({range:n},(o,s,c)=>{if(o[0]===this.userId){let l=dn(o[1]);i.push(l)}else c.done()}).next(()=>{H(i.length===0)})})}containsKey(e,t){return fb(e,this.userId,t)}Qn(e){return pb(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:ur,lastStreamToken:""})}};function fb(r,e,t){let n=Zl(e,t.path),i=n[1],o=IDBKeyRange.lowerBound(n),s=!1;return go(r).Z({range:o,Y:!0},(c,l,d)=>{let[f,p,g]=c;f===e&&p===i&&(s=!0),d.done()}).next(()=>s)}function or(r){return Xe(r,Ht)}function go(r){return Xe(r,Io)}function pb(r){return Xe(r,xa)}var Vo=class r{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Kn(){return new r(0)}static Un(){return new r(-1)}};var dm=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Wn(e).next(t=>{let n=new Vo(t.highestTargetId);return t.highestTargetId=n.next(),this.Gn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Wn(e).next(t=>Y.fromTimestamp(new Oe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Wn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.Wn(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Gn(e,i)))}addTargetData(e,t){return this.zn(e,t).next(()=>this.Wn(e).next(n=>(n.targetCount+=1,this.jn(t,n),this.Gn(e,n))))}updateTargetData(e,t){return this.zn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>uo(e).delete(t.targetId)).next(()=>this.Wn(e)).next(n=>(H(n.targetCount>0),n.targetCount-=1,this.Gn(e,n)))}removeTargets(e,t,n){let i=0,o=[];return uo(e).Z((s,c)=>{let l=wa(c);l.sequenceNumber<=t&&n.get(l.targetId)===null&&(i++,o.push(this.removeTargetData(e,l)))}).next(()=>x.waitFor(o)).next(()=>i)}forEachTarget(e,t){return uo(e).Z((n,i)=>{let o=wa(i);t(o)})}Wn(e){return xE(e).get(pu).next(t=>(H(t!==null),t))}Gn(e,t){return xE(e).put(pu,t)}zn(e,t){return uo(e).put(cb(this.serializer,t))}jn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Wn(e).next(t=>t.targetCount)}getTargetData(e,t){let n=ri(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),o=null;return uo(e).Z({range:i,index:uC},(s,c,l)=>{let d=wa(c);ec(t,d.target)&&(o=d,l.done())}).next(()=>o)}addMatchingKeys(e,t,n){let i=[],o=ar(e);return t.forEach(s=>{let c=ht(s.path);i.push(o.put({targetId:n,path:c})),i.push(this.referenceDelegate.addReference(e,n,s))}),x.waitFor(i)}removeMatchingKeys(e,t,n){let i=ar(e);return x.forEach(t,o=>{let s=ht(o.path);return x.waitFor([i.delete([n,s]),this.referenceDelegate.removeReference(e,n,o)])})}removeMatchingKeysForTargetId(e,t){let n=ar(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){let n=IDBKeyRange.bound([t],[t+1],!1,!0),i=ar(e),o=se();return i.Z({range:n,Y:!0},(s,c,l)=>{let d=dn(s[1]),f=new B(d);o=o.add(f)}).next(()=>o)}containsKey(e,t){let n=ht(t.path),i=IDBKeyRange.bound([n],[nC(n)],!1,!0),o=0;return ar(e).Z({index:Ig,Y:!0,range:i},([s,c],l,d)=>{s!==0&&(o++,d.done())}).next(()=>o>0)}lt(e,t){return uo(e).get(t).next(n=>n?wa(n):null)}};function uo(r){return Xe(r,To)}function xE(r){return Xe(r,ei)}function ar(r){return Xe(r,Ao)}var RE="LruGarbageCollector",vR=1048576;function ME([r,e],[t,n]){let i=ie(r,t);return i===0?ie(e,n):i}var hm=class{constructor(e){this.Hn=e,this.buffer=new be(ME),this.Jn=0}Yn(){return++this.Jn}Zn(e){let t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{let n=this.buffer.last();ME(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}},ku=class{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){F(RE,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>k(this,null,function*(){this.Xn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ir(t)?F(RE,"Ignoring IndexedDB error during garbage collection: ",t):yield br(t)}yield this.er(3e5)}))}},fm=class{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return x.resolve(Vt.ae);let n=new hm(t);return this.tr.forEachTarget(e,i=>n.Zn(i.sequenceNumber)).next(()=>this.tr.rr(e,i=>n.Zn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(F("LruGarbageCollector","Garbage collection skipped; disabled"),x.resolve(PE)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(F("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),PE):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,i,o,s,c,l,d,f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(F("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(n=p,c=Date.now(),this.removeTargets(e,n,t))).next(p=>(o=p,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(p=>(d=Date.now(),ho()<=an.DEBUG&&F("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-f}ms
	Determined least recently used ${i} in `+(c-s)+`ms
	Removed ${o} targets in `+(l-c)+`ms
	Removed ${p} documents in `+(d-l)+`ms
Total Duration: ${d-f}ms`),x.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}};function mb(r,e){return new fm(r,e)}var pm=class{constructor(e,t){this.db=e,this.garbageCollector=mb(this,t)}nr(e){let t=this.sr(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}rr(e,t){return this._r(e,(n,i)=>t(i))}addReference(e,t,n){return Yl(e,n)}removeReference(e,t,n){return Yl(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Yl(e,t)}ar(e,t){return function(i,o){let s=!1;return pb(i).X(c=>fb(i,c,o).next(l=>(l&&(s=!0),x.resolve(!l)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this._r(e,(s,c)=>{if(c<=t){let l=this.ar(e,s).next(d=>{if(!d)return o++,n.getEntry(e,s).next(()=>(n.removeEntry(s,Y.min()),ar(e).delete(function(p){return[0,ht(p.path)]}(s))))});i.push(l)}}).next(()=>x.waitFor(i)).next(()=>n.apply(e)).next(()=>o)}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Yl(e,t)}_r(e,t){let n=ar(e),i,o=Vt.ae;return n.Z({index:Ig},([s,c],{path:l,sequenceNumber:d})=>{s===0?(o!==Vt.ae&&t(new B(dn(i)),o),o=d,i=l):o=Vt.ae}).next(()=>{o!==Vt.ae&&t(new B(dn(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Yl(r,e){return ar(r).put(function(n,i){return{targetId:0,path:ht(n.path),sequenceNumber:i}}(e,r.currentSequenceNumber))}var Vu=class{constructor(){this.changes=new Xt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Qe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return n!==void 0?x.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var mm=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return $r(e).put(n)}removeEntry(e,t,n){return $r(e).delete(function(o,s){let c=o.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],Pu(s),c[c.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.ur(e,n)))}getEntry(e,t){let n=Qe.newInvalidDocument(t);return $r(e).Z({index:eu,range:IDBKeyRange.only(ya(t))},(i,o)=>{n=this.cr(t,o)}).next(()=>n)}lr(e,t){let n={size:0,document:Qe.newInvalidDocument(t)};return $r(e).Z({index:eu,range:IDBKeyRange.only(ya(t))},(i,o)=>{n={document:this.cr(t,o),size:Du(o)}}).next(()=>n)}getEntries(e,t){let n=At();return this.hr(e,t,(i,o)=>{let s=this.cr(i,o);n=n.insert(i,s)}).next(()=>n)}Pr(e,t){let n=At(),i=new xe(B.comparator);return this.hr(e,t,(o,s)=>{let c=this.cr(o,s);n=n.insert(o,c),i=i.insert(o,Du(s))}).next(()=>({documents:n,Tr:i}))}hr(e,t,n){if(t.isEmpty())return x.resolve();let i=new be(kE);t.forEach(l=>i=i.add(l));let o=IDBKeyRange.bound(ya(i.first()),ya(i.last())),s=i.getIterator(),c=s.getNext();return $r(e).Z({index:eu,range:o},(l,d,f)=>{let p=B.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;c&&kE(c,p)<0;)n(c,null),c=s.getNext();c&&c.isEqual(p)&&(n(c,d),c=s.hasNext()?s.getNext():null),c?f.W(ya(c)):f.done()}).next(()=>{for(;c;)n(c,null),c=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,o){let s=t.path,c=[s.popLast().toArray(),s.lastSegment(),Pu(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],l=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return $r(e).G(IDBKeyRange.bound(c,l,!0)).next(d=>{o?.incrementDocumentReadCount(d.length);let f=At();for(let p of d){let g=this.cr(B.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);g.isFoundDocument()&&(nc(t,g)||i.has(g.key))&&(f=f.insert(g.key,g))}return f})}getAllFromCollectionGroup(e,t,n,i){let o=At(),s=OE(t,n),c=OE(t,qt.max());return $r(e).Z({index:lC,range:IDBKeyRange.bound(s,c,!0)},(l,d,f)=>{let p=this.cr(B.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);o=o.insert(p.key,p),o.size===i&&f.done()}).next(()=>o)}newChangeBuffer(e){return new gm(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return DE(e).get(Sp).next(t=>(H(!!t),t))}ur(e,t){return DE(e).put(Sp,t)}cr(e,t){if(t){let n=gR(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(Y.min())))return n}return Qe.newInvalidDocument(e)}};function gb(r){return new mm(r)}var gm=class extends Vu{constructor(e,t){super(),this.Ir=e,this.trackRemovals=t,this.Er=new Xt(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){let t=[],n=0,i=new be((o,s)=>ie(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let c=this.Er.get(o);if(t.push(this.Ir.removeEntry(e,o,c.readTime)),s.isValidDocument()){let l=yE(this.Ir.serializer,s);i=i.add(o.path.popLast());let d=Du(l);n+=d-c.size,t.push(this.Ir.addEntry(e,o,l))}else if(n-=c.size,this.trackRemovals){let l=yE(this.Ir.serializer,s.convertToNoDocument(Y.min()));t.push(this.Ir.addEntry(e,o,l))}}),i.forEach(o=>{t.push(this.Ir.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.Ir.updateMetadata(e,n)),x.waitFor(t)}getFromCache(e,t){return this.Ir.lr(e,t).next(n=>(this.Er.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.Ir.Pr(e,t).next(({documents:n,Tr:i})=>(i.forEach((o,s)=>{this.Er.set(o,{size:s,readTime:n.get(o).readTime})}),n))}};function DE(r){return Xe(r,Ra)}function $r(r){return Xe(r,fu)}function ya(r){let e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function OE(r,e){let t=e.documentKey.path.toArray();return[r,Pu(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function kE(r,e){let t=r.path.toArray(),n=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<n.length-2;++o)if(i=ie(t[o],n[o]),i)return i;return i=ie(t.length,n.length),i||(i=ie(t[t.length-2],n[n.length-2]),i||ie(t[t.length-1],n[n.length-1]))}var ym=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Nu=class{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&Ia(n.mutation,i,Nt.empty(),Oe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,se()).next(()=>n))}getLocalViewOfDocuments(e,t,n=se()){let i=hn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(o=>{let s=va();return o.forEach((c,l)=>{s=s.insert(c,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let n=hn();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,se()))}populateOverlays(e,t,n){let i=[];return n.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,c)=>{t.set(s,c)})})}computeViews(e,t,n,i){let o=At(),s=ba(),c=function(){return ba()}();return t.forEach((l,d)=>{let f=n.get(d.key);i.has(d.key)&&(f===void 0||f.mutation instanceof Jt)?o=o.insert(d.key,d):f!==void 0?(s.set(d.key,f.mutation.getFieldMask()),Ia(f.mutation,d,f.mutation.getFieldMask(),Oe.now())):s.set(d.key,Nt.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((d,f)=>s.set(d,f)),t.forEach((d,f)=>{var p;return c.set(d,new ym(f,(p=s.get(d))!==null&&p!==void 0?p:null))}),c))}recalculateAndSaveOverlays(e,t){let n=ba(),i=new xe((s,c)=>s-c),o=se();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let c of s)c.keys().forEach(l=>{let d=t.get(l);if(d===null)return;let f=n.get(l)||Nt.empty();f=c.applyToLocalView(d,f),n.set(l,f);let p=(i.get(c.batchId)||se()).add(l);i=i.insert(c.batchId,p)})}).next(()=>{let s=[],c=i.getReverseIterator();for(;c.hasNext();){let l=c.getNext(),d=l.key,f=l.value,p=LC();f.forEach(g=>{if(!o.has(g)){let b=GC(t.get(g),n.get(g));b!==null&&p.set(g,b),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,d,p))}return x.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(s){return B.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Mg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-o.size):x.resolve(hn()),c=Co,l=o;return s.next(d=>x.forEach(d,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),o.get(f)?x.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,l,d,se())).next(f=>({batchId:c,changes:FC(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(n=>{let i=va();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){let o=t.collectionGroup,s=va();return this.indexManager.getCollectionParents(e,o).next(c=>x.forEach(c,l=>{let d=function(p,g){return new Yt(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,i).next(f=>{f.forEach((p,g)=>{s=s.insert(p,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,o,i))).next(s=>{o.forEach((l,d)=>{let f=d.getKey();s.get(f)===null&&(s=s.insert(f,Qe.newInvalidDocument(f)))});let c=va();return s.forEach((l,d)=>{let f=o.get(l);f!==void 0&&Ia(f.mutation,d,Nt.empty(),Oe.now()),nc(t,d)&&(c=c.insert(l,d))}),c})}};var _m=class{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return x.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Be(i.createTime)}}(t)),x.resolve()}getNamedQuery(e,t){return x.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(i){return{name:i.name,query:Vg(i.bundledQuery),readTime:Be(i.readTime)}}(t)),x.resolve()}};var vm=class{constructor(){this.overlays=new xe(B.comparator),this.Rr=new Map}getOverlay(e,t){return x.resolve(this.overlays.get(t))}getOverlays(e,t){let n=hn();return x.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,o)=>{this.Et(e,t,o)}),x.resolve()}removeOverlaysForBatchId(e,t,n){let i=this.Rr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Rr.delete(n)),x.resolve()}getOverlaysForCollection(e,t,n){let i=hn(),o=t.length+1,s=new B(t.child("")),c=this.overlays.getIteratorFrom(s);for(;c.hasNext();){let l=c.getNext().value,d=l.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&l.largestBatchId>n&&i.set(l.getKey(),l)}return x.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let o=new xe((d,f)=>d-f),s=this.overlays.getIterator();for(;s.hasNext();){let d=s.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>n){let f=o.get(d.largestBatchId);f===null&&(f=hn(),o=o.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}let c=hn(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,f)=>c.set(d,f)),!(c.size()>=i)););return x.resolve(c)}Et(e,t,n){let i=this.overlays.get(n.key);if(i!==null){let s=this.Rr.get(i.largestBatchId).delete(n.key);this.Rr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new La(t,n));let o=this.Rr.get(t);o===void 0&&(o=se(),this.Rr.set(t,o)),this.Rr.set(t,o.add(n.key))}};var wm=class{constructor(){this.sessionToken=qe.EMPTY_BYTE_STRING}getSessionToken(e){return x.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,x.resolve()}};var $a=class{constructor(){this.Vr=new be(Ke.mr),this.gr=new be(Ke.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){let n=new Ke(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.wr(new Ke(e,t))}Sr(e,t){e.forEach(n=>this.removeReference(n,t))}br(e){let t=new B(new de([])),n=new Ke(t,e),i=new Ke(t,e+1),o=[];return this.gr.forEachInRange([n,i],s=>{this.wr(s),o.push(s.key)}),o}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){let t=new B(new de([])),n=new Ke(t,e),i=new Ke(t,e+1),o=se();return this.gr.forEachInRange([n,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new Ke(e,0),n=this.Vr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}},Ke=class{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return B.comparator(e.key,t.key)||ie(e.Cr,t.Cr)}static pr(e,t){return ie(e.Cr,t.Cr)||B.comparator(e.key,t.key)}};var Em=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new be(Ke.mr)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){let o=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Fa(o,t,n,i);this.mutationQueue.push(s);for(let c of i)this.Mr=this.Mr.add(new Ke(c.key,o)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return x.resolve(s)}lookupMutationBatch(e,t){return x.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,i=this.Nr(n),o=i<0?0:i;return x.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?ur:this.Fr-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new Ke(t,0),i=new Ke(t,Number.POSITIVE_INFINITY),o=[];return this.Mr.forEachInRange([n,i],s=>{let c=this.Or(s.Cr);o.push(c)}),x.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new be(ie);return t.forEach(i=>{let o=new Ke(i,0),s=new Ke(i,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([o,s],c=>{n=n.add(c.Cr)})}),x.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,i=n.length+1,o=n;B.isDocumentKey(o)||(o=o.child(""));let s=new Ke(new B(o),0),c=new be(ie);return this.Mr.forEachWhile(l=>{let d=l.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(c=c.add(l.Cr)),!0)},s),x.resolve(this.Br(c))}Br(e){let t=[];return e.forEach(n=>{let i=this.Or(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){H(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Mr;return x.forEach(t.mutations,i=>{let o=new Ke(i.key,t.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Mr=n})}qn(e){}containsKey(e,t){let n=new Ke(t,0),i=this.Mr.firstAfterOrEqual(n);return x.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){let t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Cm=class{constructor(e){this.kr=e,this.docs=function(){return new xe(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,i=this.docs.get(n),o=i?i.size:0,s=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return x.resolve(n?n.document.mutableCopy():Qe.newInvalidDocument(t))}getEntries(e,t){let n=At();return t.forEach(i=>{let o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():Qe.newInvalidDocument(i))}),x.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let o=At(),s=t.path,c=new B(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){let{key:d,value:{document:f}}=l.getNext();if(!s.isPrefixOf(d.path))break;d.path.length>s.length+1||Cg(iC(f),n)<=0||(i.has(f.key)||nc(t,f))&&(o=o.insert(f.key,f.mutableCopy()))}return x.resolve(o)}getAllFromCollectionGroup(e,t,n,i){W()}qr(e,t){return x.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new bm(this)}getSize(e){return x.resolve(this.size)}},bm=class extends Vu{constructor(e){super(),this.Ir=e}applyChanges(e){let t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Ir.addEntry(e,i)):this.Ir.removeEntry(n)}),x.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}};var Im=class{constructor(e){this.persistence=e,this.Qr=new Xt(t=>ri(t),ec),this.lastRemoteSnapshotVersion=Y.min(),this.highestTargetId=0,this.$r=0,this.Kr=new $a,this.targetCount=0,this.Ur=Vo.Kn()}forEachTarget(e,t){return this.Qr.forEach((n,i)=>t(i)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Ur.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),x.resolve()}zn(e){this.Qr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Ur=new Vo(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,x.resolve()}updateTargetData(e,t){return this.zn(t),x.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Kr.br(t.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,t,n){let i=0,o=[];return this.Qr.forEach((s,c)=>{c.sequenceNumber<=t&&n.get(c.targetId)===null&&(this.Qr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),x.waitFor(o).next(()=>i)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,t){let n=this.Qr.get(t)||null;return x.resolve(n)}addMatchingKeys(e,t,n){return this.Kr.yr(t,n),x.resolve()}removeMatchingKeys(e,t,n){this.Kr.Sr(t,n);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),x.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Kr.br(t),x.resolve()}getMatchingKeysForTargetId(e,t){let n=this.Kr.vr(t);return x.resolve(n)}containsKey(e,t){return x.resolve(this.Kr.containsKey(t))}};var Ga=class{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new Vt(0),this.zr=!1,this.zr=!0,this.jr=new wm,this.referenceDelegate=e(this),this.Hr=new Im(this),this.indexManager=new lm,this.remoteDocumentCache=function(i){return new Cm(i)}(n=>this.referenceDelegate.Jr(n)),this.serializer=new Su(t),this.Yr=new _m(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new vm,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new Em(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){F("MemoryPersistence","Starting transaction:",e);let i=new Tm(this.Gr.next());return this.referenceDelegate.Zr(),n(i).next(o=>this.referenceDelegate.Xr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}ei(e,t){return x.or(Object.values(this.Wr).map(n=>()=>n.containsKey(e,t)))}},Tm=class extends uu{constructor(e){super(),this.currentSequenceNumber=e}},Fu=class r{constructor(e){this.persistence=e,this.ti=new $a,this.ni=null}static ri(e){return new r(e)}get ii(){if(this.ni)return this.ni;throw W()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),x.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),x.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),x.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach(i=>this.ii.add(i.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.ii.add(o.toString()))}).next(()=>n.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.ii,n=>{let i=B.fromPath(n);return this.si(e,i).next(o=>{o||t.removeEntry(i,Y.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(n=>{n?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return x.or([()=>x.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}},Lu=class r{constructor(e,t){this.persistence=e,this.oi=new Xt(n=>ht(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=mb(this,t)}static ri(e,t){return new r(e,t)}Zr(){}Xr(e){return x.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){let t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}rr(e,t){return x.forEach(this.oi,(n,i)=>this.ar(e,n,i).next(o=>o?x.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.qr(e,s=>this.ar(e,s,t).next(c=>{c||(n++,o.removeEntry(s,Y.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),x.resolve()}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),x.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),x.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),x.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=nu(e.data.value)),t}ar(e,t,n){return x.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.oi.get(t);return x.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Am=class{constructor(e){this.serializer=e}B(e,t,n,i){let o=new du("createOrUpgrade",t);n<1&&i>=1&&(function(l){l.createObjectStore(Za)}(e),function(l){l.createObjectStore(xa,{keyPath:y1}),l.createObjectStore(Ht,{keyPath:Hw,autoIncrement:!0}).createIndex(Xr,Qw,{unique:!0}),l.createObjectStore(Io)}(e),VE(e),function(l){l.createObjectStore(Wr)}(e));let s=x.resolve();return n<3&&i>=3&&(n!==0&&(function(l){l.deleteObjectStore(Ao),l.deleteObjectStore(To),l.deleteObjectStore(ei)}(e),VE(e)),s=s.next(()=>function(l){let d=l.store(ei),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Y.min().toTimestamp(),targetCount:0};return d.put(pu,f)}(o))),n<4&&i>=4&&(n!==0&&(s=s.next(()=>function(l,d){return d.store(Ht).G().next(p=>{l.deleteObjectStore(Ht),l.createObjectStore(Ht,{keyPath:Hw,autoIncrement:!0}).createIndex(Xr,Qw,{unique:!0});let g=d.store(Ht),b=p.map(V=>g.put(V));return x.waitFor(b)})}(e,o))),s=s.next(()=>{(function(l){l.createObjectStore(So,{keyPath:A1})})(e)})),n<5&&i>=5&&(s=s.next(()=>this._i(o))),n<6&&i>=6&&(s=s.next(()=>(function(l){l.createObjectStore(Ra)}(e),this.ai(o)))),n<7&&i>=7&&(s=s.next(()=>this.ui(o))),n<8&&i>=8&&(s=s.next(()=>this.ci(e,o))),n<9&&i>=9&&(s=s.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&i>=10&&(s=s.next(()=>this.li(o))),n<11&&i>=11&&(s=s.next(()=>{(function(l){l.createObjectStore(ud,{keyPath:S1})})(e),function(l){l.createObjectStore(dd,{keyPath:P1})}(e)})),n<12&&i>=12&&(s=s.next(()=>{(function(l){let d=l.createObjectStore(hd,{keyPath:V1});d.createIndex(xp,N1,{unique:!1}),d.createIndex(fC,F1,{unique:!1})})(e)})),n<13&&i>=13&&(s=s.next(()=>function(l){let d=l.createObjectStore(fu,{keyPath:v1});d.createIndex(eu,w1),d.createIndex(lC,E1)}(e)).next(()=>this.hi(e,o)).next(()=>e.deleteObjectStore(Wr))),n<14&&i>=14&&(s=s.next(()=>this.Pi(e,o))),n<15&&i>=15&&(s=s.next(()=>function(l){l.createObjectStore(Tg,{keyPath:x1,autoIncrement:!0}).createIndex(Pp,R1,{unique:!1}),l.createObjectStore(mu,{keyPath:M1}).createIndex(dC,D1,{unique:!1}),l.createObjectStore(gu,{keyPath:O1}).createIndex(hC,k1,{unique:!1})}(e))),n<16&&i>=16&&(s=s.next(()=>{t.objectStore(mu).clear()}).next(()=>{t.objectStore(gu).clear()})),n<17&&i>=17&&(s=s.next(()=>{(function(l){l.createObjectStore(Ag,{keyPath:L1})})(e)})),s}ai(e){let t=0;return e.store(Wr).Z((n,i)=>{t+=Du(i)}).next(()=>{let n={byteSize:t};return e.store(Ra).put(Sp,n)})}_i(e){let t=e.store(xa),n=e.store(Ht);return t.G().next(i=>x.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,ur],[o.userId,o.lastAcknowledgedBatchId]);return n.G(Xr,s).next(c=>x.forEach(c,l=>{H(l.userId===o.userId);let d=Hr(this.serializer,l);return hb(e,o.userId,d).next(()=>{})}))}))}ui(e){let t=e.store(Ao),n=e.store(Wr);return e.store(ei).get(pu).next(i=>{let o=[];return n.Z((s,c)=>{let l=new de(s),d=function(p){return[0,ht(p)]}(l);o.push(t.get(d).next(f=>f?x.resolve():(p=>t.put({targetId:0,path:ht(p),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>x.waitFor(o))})}ci(e,t){e.createObjectStore(Ma,{keyPath:T1});let n=t.store(Ma),i=new za,o=s=>{if(i.add(s)){let c=s.lastSegment(),l=s.popLast();return n.put({collectionId:c,parent:ht(l)})}};return t.store(Wr).Z({Y:!0},(s,c)=>{let l=new de(s);return o(l.popLast())}).next(()=>t.store(Io).Z({Y:!0},([s,c,l],d)=>{let f=dn(c);return o(f.popLast())}))}li(e){let t=e.store(To);return t.Z((n,i)=>{let o=wa(i),s=cb(this.serializer,o);return t.put(s)})}hi(e,t){let n=t.store(Wr),i=[];return n.Z((o,s)=>{let c=t.store(fu),l=function(p){return p.document?new B(de.fromString(p.document.name).popFirst(5)):p.noDocument?B.fromSegments(p.noDocument.path):p.unknownDocument?B.fromSegments(p.unknownDocument.path):W()}(s).path.toArray(),d={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(c.put(d))}).next(()=>x.waitFor(i))}Pi(e,t){let n=t.store(Ht),i=gb(this.serializer),o=new Ga(Fu.ri,this.serializer.Tt);return n.G().next(s=>{let c=new Map;return s.forEach(l=>{var d;let f=(d=c.get(l.userId))!==null&&d!==void 0?d:se();Hr(this.serializer,l).keys().forEach(p=>f=f.add(p)),c.set(l.userId,f)}),x.forEach(c,(l,d)=>{let f=new He(d),p=xu.It(this.serializer,f),g=o.getIndexManager(f),b=Ou.It(f,this.serializer,g,o.referenceDelegate);return new Nu(i,b,p,g).recalculateAndSaveOverlaysForDocumentKeys(new Da(t,Vt.ae),l).next()})})}};function VE(r){r.createObjectStore(Ao,{keyPath:b1}).createIndex(Ig,I1,{unique:!0}),r.createObjectStore(To,{keyPath:"targetId"}).createIndex(uC,C1,{unique:!0}),r.createObjectStore(ei)}var sr="IndexedDbPersistence",up=18e5,dp=5e3,hp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",yb="main",Sm=class r{constructor(e,t,n,i,o,s,c,l,d,f,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Ti=o,this.window=s,this.document=c,this.Ii=d,this.Ei=f,this.di=p,this.Gr=null,this.zr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ai=null,this.inForeground=!1,this.Ri=null,this.Vi=null,this.mi=Number.NEGATIVE_INFINITY,this.fi=g=>Promise.resolve(),!r.D())throw new N(M.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new pm(this,i),this.gi=t+yb,this.serializer=new Su(l),this.pi=new fr(this.gi,this.di,new Am(this.serializer)),this.jr=new nm,this.Hr=new dm(this.referenceDelegate,this.serializer),this.remoteDocumentCache=gb(this.serializer),this.Yr=new tm,this.window&&this.window.localStorage?this.yi=this.window.localStorage:(this.yi=null,f===!1&&Ue(sr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new N(M.FAILED_PRECONDITION,hp);return this.Si(),this.bi(),this.Di(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Hr.getHighestSequenceNumber(e))}).then(e=>{this.Gr=new Vt(e,this.Ii)}).then(()=>{this.zr=!0}).catch(e=>(this.pi&&this.pi.close(),Promise.reject(e)))}Ci(e){return this.fi=t=>k(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.pi.k(t=>k(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ti.enqueueAndForget(()=>k(this,null,function*(){this.started&&(yield this.wi())})))}wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Xl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Fi(e).next(t=>{t||(this.isPrimary=!1,this.Ti.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Mi(e)).next(t=>this.isPrimary&&!t?this.xi(e).next(()=>!1):!!t&&this.Oi(e).next(()=>!0))).catch(e=>{if(Ir(e))return F(sr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return F(sr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ti.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Fi(e){return _a(e).get(oo).next(t=>x.resolve(this.Ni(t)))}Bi(e){return Xl(e).delete(this.clientId)}Li(){return k(this,null,function*(){if(this.isPrimary&&!this.ki(this.mi,up)){this.mi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let n=Xe(t,So);return n.G().next(i=>{let o=this.qi(i,up),s=i.filter(c=>o.indexOf(c)===-1);return x.forEach(s,c=>n.delete(c.clientId)).next(()=>s)})}).catch(()=>[]);if(this.yi)for(let t of e)this.yi.removeItem(this.Qi(t.clientId))}})}Di(){this.Vi=this.Ti.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.wi().then(()=>this.Li()).then(()=>this.Di()))}Ni(e){return!!e&&e.ownerId===this.clientId}Mi(e){return this.Ei?x.resolve(!0):_a(e).get(oo).next(t=>{if(t!==null&&this.ki(t.leaseTimestampMs,dp)&&!this.$i(t.ownerId)){if(this.Ni(t)&&this.networkEnabled)return!0;if(!this.Ni(t)){if(!t.allowTabSynchronization)throw new N(M.FAILED_PRECONDITION,hp);return!1}}return!(!this.networkEnabled||!this.inForeground)||Xl(e).G().next(n=>this.qi(n,dp).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(o||s&&c)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&F(sr,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return k(this,null,function*(){this.zr=!1,this.Ki(),this.Vi&&(this.Vi.cancel(),this.Vi=null),this.Ui(),this.Wi(),yield this.pi.runTransaction("shutdown","readwrite",[Za,So],e=>{let t=new Da(e,Vt.ae);return this.xi(t).next(()=>this.Bi(t))}),this.pi.close(),this.Gi()})}qi(e,t){return e.filter(n=>this.ki(n.updateTimeMs,t)&&!this.$i(n.clientId))}zi(){return this.runTransaction("getActiveClients","readonly",e=>Xl(e).G().next(t=>this.qi(t,up).map(n=>n.clientId)))}get started(){return this.zr}getGlobalsCache(){return this.jr}getMutationQueue(e,t){return Ou.It(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new um(e,this.serializer.Tt.databaseId)}getDocumentOverlayCache(e){return xu.It(this.serializer,e)}getBundleCache(){return this.Yr}runTransaction(e,t,n){F(sr,"Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=function(l){return l===17?B1:l===16?j1:l===15?Sg:l===14?gC:l===13?mC:l===12?U1:l===11?pC:void W()}(this.di),s;return this.pi.runTransaction(e,i,o,c=>(s=new Da(c,this.Gr?this.Gr.next():Vt.ae),t==="readwrite-primary"?this.Fi(s).next(l=>!!l||this.Mi(s)).next(l=>{if(!l)throw Ue(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ti.enqueueRetryable(()=>this.fi(!1)),new N(M.FAILED_PRECONDITION,oC);return n(s)}).next(l=>this.Oi(s).next(()=>l)):this.ji(s).next(()=>n(s)))).then(c=>(s.raiseOnCommittedEvent(),c))}ji(e){return _a(e).get(oo).next(t=>{if(t!==null&&this.ki(t.leaseTimestampMs,dp)&&!this.$i(t.ownerId)&&!this.Ni(t)&&!(this.Ei||this.allowTabSynchronization&&t.allowTabSynchronization))throw new N(M.FAILED_PRECONDITION,hp)})}Oi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return _a(e).put(oo,t)}static D(){return fr.D()}xi(e){let t=_a(e);return t.get(oo).next(n=>this.Ni(n)?(F(sr,"Releasing primary lease."),t.delete(oo)):x.resolve())}ki(e,t){let n=Date.now();return!(e<n-t)&&(!(e>n)||(Ue(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Si(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ri=()=>{this.Ti.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.wi()))},this.document.addEventListener("visibilitychange",this.Ri),this.inForeground=this.document.visibilityState==="visible")}Ui(){this.Ri&&(this.document.removeEventListener("visibilitychange",this.Ri),this.Ri=null)}bi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ai=()=>{this.Ki();let t=/(?:Version|Mobile)\/1[456]/;Ah()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ti.enterRestrictedMode(!0),this.Ti.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ai))}Wi(){this.Ai&&(this.window.removeEventListener("pagehide",this.Ai),this.Ai=null)}$i(e){var t;try{let n=((t=this.yi)===null||t===void 0?void 0:t.getItem(this.Qi(e)))!==null;return F(sr,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Ue(sr,"Failed to get zombied client id.",n),!1}}Ki(){if(this.yi)try{this.yi.setItem(this.Qi(this.clientId),String(Date.now()))}catch(e){Ue("Failed to set zombie client id.",e)}}Gi(){if(this.yi)try{this.yi.removeItem(this.Qi(this.clientId))}catch{}}Qi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function _a(r){return Xe(r,Za)}function Xl(r){return Xe(r,So)}function Fg(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}var Pm=class r{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=i}static Yi(e,t){let n=se(),i=se();for(let o of t.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new r(e,t.fromCache,n,i)}};var xm=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Uu=class{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return Ah()?8:sC(Rs())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,i){let o={result:null};return this.rs(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ss(e,t,i,n).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new xm;return this._s(e,t,s).next(c=>{if(o.result=c,this.Xi)return this.us(e,t,s,c.size)})}).next(()=>o.result)}us(e,t,n,i){return n.documentReadCount<this.es?(ho()<=an.DEBUG&&F("QueryEngine","SDK will not create cache indexes for query:",fo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),x.resolve()):(ho()<=an.DEBUG&&F("QueryEngine","Query:",fo(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ts*i?(ho()<=an.DEBUG&&F("QueryEngine","The SDK decides to create cache indexes for query:",fo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yt(t))):x.resolve())}rs(e,t){if(aE(t))return x.resolve(null);let n=yt(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=bu(t,null,"F"),n=yt(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{let s=se(...o);return this.ns.getDocuments(e,s).next(c=>this.indexManager.getMinOffset(e,n).next(l=>{let d=this.cs(t,c);return this.ls(t,d,s,l.readTime)?this.rs(e,bu(t,null,"F")):this.hs(e,d,t,l)}))})))}ss(e,t,n,i){return aE(t)||i.isEqual(Y.min())?x.resolve(null):this.ns.getDocuments(e,n).next(o=>{let s=this.cs(t,o);return this.ls(t,s,n,i)?x.resolve(null):(ho()<=an.DEBUG&&F("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),fo(t)),this.hs(e,s,t,rC(i,Co)).next(c=>c))})}cs(e,t){let n=new be(VC(e));return t.forEach((i,o)=>{nc(e,o)&&(n=n.add(o))}),n}ls(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}_s(e,t,n){return ho()<=an.DEBUG&&F("QueryEngine","Using full collection scan to execute query:",fo(t)),this.ns.getDocumentsMatchingQuery(e,t,qt.min(),n)}hs(e,t,n,i){return this.ns.getDocumentsMatchingQuery(e,n,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var Lg="LocalStore",wR=3e8,Rm=class{constructor(e,t,n,i){this.persistence=e,this.Ps=t,this.serializer=i,this.Ts=new xe(ie),this.Is=new Xt(o=>ri(o),ec),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Nu(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}};function _b(r,e,t,n){return new Rm(r,e,t,n)}function vb(r,e){return k(this,null,function*(){let t=j(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,t.As(e),t.mutationQueue.getAllMutationBatches(n))).next(o=>{let s=[],c=[],l=se();for(let d of i){s.push(d.batchId);for(let f of d.mutations)l=l.add(f.key)}for(let d of o){c.push(d.batchId);for(let f of d.mutations)l=l.add(f.key)}return t.localDocuments.getDocuments(n,l).next(d=>({Rs:d,removedBatchIds:s,addedBatchIds:c}))})})})}function ER(r,e){let t=j(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{let i=e.batch.keys(),o=t.ds.newChangeBuffer({trackRemovals:!0});return function(c,l,d,f){let p=d.batch,g=p.keys(),b=x.resolve();return g.forEach(V=>{b=b.next(()=>f.getEntry(l,V)).next(O=>{let R=d.docVersions.get(V);H(R!==null),O.version.compareTo(R)<0&&(p.applyToRemoteDocument(O,d),O.isValidDocument()&&(O.setReadTime(d.commitVersion),f.addEntry(O)))})}),b.next(()=>c.mutationQueue.removeMutationBatch(l,p))}(t,n,e,o).next(()=>o.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let l=se();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(l=l.add(c.batch.mutations[d].key));return l}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function wb(r){let e=j(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function CR(r,e){let t=j(r),n=e.snapshotVersion,i=t.Ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.ds.newChangeBuffer({trackRemovals:!0});i=t.Ts;let c=[];e.targetChanges.forEach((f,p)=>{let g=i.get(p);if(!g)return;c.push(t.Hr.removeMatchingKeys(o,f.removedDocuments,p).next(()=>t.Hr.addMatchingKeys(o,f.addedDocuments,p)));let b=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?b=b.withResumeToken(qe.EMPTY_BYTE_STRING,Y.min()).withLastLimboFreeSnapshotVersion(Y.min()):f.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(f.resumeToken,n)),i=i.insert(p,b),function(O,R,K){return O.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=wR?!0:K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0}(g,b,f)&&c.push(t.Hr.updateTargetData(o,b))});let l=At(),d=se();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(o,f))}),c.push(Eb(o,s,e.documentUpdates).next(f=>{l=f.Vs,d=f.fs})),!n.isEqual(Y.min())){let f=t.Hr.getLastRemoteSnapshotVersion(o).next(p=>t.Hr.setTargetsMetadata(o,o.currentSequenceNumber,n));c.push(f)}return x.waitFor(c).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,l,d)).next(()=>l)}).then(o=>(t.Ts=i,o))}function Eb(r,e,t){let n=se(),i=se();return t.forEach(o=>n=n.add(o)),e.getEntries(r,n).next(o=>{let s=At();return t.forEach((c,l)=>{let d=o.get(c);l.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),l.isNoDocument()&&l.version.isEqual(Y.min())?(e.removeEntry(c,l.readTime),s=s.insert(c,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),s=s.insert(c,l)):F(Lg,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",l.version)}),{Vs:s,fs:i}})}function bR(r,e){let t=j(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=ur),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function No(r,e){let t=j(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Hr.getTargetData(n,e).next(o=>o?(i=o,x.resolve(i)):t.Hr.allocateTargetId(n).next(s=>(i=new ko(e,s,"TargetPurposeListen",n.currentSequenceNumber),t.Hr.addTargetData(n,i).next(()=>i))))}).then(n=>{let i=t.Ts.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ts=t.Ts.insert(n.targetId,n),t.Is.set(e,n.targetId)),n})}function Fo(r,e,t){return k(this,null,function*(){let n=j(r),i=n.Ts.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",o,s=>n.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!Ir(s))throw s;F(Lg,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ts=n.Ts.remove(e),n.Is.delete(i.target)})}function ju(r,e,t){let n=j(r),i=Y.min(),o=se();return n.persistence.runTransaction("Execute query","readwrite",s=>function(l,d,f){let p=j(l),g=p.Is.get(f);return g!==void 0?x.resolve(p.Ts.get(g)):p.Hr.getTargetData(d,f)}(n,s,yt(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Hr.getMatchingKeysForTargetId(s,c.targetId).next(l=>{o=l})}).next(()=>n.Ps.getDocumentsMatchingQuery(s,e,t?i:Y.min(),t?o:se())).next(c=>(Ib(n,kC(e),c),{documents:c,gs:o})))}function Cb(r,e){let t=j(r),n=j(t.Hr),i=t.Ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>n.lt(o,e).next(s=>s?s.target:null))}function bb(r,e){let t=j(r),n=t.Es.get(e)||Y.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ds.getAllFromCollectionGroup(i,e,rC(n,Co),Number.MAX_SAFE_INTEGER)).then(i=>(Ib(t,e,i),i))}function Ib(r,e,t){let n=r.Es.get(e)||Y.min();t.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),r.Es.set(e,n)}function IR(r,e,t,n){return k(this,null,function*(){let i=j(r),o=se(),s=At();for(let d of t){let f=e.ps(d.metadata.name);d.document&&(o=o.add(f));let p=e.ys(d);p.setReadTime(e.ws(d.metadata.readTime)),s=s.insert(f,p)}let c=i.ds.newChangeBuffer({trackRemovals:!0}),l=yield No(i,function(f){return yt(Go(de.fromString(`__bundle__/docs/${f}`)))}(n));return i.persistence.runTransaction("Apply bundle documents","readwrite",d=>Eb(d,c,s).next(f=>(c.apply(d),f)).next(f=>i.Hr.removeMatchingKeysForTargetId(d,l.targetId).next(()=>i.Hr.addMatchingKeys(d,o,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(d,f.Vs,f.fs)).next(()=>f.Vs)))})}function TR(n,i){return k(this,arguments,function*(r,e,t=se()){let o=yield No(r,yt(Vg(e.bundledQuery))),s=j(r);return s.persistence.runTransaction("Save named query","readwrite",c=>{let l=Be(e.readTime);if(o.snapshotVersion.compareTo(l)>=0)return s.Yr.saveNamedQuery(c,e);let d=o.withResumeToken(qe.EMPTY_BYTE_STRING,l);return s.Ts=s.Ts.insert(d.targetId,d),s.Hr.updateTargetData(c,d).next(()=>s.Hr.removeMatchingKeysForTargetId(c,o.targetId)).next(()=>s.Hr.addMatchingKeys(c,t,o.targetId)).next(()=>s.Yr.saveNamedQuery(c,e))})})}var Tb="firestore_clients";function NE(r,e){return`${Tb}_${r}_${e}`}var Ab="firestore_mutations";function FE(r,e,t){let n=`${Ab}_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}var Sb="firestore_targets";function fp(r,e){return`${Sb}_${r}_${e}`}var un="SharedClientState",Bu=class r{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static Ss(e,t,n){let i=JSON.parse(n),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new N(i.error.code,i.error.message))),s?new r(e,t,i.state,o):(Ue(un,`Failed to parse mutation state for ID '${t}': ${n}`),null)}bs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Ta=class r{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Ss(e,t){let n=JSON.parse(t),i,o=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return o&&n.error&&(o=typeof n.error.message=="string"&&typeof n.error.code=="string",o&&(i=new N(n.error.code,n.error.message))),o?new r(e,n.state,i):(Ue(un,`Failed to parse target state for ID '${e}': ${t}`),null)}bs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},qu=class r{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ss(e,t){let n=JSON.parse(t),i=typeof n=="object"&&n.activeTargetIds instanceof Array,o=Dg();for(let s=0;i&&s<n.activeTargetIds.length;++s)i=aC(n.activeTargetIds[s]),o=o.add(n.activeTargetIds[s]);return i?new r(e,o):(Ue(un,`Failed to parse client data for instance '${e}': ${t}`),null)}},Mm=class r{constructor(e,t){this.clientId=e,this.onlineState=t}static Ss(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new r(t.clientId,t.onlineState):(Ue(un,`Failed to parse online state: ${e}`),null)}},Wa=class{constructor(){this.activeTargetIds=Dg()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Aa=class{constructor(e,t,n,i,o){this.window=e,this.Ti=t,this.persistenceKey=n,this.Cs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Fs=this.Ms.bind(this),this.xs=new xe(ie),this.started=!1,this.Os=[];let s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ns=NE(this.persistenceKey,this.Cs),this.Bs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.xs=this.xs.insert(this.Cs,new Wa),this.Ls=new RegExp(`^${Tb}_${s}_([^_]*)$`),this.ks=new RegExp(`^${Ab}_${s}_(\\d+)(?:_(.*))?$`),this.qs=new RegExp(`^${Sb}_${s}_(\\d+)$`),this.Qs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.$s=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.Fs)}static D(e){return!(!e||!e.localStorage)}start(){return k(this,null,function*(){let e=yield this.syncEngine.zi();for(let n of e){if(n===this.Cs)continue;let i=this.getItem(NE(this.persistenceKey,n));if(i){let o=qu.Ss(n,i);o&&(this.xs=this.xs.insert(o.clientId,o))}}this.Ks();let t=this.storage.getItem(this.Qs);if(t){let n=this.Us(t);n&&this.Ws(n)}for(let n of this.Os)this.Ms(n);this.Os=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Bs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Gs(this.xs)}isActiveQueryTarget(e){let t=!1;return this.xs.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.zs(e,"pending")}updateMutationState(e,t,n){this.zs(e,t,n),this.js(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(fp(this.persistenceKey,e));if(i){let o=Ta.Ss(e,i);o&&(n=o.state)}}return t&&this.Hs.Ds(e),this.Ks(),n}removeLocalQueryTarget(e){this.Hs.vs(e),this.Ks()}isLocalQueryTarget(e){return this.Hs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(fp(this.persistenceKey,e))}updateQueryState(e,t,n){this.Js(e,t,n)}handleUserChange(e,t,n){t.forEach(i=>{this.js(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Ys(e)}notifyBundleLoaded(e){this.Zs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Fs),this.removeItem(this.Ns),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return F(un,"READ",e,t),t}setItem(e,t){F(un,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){F(un,"REMOVE",e),this.storage.removeItem(e)}Ms(e){let t=e;if(t.storageArea===this.storage){if(F(un,"EVENT",t.key,t.newValue),t.key===this.Ns)return void Ue("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ti.enqueueRetryable(()=>k(this,null,function*(){if(this.started){if(t.key!==null){if(this.Ls.test(t.key)){if(t.newValue==null){let n=this.Xs(t.key);return this.eo(n,null)}{let n=this.no(t.key,t.newValue);if(n)return this.eo(n.clientId,n)}}else if(this.ks.test(t.key)){if(t.newValue!==null){let n=this.ro(t.key,t.newValue);if(n)return this.io(n)}}else if(this.qs.test(t.key)){if(t.newValue!==null){let n=this.so(t.key,t.newValue);if(n)return this.oo(n)}}else if(t.key===this.Qs){if(t.newValue!==null){let n=this.Us(t.newValue);if(n)return this.Ws(n)}}else if(t.key===this.Bs){let n=function(o){let s=Vt.ae;if(o!=null)try{let c=JSON.parse(o);H(typeof c=="number"),s=c}catch(c){Ue(un,"Failed to read sequence number from WebStorage",c)}return s}(t.newValue);n!==Vt.ae&&this.sequenceNumberHandler(n)}else if(t.key===this.$s){let n=this._o(t.newValue);yield Promise.all(n.map(i=>this.syncEngine.ao(i)))}}}else this.Os.push(t)}))}}get Hs(){return this.xs.get(this.Cs)}Ks(){this.setItem(this.Ns,this.Hs.bs())}zs(e,t,n){let i=new Bu(this.currentUser,e,t,n),o=FE(this.persistenceKey,this.currentUser,e);this.setItem(o,i.bs())}js(e){let t=FE(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ys(e){let t={clientId:this.Cs,onlineState:e};this.storage.setItem(this.Qs,JSON.stringify(t))}Js(e,t,n){let i=fp(this.persistenceKey,e),o=new Ta(e,t,n);this.setItem(i,o.bs())}Zs(e){let t=JSON.stringify(Array.from(e));this.setItem(this.$s,t)}Xs(e){let t=this.Ls.exec(e);return t?t[1]:null}no(e,t){let n=this.Xs(e);return qu.Ss(n,t)}ro(e,t){let n=this.ks.exec(e),i=Number(n[1]),o=n[2]!==void 0?n[2]:null;return Bu.Ss(new He(o),i,t)}so(e,t){let n=this.qs.exec(e),i=Number(n[1]);return Ta.Ss(i,t)}Us(e){return Mm.Ss(e)}_o(e){return JSON.parse(e)}io(e){return k(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.uo(e.batchId,e.state,e.error);F(un,`Ignoring mutation for non-active user ${e.user.uid}`)})}oo(e){return this.syncEngine.co(e.targetId,e.state,e.error)}eo(e,t){let n=t?this.xs.insert(e,t):this.xs.remove(e),i=this.Gs(this.xs),o=this.Gs(n),s=[],c=[];return o.forEach(l=>{i.has(l)||s.push(l)}),i.forEach(l=>{o.has(l)||c.push(l)}),this.syncEngine.lo(s,c).then(()=>{this.xs=n})}Ws(e){this.xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Gs(e){let t=Dg();return e.forEach((n,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},zu=class{constructor(){this.ho=new Wa,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new Wa,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Dm=class{To(e){}shutdown(){}};var LE="ConnectivityMonitor",$u=class{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){F(LE,"Network connectivity changed: AVAILABLE");for(let e of this.Vo)e(0)}Ro(){F(LE,"Network connectivity changed: UNAVAILABLE");for(let e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Jl=null;function Om(){return Jl===null?Jl=function(){return 268435456+Math.round(2147483648*Math.random())}():Jl++,"0x"+Jl.toString(16)}var pp="RestConnection",AR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},km=class{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${i}`,this.wo=this.databaseId.database===Mp?`project_id=${n}`:`project_id=${n}&database_id=${i}`}So(e,t,n,i,o){let s=Om(),c=this.bo(e,t.toUriEncodedString());F(pp,`Sending RPC '${e}' ${s}:`,c,n);let l={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(l,i,o),this.vo(e,c,l,n).then(d=>(F(pp,`Received RPC '${e}' ${s}: `,d),d),d=>{throw Qt(pp,`RPC '${e}' ${s} failed with error: `,d,"url: ",c,"request:",n),d})}Co(e,t,n,i,o,s){return this.So(e,t,n,i,o)}Do(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+$o}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}bo(e,t){let n=AR[e];return`${this.po}/v1/${t}:${n}`}terminate(){}};var Vm=class{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Ko(e){this.ko(e)}Uo(e){this.qo(e)}};var ut="WebChannelConnection",Nm=class extends km{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,i){let o=Om();return new Promise((s,c)=>{let l=new ip;l.setWithCredentials(!0),l.listenOnce(op.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case pa.NO_ERROR:let f=l.getResponseJson();F(ut,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),s(f);break;case pa.TIMEOUT:F(ut,`RPC '${e}' ${o} timed out`),c(new N(M.DEADLINE_EXCEEDED,"Request time out"));break;case pa.HTTP_ERROR:let p=l.getStatus();if(F(ut,`RPC '${e}' ${o} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);let b=g?.error;if(b&&b.status&&b.message){let V=function(R){let K=R.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(K)>=0?K:M.UNKNOWN}(b.status);c(new N(V,b.message))}else c(new N(M.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new N(M.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{F(ut,`RPC '${e}' ${o} completed.`)}});let d=JSON.stringify(i);F(ut,`RPC '${e}' ${o} sending request:`,i),l.send(t,"POST",d,n,15)})}Wo(e,t,n){let i=Om(),o=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=cp(),c=ap(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Do(l.initMessageHeaders,t,n),l.encodeInitMessageHeaders=!0;let f=o.join("");F(ut,`Creating RPC '${e}' stream ${i}: ${f}`,l);let p=s.createWebChannel(f,l),g=!1,b=!1,V=new Vm({Fo:R=>{b?F(ut,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(g||(F(ut,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),F(ut,`RPC '${e}' stream ${i} sending:`,R),p.send(R))},Mo:()=>p.close()}),O=(R,K,Q)=>{R.listen(K,L=>{try{Q(L)}catch(J){setTimeout(()=>{throw J},0)}})};return O(p,io.EventType.OPEN,()=>{b||(F(ut,`RPC '${e}' stream ${i} transport opened.`),V.Qo())}),O(p,io.EventType.CLOSE,()=>{b||(b=!0,F(ut,`RPC '${e}' stream ${i} transport closed`),V.Ko())}),O(p,io.EventType.ERROR,R=>{b||(b=!0,Qt(ut,`RPC '${e}' stream ${i} transport errored:`,R),V.Ko(new N(M.UNAVAILABLE,"The operation could not be completed")))}),O(p,io.EventType.MESSAGE,R=>{var K;if(!b){let Q=R.data[0];H(!!Q);let L=Q,J=L?.error||((K=L[0])===null||K===void 0?void 0:K.error);if(J){F(ut,`RPC '${e}' stream ${i} received error:`,J);let ne=J.status,re=function(C){let T=We[C];if(T!==void 0)return HC(T)}(ne),I=J.message;re===void 0&&(re=M.INTERNAL,I="Unknown error status: "+ne+" with message "+J.message),b=!0,V.Ko(new N(re,I)),p.close()}else F(ut,`RPC '${e}' stream ${i} received:`,Q),V.Uo(Q)}}),O(c,sp.STAT_EVENT,R=>{R.stat===Kl.PROXY?F(ut,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Kl.NOPROXY&&F(ut,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{V.$o()},0),V}};function Pb(){return typeof window<"u"?window:null}function ou(){return typeof document<"u"?document:null}function rc(r){return new Yp(r,!0)}var Ka=class{constructor(e,t,n=1e3,i=1.5,o=6e4){this.Ti=e,this.timerId=t,this.Go=n,this.zo=i,this.jo=o,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();let t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),i=Math.max(0,t-n);i>0&&F("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}};var UE="PersistentStream",Gu=class{constructor(e,t,n,i,o,s,c,l){this.Ti=e,this.n_=n,this.r_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new Ka(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}stop(){return k(this,null,function*(){this.u_()&&(yield this.close(0))})}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}T_(){return k(this,null,function*(){if(this.c_())return this.close(0)})}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}close(e,t){return k(this,null,function*(){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===M.RESOURCE_EXHAUSTED?(Ue(t.toString()),Ue("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===M.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Lo(t)})}A_(){}auth(){this.state=1;let e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.i_===t&&this.V_(n,i)},n=>{e(()=>{let i=new N(M.UNKNOWN,"Fetching auth token failed: "+n.message);return this.m_(i)})})}V_(e,t){let n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{n(()=>this.listener.xo())}),this.stream.No(()=>{n(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(i=>{n(()=>this.m_(i))}),this.stream.onMessage(i=>{n(()=>++this.__==1?this.g_(i):this.onNext(i))})}l_(){this.state=5,this.a_.Xo(()=>k(this,null,function*(){this.state=0,this.start()}))}m_(e){return F(UE,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(F(UE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Fm=class extends Gu{constructor(e,t,n,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,s),this.serializer=o}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();let t=lR(this.serializer,e),n=function(o){if(!("targetChange"in o))return Y.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?Y.min():s.readTime?Be(s.readTime):Y.min()}(e);return this.listener.p_(t,n)}y_(e){let t={};t.database=Zp(this.serializer),t.addTarget=function(o,s){let c,l=s.target;if(c=Eu(l)?{documents:nb(o,l)}:{query:rb(o,l).ht},c.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){c.resumeToken=YC(o,s.resumeToken);let d=Xp(o,s.expectedCount);d!==null&&(c.expectedCount=d)}else if(s.snapshotVersion.compareTo(Y.min())>0){c.readTime=Oo(o,s.snapshotVersion.toTimestamp());let d=Xp(o,s.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);let n=dR(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){let t={};t.database=Zp(this.serializer),t.removeTarget=e,this.I_(t)}},Lm=class extends Gu{constructor(e,t,n,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,s),this.serializer=o}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return H(!!e.streamToken),this.lastStreamToken=e.streamToken,H(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){H(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();let t=uR(e.writeResults,e.commitTime),n=Be(e.commitTime);return this.listener.v_(n,t)}C_(){let e={};e.database=Zp(this.serializer),this.I_(e)}b_(e){let t={streamToken:this.lastStreamToken,writes:e.map(n=>qa(this.serializer,n))};this.I_(t)}};var Um=class{},jm=class extends Um{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.F_=!1}M_(){if(this.F_)throw new N(M.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.So(e,Jp(t,n),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new N(M.UNKNOWN,o.toString())})}Co(e,t,n,i,o){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,c])=>this.connection.Co(e,Jp(t,n),i,s,c,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new N(M.UNKNOWN,s.toString())})}terminate(){this.F_=!0,this.connection.terminate()}},Bm=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(Ue(t),this.N_=!1):F("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}};var ai="RemoteStore",qm=class{constructor(e,t,n,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.K_=[],this.U_=new Map,this.W_=new Set,this.G_=[],this.z_=o,this.z_.To(s=>{n.enqueueAndForget(()=>k(this,null,function*(){Ar(this)&&(F(ai,"Restarting streams for network reachability change."),yield function(l){return k(this,null,function*(){let d=j(l);d.W_.add(4),yield Wo(d),d.j_.set("Unknown"),d.W_.delete(4),yield ic(d)})}(this))}))}),this.j_=new Bm(n,i)}};function ic(r){return k(this,null,function*(){if(Ar(r))for(let e of r.G_)yield e(!0)})}function Wo(r){return k(this,null,function*(){for(let e of r.G_)yield e(!1)})}function gd(r,e){let t=j(r);t.U_.has(e.targetId)||(t.U_.set(e.targetId,e),Bg(t)?jg(t):Ho(t).c_()&&Ug(t,e))}function Lo(r,e){let t=j(r),n=Ho(t);t.U_.delete(e),n.c_()&&xb(t,e),t.U_.size===0&&(n.c_()?n.P_():Ar(t)&&t.j_.set("Unknown"))}function Ug(r,e){if(r.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Y.min())>0){let t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ho(r).y_(e)}function xb(r,e){r.H_.Ne(e),Ho(r).w_(e)}function jg(r){r.H_=new Qp({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>r.U_.get(e)||null,it:()=>r.datastore.serializer.databaseId}),Ho(r).start(),r.j_.B_()}function Bg(r){return Ar(r)&&!Ho(r).u_()&&r.U_.size>0}function Ar(r){return j(r).W_.size===0}function Rb(r){r.H_=void 0}function SR(r){return k(this,null,function*(){r.j_.set("Online")})}function PR(r){return k(this,null,function*(){r.U_.forEach((e,t)=>{Ug(r,e)})})}function xR(r,e){return k(this,null,function*(){Rb(r),Bg(r)?(r.j_.q_(e),jg(r)):r.j_.set("Unknown")})}function RR(r,e,t){return k(this,null,function*(){if(r.j_.set("Online"),e instanceof Tu&&e.state===2&&e.cause)try{yield function(i,o){return k(this,null,function*(){let s=o.cause;for(let c of o.targetIds)i.U_.has(c)&&(yield i.remoteSyncer.rejectListen(c,s),i.U_.delete(c),i.H_.removeTarget(c))})}(r,e)}catch(n){F(ai,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield Wu(r,n)}else if(e instanceof wo?r.H_.We(e):e instanceof Iu?r.H_.Ze(e):r.H_.je(e),!t.isEqual(Y.min()))try{let n=yield wb(r.localStore);t.compareTo(n)>=0&&(yield function(o,s){let c=o.H_.ot(s);return c.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){let f=o.U_.get(d);f&&o.U_.set(d,f.withResumeToken(l.resumeToken,s))}}),c.targetMismatches.forEach((l,d)=>{let f=o.U_.get(l);if(!f)return;o.U_.set(l,f.withResumeToken(qe.EMPTY_BYTE_STRING,f.snapshotVersion)),xb(o,l);let p=new ko(f.target,l,d,f.sequenceNumber);Ug(o,p)}),o.remoteSyncer.applyRemoteEvent(c)}(r,t))}catch(n){F(ai,"Failed to raise snapshot:",n),yield Wu(r,n)}})}function Wu(r,e,t){return k(this,null,function*(){if(!Ir(e))throw e;r.W_.add(1),yield Wo(r),r.j_.set("Offline"),t||(t=()=>wb(r.localStore)),r.asyncQueue.enqueueRetryable(()=>k(this,null,function*(){F(ai,"Retrying IndexedDB access"),yield t(),r.W_.delete(1),yield ic(r)}))})}function Mb(r,e){return e().catch(t=>Wu(r,t,e))}function Ko(r){return k(this,null,function*(){let e=j(r),t=Er(e),n=e.K_.length>0?e.K_[e.K_.length-1].batchId:ur;for(;MR(e);)try{let i=yield bR(e.localStore,n);if(i===null){e.K_.length===0&&t.P_();break}n=i.batchId,DR(e,i)}catch(i){yield Wu(e,i)}Db(e)&&Ob(e)})}function MR(r){return Ar(r)&&r.K_.length<10}function DR(r,e){r.K_.push(e);let t=Er(r);t.c_()&&t.S_&&t.b_(e.mutations)}function Db(r){return Ar(r)&&!Er(r).u_()&&r.K_.length>0}function Ob(r){Er(r).start()}function OR(r){return k(this,null,function*(){Er(r).C_()})}function kR(r){return k(this,null,function*(){let e=Er(r);for(let t of r.K_)e.b_(t.mutations)})}function VR(r,e,t){return k(this,null,function*(){let n=r.K_.shift(),i=Wp.from(n,e,t);yield Mb(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield Ko(r)})}function NR(r,e){return k(this,null,function*(){e&&Er(r).S_&&(yield function(n,i){return k(this,null,function*(){if(function(s){return KC(s)&&s!==M.ABORTED}(i.code)){let o=n.K_.shift();Er(n).h_(),yield Mb(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Ko(n)}})}(r,e)),Db(r)&&Ob(r)})}function jE(r,e){return k(this,null,function*(){let t=j(r);t.asyncQueue.verifyOperationInProgress(),F(ai,"RemoteStore received new credentials");let n=Ar(t);t.W_.add(3),yield Wo(t),n&&t.j_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),yield ic(t)})}function zm(r,e){return k(this,null,function*(){let t=j(r);e?(t.W_.delete(2),yield ic(t)):e||(t.W_.add(2),yield Wo(t),t.j_.set("Unknown"))})}function Ho(r){return r.J_||(r.J_=function(t,n,i){let o=j(t);return o.M_(),new Fm(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(r.datastore,r.asyncQueue,{xo:SR.bind(null,r),No:PR.bind(null,r),Lo:xR.bind(null,r),p_:RR.bind(null,r)}),r.G_.push(e=>k(this,null,function*(){e?(r.J_.h_(),Bg(r)?jg(r):r.j_.set("Unknown")):(yield r.J_.stop(),Rb(r))}))),r.J_}function Er(r){return r.Y_||(r.Y_=function(t,n,i){let o=j(t);return o.M_(),new Lm(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(r.datastore,r.asyncQueue,{xo:()=>Promise.resolve(),No:OR.bind(null,r),Lo:NR.bind(null,r),D_:kR.bind(null,r),v_:VR.bind(null,r)}),r.G_.push(e=>k(this,null,function*(){e?(r.Y_.h_(),yield Ko(r)):(yield r.Y_.stop(),r.K_.length>0&&(F(ai,`Stopping write stream with ${r.K_.length} pending writes`),r.K_=[]))}))),r.Y_}var $m=class r{constructor(e,t,n,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Ye,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,o){let s=Date.now()+n,c=new r(e,t,s,i,o);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new N(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Qo(r,e){if(Ue("AsyncQueue",`${e}: ${r}`),Ir(r))return new N(M.UNAVAILABLE,`${e}: ${r}`);throw r}var Ku=class r{static emptySet(e){return new r(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||B.comparator(t.key,n.key):(t,n)=>B.comparator(t.key,n.key),this.keyedMap=va(),this.sortedSet=new xe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof r)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let n=new r;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}};var Hu=class{constructor(){this.Z_=new xe(B.comparator)}track(e){let t=e.doc.key,n=this.Z_.get(t);n?e.type!==0&&n.type===3?this.Z_=this.Z_.insert(t,e):e.type===3&&n.type!==1?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.Z_=this.Z_.remove(t):e.type===1&&n.type===2?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):W():this.Z_=this.Z_.insert(t,e)}X_(){let e=[];return this.Z_.inorderTraversal((t,n)=>{e.push(n)}),e}},Uo=class r{constructor(e,t,n,i,o,s,c,l,d){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,t,n,i,o){let s=[];return t.forEach(c=>{s.push({type:0,doc:c})}),new r(e,t,Ku.emptySet(t),s,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&tc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}};var Gm=class{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}},Wm=class{constructor(){this.queries=BE(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,n){let i=j(t),o=i.queries;i.queries=BE(),o.forEach((s,c)=>{for(let l of c.ta)l.onError(n)})})(this,new N(M.ABORTED,"Firestore shutting down"))}};function BE(){return new Xt(r=>OC(r),tc)}function qg(r,e){return k(this,null,function*(){let t=j(r),n=3,i=e.query,o=t.queries.get(i);o?!o.na()&&e.ra()&&(n=2):(o=new Gm,n=e.ra()?0:1);try{switch(n){case 0:o.ea=yield t.onListen(i,!0);break;case 1:o.ea=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let c=Qo(s,`Initialization of query '${fo(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,o),o.ta.push(e),e.sa(t.onlineState),o.ea&&e.oa(o.ea)&&$g(t)})}function zg(r,e){return k(this,null,function*(){let t=j(r),n=e.query,i=3,o=t.queries.get(n);if(o){let s=o.ta.indexOf(e);s>=0&&(o.ta.splice(s,1),o.ta.length===0?i=e.ra()?0:1:!o.na()&&e.ra()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}})}function FR(r,e){let t=j(r),n=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let c of s.ta)c.oa(i)&&(n=!0);s.ea=i}}n&&$g(t)}function LR(r,e,t){let n=j(r),i=n.queries.get(e);if(i)for(let o of i.ta)o.onError(t);n.queries.delete(e)}function $g(r){r.ia.forEach(e=>{e.next()})}var Km,qE;(qE=Km||(Km={}))._a="default",qE.Cache="cache";var Ha=class{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){let n=[];for(let i of e.docChanges)i.type!==3&&n.push(i);e=new Uo(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache||!this.ra())return!0;let n=t!=="Offline";return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}la(e){if(e.docChanges.length>0)return!0;let t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Pa(e){e=Uo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==Km.Cache}};var Hm=class{constructor(e,t){this.Ia=e,this.byteLength=t}Ea(){return"metadata"in this.Ia}};var Qu=class{constructor(e){this.serializer=e}ps(e){return pn(this.serializer,e)}ys(e){return e.metadata.exists?tb(this.serializer,e.document,!1):Qe.newNoDocument(this.ps(e.metadata.name),this.ws(e.metadata.readTime))}ws(e){return Be(e)}},Qm=class{constructor(e,t,n){this.da=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=kb(e)}Aa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Ia.namedQuery)this.queries.push(e.Ia.namedQuery);else if(e.Ia.documentMetadata){this.documents.push({metadata:e.Ia.documentMetadata}),e.Ia.documentMetadata.exists||++t;let n=de.fromString(e.Ia.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Ia.document&&(this.documents[this.documents.length-1].document=e.Ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ra(e){let t=new Map,n=new Qu(this.serializer);for(let i of e)if(i.metadata.queries){let o=n.ps(i.metadata.name);for(let s of i.metadata.queries){let c=(t.get(s)||se()).add(o);t.set(s,c)}}return t}complete(){return k(this,null,function*(){let e=yield IR(this.localStore,new Qu(this.serializer),this.documents,this.da.id),t=this.Ra(this.documents);for(let n of this.queries)yield TR(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,Va:this.collectionGroups,ma:e}})}};function kb(r){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:r.totalDocuments,totalBytes:r.totalBytes}}var Yu=class{constructor(e){this.key=e}},Xu=class{constructor(e){this.key=e}},Ju=class{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=se(),this.mutatedKeys=se(),this.ya=VC(e),this.wa=new Ku(this.ya)}get Sa(){return this.fa}ba(e,t){let n=t?t.Da:new Hu,i=t?t.wa:this.wa,o=t?t.mutatedKeys:this.mutatedKeys,s=i,c=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{let g=i.get(f),b=nc(this.query,p)?p:null,V=!!g&&this.mutatedKeys.has(g.key),O=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations),R=!1;g&&b?g.data.isEqual(b.data)?V!==O&&(n.track({type:3,doc:b}),R=!0):this.va(g,b)||(n.track({type:2,doc:b}),R=!0,(l&&this.ya(b,l)>0||d&&this.ya(b,d)<0)&&(c=!0)):!g&&b?(n.track({type:0,doc:b}),R=!0):g&&!b&&(n.track({type:1,doc:g}),R=!0,(l||d)&&(c=!0)),R&&(b?(s=s.add(b),o=O?o.add(f):o.delete(f)):(s=s.delete(f),o=o.delete(f)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let f=this.query.limitType==="F"?s.last():s.first();s=s.delete(f.key),o=o.delete(f.key),n.track({type:1,doc:f})}return{wa:s,Da:n,ls:c,mutatedKeys:o}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){let o=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;let s=e.Da.X_();s.sort((f,p)=>function(b,V){let O=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W()}};return O(b)-O(V)}(f.type,p.type)||this.ya(f.doc,p.doc)),this.Ca(n),i=i!=null&&i;let c=t&&!i?this.Fa():[],l=this.pa.size===0&&this.current&&!i?1:0,d=l!==this.ga;return this.ga=l,s.length!==0||d?{snapshot:new Uo(this.query,e.wa,o,s,e.mutatedKeys,l===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:c}:{Ma:c}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new Hu,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(t=>this.fa=this.fa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.fa=this.fa.delete(t)),this.current=e.current)}Fa(){if(!this.current)return[];let e=this.pa;this.pa=se(),this.wa.forEach(n=>{this.xa(n.key)&&(this.pa=this.pa.add(n.key))});let t=[];return e.forEach(n=>{this.pa.has(n)||t.push(new Xu(n))}),this.pa.forEach(n=>{e.has(n)||t.push(new Yu(n))}),t}Oa(e){this.fa=e.gs,this.pa=se();let t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return Uo.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}},Sr="SyncEngine",Ym=class{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}},Xm=class{constructor(e){this.key=e,this.Ba=!1}},Jm=class{constructor(e,t,n,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.La={},this.ka=new Xt(c=>OC(c),tc),this.qa=new Map,this.Qa=new Set,this.$a=new xe(B.comparator),this.Ka=new Map,this.Ua=new $a,this.Wa={},this.Ga=new Map,this.za=Vo.Un(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}};function UR(r,e,t=!0){return k(this,null,function*(){let n=yd(r),i,o=n.ka.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Na()):i=yield Vb(n,e,t,!0),i})}function jR(r,e){return k(this,null,function*(){let t=yd(r);yield Vb(t,e,!0,!1)})}function Vb(r,e,t,n){return k(this,null,function*(){let i=yield No(r.localStore,yt(e)),o=i.targetId,s=r.sharedClientState.addLocalQueryTarget(o,t),c;return n&&(c=yield Gg(r,e,o,s==="current",i.resumeToken)),r.isPrimaryClient&&t&&gd(r.remoteStore,i),c})}function Gg(r,e,t,n,i){return k(this,null,function*(){r.Ha=(p,g,b)=>function(O,R,K,Q){return k(this,null,function*(){let L=R.view.ba(K);L.ls&&(L=yield ju(O.localStore,R.query,!1).then(({documents:I})=>R.view.ba(I,L)));let J=Q&&Q.targetChanges.get(R.targetId),ne=Q&&Q.targetMismatches.get(R.targetId)!=null,re=R.view.applyChanges(L,O.isPrimaryClient,J,ne);return Zm(O,R.targetId,re.Ma),re.snapshot})}(r,p,g,b);let o=yield ju(r.localStore,e,!0),s=new Ju(e,o.gs),c=s.ba(o.documents),l=ja.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),d=s.applyChanges(c,r.isPrimaryClient,l);Zm(r,t,d.Ma);let f=new Ym(e,t,s);return r.ka.set(e,f),r.qa.has(t)?r.qa.get(t).push(e):r.qa.set(t,[e]),d.snapshot})}function BR(r,e,t){return k(this,null,function*(){let n=j(r),i=n.ka.get(e),o=n.qa.get(i.targetId);if(o.length>1)return n.qa.set(i.targetId,o.filter(s=>!tc(s,e))),void n.ka.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Fo(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&Lo(n.remoteStore,i.targetId),jo(n,i.targetId)}).catch(br))):(jo(n,i.targetId),yield Fo(n.localStore,i.targetId,!0))})}function qR(r,e){return k(this,null,function*(){let t=j(r),n=t.ka.get(e),i=t.qa.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Lo(t.remoteStore,n.targetId))})}function zR(r,e,t){return k(this,null,function*(){let n=Qg(r);try{let i=yield function(s,c){let l=j(s),d=Oe.now(),f=c.reduce((b,V)=>b.add(V.key),se()),p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",b=>{let V=At(),O=se();return l.ds.getEntries(b,f).next(R=>{V=R,V.forEach((K,Q)=>{Q.isValidDocument()||(O=O.add(K))})}).next(()=>l.localDocuments.getOverlayedDocuments(b,V)).next(R=>{p=R;let K=[];for(let Q of c){let L=nR(Q,p.get(Q.key).overlayedDocument);L!=null&&K.push(new Jt(Q.key,L,AC(L.value.mapValue),Fe.exists(!0)))}return l.mutationQueue.addMutationBatch(b,d,K,c)}).next(R=>{g=R;let K=R.applyToLocalDocumentSet(p,O);return l.documentOverlayCache.saveOverlays(b,R.batchId,K)})}).then(()=>({batchId:g.batchId,changes:FC(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,c,l){let d=s.Wa[s.currentUser.toKey()];d||(d=new xe(ie)),d=d.insert(c,l),s.Wa[s.currentUser.toKey()]=d}(n,i.batchId,t),yield qn(n,i.changes),yield Ko(n.remoteStore)}catch(i){let o=Qo(i,"Failed to persist write");t.reject(o)}})}function Nb(r,e){return k(this,null,function*(){let t=j(r);try{let n=yield CR(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Ka.get(o);s&&(H(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.Ba=!0:i.modifiedDocuments.size>0?H(s.Ba):i.removedDocuments.size>0&&(H(s.Ba),s.Ba=!1))}),yield qn(t,n,e)}catch(n){yield br(n)}})}function zE(r,e,t){let n=j(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){let i=[];n.ka.forEach((o,s)=>{let c=s.view.sa(e);c.snapshot&&i.push(c.snapshot)}),function(s,c){let l=j(s);l.onlineState=c;let d=!1;l.queries.forEach((f,p)=>{for(let g of p.ta)g.sa(c)&&(d=!0)}),d&&$g(l)}(n.eventManager,e),i.length&&n.La.p_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function $R(r,e,t){return k(this,null,function*(){let n=j(r);n.sharedClientState.updateQueryState(e,"rejected",t);let i=n.Ka.get(e),o=i&&i.key;if(o){let s=new xe(B.comparator);s=s.insert(o,Qe.newNoDocument(o,Y.min()));let c=se().add(o),l=new Ua(Y.min(),new Map,new xe(ie),s,c);yield Nb(n,l),n.$a=n.$a.remove(o),n.Ka.delete(e),Hg(n)}else yield Fo(n.localStore,e,!1).then(()=>jo(n,e,t)).catch(br)})}function GR(r,e){return k(this,null,function*(){let t=j(r),n=e.batch.batchId;try{let i=yield ER(t.localStore,e);Kg(t,n,null),Wg(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield qn(t,i)}catch(i){yield br(i)}})}function WR(r,e,t){return k(this,null,function*(){let n=j(r);try{let i=yield function(s,c){let l=j(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return l.mutationQueue.lookupMutationBatch(d,c).next(p=>(H(p!==null),f=p.keys(),l.mutationQueue.removeMutationBatch(d,p))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,f,c)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>l.localDocuments.getDocuments(d,f))})}(n.localStore,e);Kg(n,e,t),Wg(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield qn(n,i)}catch(i){yield br(i)}})}function KR(r,e){return k(this,null,function*(){let t=j(r);Ar(t.remoteStore)||F(Sr,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let n=yield function(s){let c=j(s);return c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>c.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(n===ur)return void e.resolve();let i=t.Ga.get(n)||[];i.push(e),t.Ga.set(n,i)}catch(n){let i=Qo(n,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function Wg(r,e){(r.Ga.get(e)||[]).forEach(t=>{t.resolve()}),r.Ga.delete(e)}function Kg(r,e,t){let n=j(r),i=n.Wa[n.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),n.Wa[n.currentUser.toKey()]=i}}function jo(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(let n of r.qa.get(e))r.ka.delete(n),t&&r.La.Ja(n,t);r.qa.delete(e),r.isPrimaryClient&&r.Ua.br(e).forEach(n=>{r.Ua.containsKey(n)||Fb(r,n)})}function Fb(r,e){r.Qa.delete(e.path.canonicalString());let t=r.$a.get(e);t!==null&&(Lo(r.remoteStore,t),r.$a=r.$a.remove(e),r.Ka.delete(t),Hg(r))}function Zm(r,e,t){for(let n of t)n instanceof Yu?(r.Ua.addReference(n.key,e),HR(r,n)):n instanceof Xu?(F(Sr,"Document no longer in limbo: "+n.key),r.Ua.removeReference(n.key,e),r.Ua.containsKey(n.key)||Fb(r,n.key)):W()}function HR(r,e){let t=e.key,n=t.path.canonicalString();r.$a.get(t)||r.Qa.has(n)||(F(Sr,"New document in limbo: "+t),r.Qa.add(n),Hg(r))}function Hg(r){for(;r.Qa.size>0&&r.$a.size<r.maxConcurrentLimboResolutions;){let e=r.Qa.values().next().value;r.Qa.delete(e);let t=new B(de.fromString(e)),n=r.za.next();r.Ka.set(n,new Xm(t)),r.$a=r.$a.insert(t,n),gd(r.remoteStore,new ko(yt(Go(t.path)),n,"TargetPurposeLimboResolution",Vt.ae))}}function qn(r,e,t){return k(this,null,function*(){let n=j(r),i=[],o=[],s=[];n.ka.isEmpty()||(n.ka.forEach((c,l)=>{s.push(n.Ha(l,e,t).then(d=>{var f;if((d||t)&&n.isPrimaryClient){let p=d?!d.fromCache:(f=t?.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(d){i.push(d);let p=Pm.Yi(l.targetId,d);o.push(p)}}))}),yield Promise.all(s),n.La.p_(i),yield function(l,d){return k(this,null,function*(){let f=j(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>x.forEach(d,g=>x.forEach(g.Hi,b=>f.persistence.referenceDelegate.addReference(p,g.targetId,b)).next(()=>x.forEach(g.Ji,b=>f.persistence.referenceDelegate.removeReference(p,g.targetId,b)))))}catch(p){if(!Ir(p))throw p;F(Lg,"Failed to update sequence numbers: "+p)}for(let p of d){let g=p.targetId;if(!p.fromCache){let b=f.Ts.get(g),V=b.snapshotVersion,O=b.withLastLimboFreeSnapshotVersion(V);f.Ts=f.Ts.insert(g,O)}}})}(n.localStore,o))})}function QR(r,e){return k(this,null,function*(){let t=j(r);if(!t.currentUser.isEqual(e)){F(Sr,"User change. New user:",e.toKey());let n=yield vb(t.localStore,e);t.currentUser=e,function(o,s){o.Ga.forEach(c=>{c.forEach(l=>{l.reject(new N(M.CANCELLED,s))})}),o.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield qn(t,n.Rs)}})}function YR(r,e){let t=j(r),n=t.Ka.get(e);if(n&&n.Ba)return se().add(n.key);{let i=se(),o=t.qa.get(e);if(!o)return i;for(let s of o){let c=t.ka.get(s);i=i.unionWith(c.view.Sa)}return i}}function XR(r,e){return k(this,null,function*(){let t=j(r),n=yield ju(t.localStore,e.query,!0),i=e.view.Oa(n);return t.isPrimaryClient&&Zm(t,e.targetId,i.Ma),i})}function JR(r,e){return k(this,null,function*(){let t=j(r);return bb(t.localStore,e).then(n=>qn(t,n))})}function ZR(r,e,t,n){return k(this,null,function*(){let i=j(r),o=yield function(c,l){let d=j(c),f=j(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",p=>f.Ln(p,l).next(g=>g?d.localDocuments.getDocuments(p,g):x.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?yield Ko(i.remoteStore):t==="acknowledged"||t==="rejected"?(Kg(i,e,n||null),Wg(i,e),function(c,l){j(j(c).mutationQueue).qn(l)}(i.localStore,e)):W(),yield qn(i,o)):F(Sr,"Cannot apply mutation batch with id: "+e)})}function eM(r,e){return k(this,null,function*(){let t=j(r);if(yd(t),Qg(t),e===!0&&t.ja!==!0){let n=t.sharedClientState.getAllActiveQueryTargets(),i=yield $E(t,n.toArray());t.ja=!0,yield zm(t.remoteStore,!0);for(let o of i)gd(t.remoteStore,o)}else if(e===!1&&t.ja!==!1){let n=[],i=Promise.resolve();t.qa.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?n.push(s):i=i.then(()=>(jo(t,s),Fo(t.localStore,s,!0))),Lo(t.remoteStore,s)}),yield i,yield $E(t,n),function(s){let c=j(s);c.Ka.forEach((l,d)=>{Lo(c.remoteStore,d)}),c.Ua.Dr(),c.Ka=new Map,c.$a=new xe(B.comparator)}(t),t.ja=!1,yield zm(t.remoteStore,!1)}})}function $E(r,e,t){return k(this,null,function*(){let n=j(r),i=[],o=[];for(let s of e){let c,l=n.qa.get(s);if(l&&l.length!==0){c=yield No(n.localStore,yt(l[0]));for(let d of l){let f=n.ka.get(d),p=yield XR(n,f);p.snapshot&&o.push(p.snapshot)}}else{let d=yield Cb(n.localStore,s);c=yield No(n.localStore,d),yield Gg(n,Lb(d),s,!1,c.resumeToken)}i.push(c)}return n.La.p_(o),i})}function Lb(r){return DC(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function tM(r){return function(t){return j(j(t).persistence).zi()}(j(r).localStore)}function nM(r,e,t,n){return k(this,null,function*(){let i=j(r);if(i.ja)return void F(Sr,"Ignoring unexpected query state notification.");let o=i.qa.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield bb(i.localStore,kC(o[0])),c=Ua.createSynthesizedRemoteEventForCurrentChange(e,t==="current",qe.EMPTY_BYTE_STRING);yield qn(i,s,c);break}case"rejected":yield Fo(i.localStore,e,!0),jo(i,e,n);break;default:W()}})}function rM(r,e,t){return k(this,null,function*(){let n=yd(r);if(n.ja){for(let i of e){if(n.qa.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){F(Sr,"Adding an already active target "+i);continue}let o=yield Cb(n.localStore,i),s=yield No(n.localStore,o);yield Gg(n,Lb(o),s.targetId,!1,s.resumeToken),gd(n.remoteStore,s)}for(let i of t)n.qa.has(i)&&(yield Fo(n.localStore,i,!1).then(()=>{Lo(n.remoteStore,i),jo(n,i)}).catch(br))}})}function yd(r){let e=j(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=Nb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=YR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$R.bind(null,e),e.La.p_=FR.bind(null,e.eventManager),e.La.Ja=LR.bind(null,e.eventManager),e}function Qg(r){let e=j(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=GR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WR.bind(null,e),e}function iM(r,e,t){let n=j(r);(function(o,s,c){return k(this,null,function*(){try{let l=yield s.getMetadata();if(yield function(b,V){let O=j(b),R=Be(V.createTime);return O.persistence.runTransaction("hasNewerBundle","readonly",K=>O.Yr.getBundleMetadata(K,V.id)).then(K=>!!K&&K.createTime.compareTo(R)>=0)}(o.localStore,l))return yield s.close(),c._completeWith(function(b){return{taskState:"Success",documentsLoaded:b.totalDocuments,bytesLoaded:b.totalBytes,totalDocuments:b.totalDocuments,totalBytes:b.totalBytes}}(l)),Promise.resolve(new Set);c._updateProgress(kb(l));let d=new Qm(l,o.localStore,s.serializer),f=yield s.Ya();for(;f;){let g=yield d.Aa(f);g&&c._updateProgress(g),f=yield s.Ya()}let p=yield d.complete();return yield qn(o,p.ma,void 0),yield function(b,V){let O=j(b);return O.persistence.runTransaction("Save bundle","readwrite",R=>O.Yr.saveBundleMetadata(R,V))}(o.localStore,l),c._completeWith(p.progress),Promise.resolve(p.Va)}catch(l){return Qt(Sr,`Loading bundle failed with ${l}`),c._failWith(l),Promise.resolve(new Set)}})})(n,e,t).then(i=>{n.sharedClientState.notifyBundleLoaded(i)})}var Yg=(()=>{class r{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return k(this,null,function*(){this.serializer=rc(t.databaseInfo.databaseId),this.sharedClientState=this.Za(t),this.persistence=this.Xa(t),yield this.persistence.start(),this.localStore=this.eu(t),this.gcScheduler=this.tu(t,this.localStore),this.indexBackfillerScheduler=this.nu(t,this.localStore)})}tu(t,n){return null}nu(t,n){return null}eu(t){return _b(this.persistence,new Uu,t.initialUser,this.serializer)}Xa(t){return new Ga(Fu.ri,this.serializer)}Za(t){return new zu}terminate(){return k(this,null,function*(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return r.provider={build:()=>new r},r})(),eg=class extends Yg{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){H(this.persistence.referenceDelegate instanceof Lu);let n=this.persistence.referenceDelegate.garbageCollector;return new ku(n,e.asyncQueue,t)}Xa(e){let t=this.cacheSizeBytes!==void 0?Tt.withCacheSize(this.cacheSizeBytes):Tt.DEFAULT;return new Ga(n=>Lu.ri(n,t),this.serializer)}},Zu=class r extends Yg{constructor(e,t,n){super(),this.ru=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return k(this,null,function*(){yield nh(r.prototype,this,"initialize").call(this,e),yield this.ru.initialize(this,e),yield Qg(this.ru.syncEngine),yield Ko(this.ru.remoteStore),yield this.persistence.Ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}eu(e){return _b(this.persistence,new Uu,e.initialUser,this.serializer)}tu(e,t){let n=this.persistence.referenceDelegate.garbageCollector;return new ku(n,e.asyncQueue,t)}nu(e,t){let n=new Ap(t,this.persistence);return new Tp(e.asyncQueue,n)}Xa(e){let t=Fg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Tt.withCacheSize(this.cacheSizeBytes):Tt.DEFAULT;return new Sm(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Pb(),ou(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Za(e){return new zu}},tg=class r extends Zu{constructor(e,t){super(e,t,!1),this.ru=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return k(this,null,function*(){yield nh(r.prototype,this,"initialize").call(this,e);let t=this.ru.syncEngine;this.sharedClientState instanceof Aa&&(this.sharedClientState.syncEngine={uo:ZR.bind(null,t),co:nM.bind(null,t),lo:rM.bind(null,t),zi:tM.bind(null,t),ao:JR.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.Ci(n=>k(this,null,function*(){yield eM(this.ru.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))})}Za(e){let t=Pb();if(!Aa.D(t))throw new N(M.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let n=Fg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Aa(t,e.asyncQueue,n,e.clientId,e.initialUser)}},Xg=(()=>{class r{initialize(t,n){return k(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>zE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=QR.bind(null,this.syncEngine),yield zm(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Wm}()}createDatastore(t){let n=rc(t.databaseInfo.databaseId),i=function(s){return new Nm(s)}(t.databaseInfo);return function(s,c,l,d){return new jm(s,c,l,d)}(t.authCredentials,t.appCheckCredentials,i,n)}createRemoteStore(t){return function(i,o,s,c,l){return new qm(i,o,s,c,l)}(this.localStore,this.datastore,t.asyncQueue,n=>zE(this.syncEngine,n,0),function(){return $u.D()?new $u:new Dm}())}createSyncEngine(t,n){return function(o,s,c,l,d,f,p){let g=new Jm(o,s,c,l,d,f);return p&&(g.ja=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}terminate(){return k(this,null,function*(){var t,n;yield function(o){return k(this,null,function*(){let s=j(o);F(ai,"RemoteStore shutting down."),s.W_.add(5),yield Wo(s),s.z_.shutdown(),s.j_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()})}}return r.provider={build:()=>new r},r})();function GE(r,e=10240){let t=0;return{read(){return k(this,null,function*(){if(t<r.byteLength){let i={value:r.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return k(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Bo=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):Ue("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var ng=class{constructor(e,t){this.ou=e,this.serializer=t,this.metadata=new Ye,this.buffer=new Uint8Array,this._u=function(){return new TextDecoder("utf-8")}(),this.au().then(n=>{n&&n.Ea()?this.metadata.resolve(n.Ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(n?.Ia)}`))},n=>this.metadata.reject(n))}close(){return this.ou.cancel()}getMetadata(){return k(this,null,function*(){return this.metadata.promise})}Ya(){return k(this,null,function*(){return yield this.getMetadata(),this.au()})}au(){return k(this,null,function*(){let e=yield this.uu();if(e===null)return null;let t=this._u.decode(e),n=Number(t);isNaN(n)&&this.cu(`length string (${t}) is not valid number`);let i=yield this.lu(n);return new Hm(JSON.parse(i),e.length+n)})}hu(){return this.buffer.findIndex(e=>e===123)}uu(){return k(this,null,function*(){for(;this.hu()<0&&!(yield this.Pu()););if(this.buffer.length===0)return null;let e=this.hu();e<0&&this.cu("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}lu(e){return k(this,null,function*(){for(;this.buffer.length<e;)(yield this.Pu())&&this.cu("Reached the end of bundle when more is expected.");let t=this._u.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}cu(e){throw this.ou.cancel(),new Error(`Invalid bundle format: ${e}`)}Pu(){return k(this,null,function*(){let e=yield this.ou.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var rg=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return k(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new N(M.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,o){return k(this,null,function*(){let s=j(i),c={documents:o.map(p=>Ba(s.serializer,p))},l=yield s.Co("BatchGetDocuments",s.serializer.databaseId,de.emptyPath(),c,o.length),d=new Map;l.forEach(p=>{let g=cR(s.serializer,p);d.set(g.key.toString(),g)});let f=[];return o.forEach(p=>{let g=d.get(p.toString());H(!!g),f.push(g)}),f})}(this.datastore,e);return t.forEach(n=>this.recordVersion(n)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new wr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return k(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,n)=>{let i=B.fromPath(n);this.mutations.push(new Na(i,this.precondition(i)))}),yield function(n,i){return k(this,null,function*(){let o=j(n),s={writes:i.map(c=>qa(o.serializer,c))};yield o.So("Commit",o.serializer.databaseId,de.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw W();t=Y.min()}let n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new N(M.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Y.min())?Fe.exists(!1):Fe.updateTime(t):Fe.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Y.min()))throw new N(M.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fe.updateTime(t)}return Fe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var ig=class{constructor(e,t,n,i,o){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=i,this.deferred=o,this.Tu=n.maxAttempts,this.a_=new Ka(this.asyncQueue,"transaction_retry")}Iu(){this.Tu-=1,this.Eu()}Eu(){this.a_.Xo(()=>k(this,null,function*(){let e=new rg(this.datastore),t=this.du(e);t&&t.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(i=>{this.Au(i)}))}).catch(n=>{this.Au(n)})}))}du(e){try{let t=this.updateFunction(e);return!Ja(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Au(e){this.Tu>0&&this.Ru(e)?(this.Tu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Eu(),Promise.resolve()))):this.deferred.reject(e)}Ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!KC(t)}return!1}};var Cr="FirestoreClient",og=class{constructor(e,t,n,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=He.UNAUTHENTICATED,this.clientId=cu.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,s=>k(this,null,function*(){F(Cr,"Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(n,s=>(F(Cr,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Ye;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>k(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let n=Qo(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}};function mp(r,e){return k(this,null,function*(){r.asyncQueue.verifyOperationInProgress(),F(Cr,"Initializing OfflineComponentProvider");let t=r.configuration;yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(i=>k(this,null,function*(){n.isEqual(i)||(yield vb(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e})}function WE(r,e){return k(this,null,function*(){r.asyncQueue.verifyOperationInProgress();let t=yield Jg(r);F(Cr,"Initializing OnlineComponentProvider"),yield e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>jE(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>jE(e.remoteStore,i)),r._onlineComponents=e})}function Jg(r){return k(this,null,function*(){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){F(Cr,"Using user provided OfflineComponentProvider");try{yield mp(r,r._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===M.FAILED_PRECONDITION||i.code===M.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Qt("Error using user provided cache. Falling back to memory cache: "+t),yield mp(r,new Yg)}}else F(Cr,"Using default OfflineComponentProvider"),yield mp(r,new eg(void 0));return r._offlineComponents})}function _d(r){return k(this,null,function*(){return r._onlineComponents||(r._uninitializedComponentsProvider?(F(Cr,"Using user provided OnlineComponentProvider"),yield WE(r,r._uninitializedComponentsProvider._online)):(F(Cr,"Using default OnlineComponentProvider"),yield WE(r,new Xg))),r._onlineComponents})}function Ub(r){return Jg(r).then(e=>e.persistence)}function Zg(r){return Jg(r).then(e=>e.localStore)}function jb(r){return _d(r).then(e=>e.remoteStore)}function ey(r){return _d(r).then(e=>e.syncEngine)}function oM(r){return _d(r).then(e=>e.datastore)}function qo(r){return k(this,null,function*(){let e=yield _d(r),t=e.eventManager;return t.onListen=UR.bind(null,e.syncEngine),t.onUnlisten=BR.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=jR.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=qR.bind(null,e.syncEngine),t})}function sM(r){return r.asyncQueue.enqueue(()=>k(this,null,function*(){let e=yield Ub(r),t=yield jb(r);return e.setNetworkEnabled(!0),function(i){let o=j(i);return o.W_.delete(0),ic(o)}(t)}))}function aM(r){return r.asyncQueue.enqueue(()=>k(this,null,function*(){let e=yield Ub(r),t=yield jb(r);return e.setNetworkEnabled(!1),function(i){return k(this,null,function*(){let o=j(i);o.W_.add(0),yield Wo(o),o.j_.set("Offline")})}(t)}))}function cM(r,e){let t=new Ye;return r.asyncQueue.enqueueAndForget(()=>k(this,null,function*(){return function(i,o,s){return k(this,null,function*(){try{let c=yield function(d,f){let p=j(d);return p.persistence.runTransaction("read document","readonly",g=>p.localDocuments.getDocument(g,f))}(i,o);c.isFoundDocument()?s.resolve(c):c.isNoDocument()?s.resolve(null):s.reject(new N(M.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(c){let l=Qo(c,`Failed to get document '${o} from cache`);s.reject(l)}})}(yield Zg(r),e,t)})),t.promise}function Bb(r,e,t={}){let n=new Ye;return r.asyncQueue.enqueueAndForget(()=>k(this,null,function*(){return function(o,s,c,l,d){let f=new Bo({next:g=>{f.su(),s.enqueueAndForget(()=>zg(o,p));let b=g.docs.has(c);!b&&g.fromCache?d.reject(new N(M.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&g.fromCache&&l&&l.source==="server"?d.reject(new N(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),p=new Ha(Go(c.path),f,{includeMetadataChanges:!0,Ta:!0});return qg(o,p)}(yield qo(r),r.asyncQueue,e,t,n)})),n.promise}function lM(r,e){let t=new Ye;return r.asyncQueue.enqueueAndForget(()=>k(this,null,function*(){return function(i,o,s){return k(this,null,function*(){try{let c=yield ju(i,o,!0),l=new Ju(o,c.gs),d=l.ba(c.documents),f=l.applyChanges(d,!1);s.resolve(f.snapshot)}catch(c){let l=Qo(c,`Failed to execute query '${o} against cache`);s.reject(l)}})}(yield Zg(r),e,t)})),t.promise}function qb(r,e,t={}){let n=new Ye;return r.asyncQueue.enqueueAndForget(()=>k(this,null,function*(){return function(o,s,c,l,d){let f=new Bo({next:g=>{f.su(),s.enqueueAndForget(()=>zg(o,p)),g.fromCache&&l.source==="server"?d.reject(new N(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),p=new Ha(c,f,{includeMetadataChanges:!0,Ta:!0});return qg(o,p)}(yield qo(r),r.asyncQueue,e,t,n)})),n.promise}function uM(r,e){let t=new Bo(e);return r.asyncQueue.enqueueAndForget(()=>k(this,null,function*(){return function(i,o){j(i).ia.add(o),o.next()}(yield qo(r),t)})),()=>{t.su(),r.asyncQueue.enqueueAndForget(()=>k(this,null,function*(){return function(i,o){j(i).ia.delete(o)}(yield qo(r),t)}))}}function dM(r,e,t,n){let i=function(s,c){let l;return l=typeof s=="string"?QC().encode(s):s,function(f,p){return new ng(f,p)}(function(f,p){if(f instanceof Uint8Array)return GE(f,p);if(f instanceof ArrayBuffer)return GE(new Uint8Array(f),p);if(f instanceof ReadableStream)return f.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),c)}(t,rc(e));r.asyncQueue.enqueueAndForget(()=>k(this,null,function*(){iM(yield ey(r),i,n)}))}function hM(r,e){return r.asyncQueue.enqueue(()=>k(this,null,function*(){return function(n,i){let o=j(n);return o.persistence.runTransaction("Get named query","readonly",s=>o.Yr.getNamedQuery(s,i))}(yield Zg(r),e)}))}function zb(r){let e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}var KE=new Map;function ty(r,e,t){if(!t)throw new N(M.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function ny(r,e,t,n){if(e===!0&&n===!0)throw new N(M.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function HE(r){if(!B.isDocumentKey(r))throw new N(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function QE(r){if(B.isDocumentKey(r))throw new N(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function vd(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{let e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":W()}function fe(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new N(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=vd(r);throw new N(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function $b(r,e){if(e<=0)throw new N(M.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}var Gb="firestore.googleapis.com",YE=!0,ed=class{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new N(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Gb,this.ssl=YE}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:YE;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=db;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<vR)throw new N(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ny("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zb((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new N(M.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new N(M.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new N(M.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ci=class{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ed({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new N(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new N(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ed(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new gp;switch(n.type){case"firstParty":return new wp(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new N(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return k(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let n=KE.get(t);n&&(F("ComponentProvider","Removing Datastore"),KE.delete(t),n.terminate())}(this),Promise.resolve()}};function Wb(r,e,t,n={}){var i;let o=(r=fe(r,ci))._getSettings(),s=`${e}:${t}`;if(o.host!==Gb&&o.host!==s&&Qt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),n.mockUserToken){let c,l;if(typeof n.mockUserToken=="string")c=n.mockUserToken,l=He.MOCK_USER;else{c=yv(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);let d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new N(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new He(d)}r._authCredentials=new yp(new su(c,l))}}var rt=class r{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new r(this.firestore,e,this._query)}},Ae=class r{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new r(this.firestore,e,this._key)}},mn=class r extends rt{constructor(e,t,n){super(e,t,Go(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ae(this.firestore,null,new B(e))}withConverter(e){return new r(this.firestore,e,this._path)}};function ry(r,e,...t){if(r=De(r),ty("collection","path",e),r instanceof ci){let n=de.fromString(e,...t);return QE(n),new mn(r,null,n)}{if(!(r instanceof Ae||r instanceof mn))throw new N(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=r._path.child(de.fromString(e,...t));return QE(n),new mn(r.firestore,null,n)}}function Kb(r,e){if(r=fe(r,ci),ty("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new N(M.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new rt(r,null,function(n){return new Yt(de.emptyPath(),n)}(e))}function oc(r,e,...t){if(r=De(r),arguments.length===1&&(e=cu.newId()),ty("doc","path",e),r instanceof ci){let n=de.fromString(e,...t);return HE(n),new Ae(r,null,new B(n))}{if(!(r instanceof Ae||r instanceof mn))throw new N(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=r._path.child(de.fromString(e,...t));return HE(n),new Ae(r.firestore,r instanceof mn?r.converter:null,new B(n))}}function iy(r,e){return r=De(r),e=De(e),(r instanceof Ae||r instanceof mn)&&(e instanceof Ae||e instanceof mn)&&r.firestore===e.firestore&&r.path===e.path&&r.converter===e.converter}function oy(r,e){return r=De(r),e=De(e),r instanceof rt&&e instanceof rt&&r.firestore===e.firestore&&tc(r._query,e._query)&&r.converter===e.converter}var XE="AsyncQueue",td=class{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new Ka(this,"async_queue_retry"),this.Su=()=>{let n=ou();n&&F(XE,"Visibility state changed to "+n.visibilityState),this.a_.t_()},this.bu=e;let t=ou();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;let t=ou();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});let t=new Ye;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}Cu(){return k(this,null,function*(){if(this.Vu.length!==0){try{yield this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Ir(e))throw e;F(XE,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}})}vu(e){let t=this.bu.then(()=>(this.pu=!0,e().catch(n=>{this.gu=n,this.pu=!1;let i=function(s){let c=s.message||"";return s.stack&&(c=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),c}(n);throw Ue("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.pu=!1,n))));return this.bu=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);let i=$m.createAndSchedule(this,e,t,n,o=>this.Fu(o));return this.fu.push(i),i}Du(){this.gu&&W()}verifyOperationInProgress(){}Mu(){return k(this,null,function*(){let e;do e=this.bu,yield e;while(e!==this.bu)})}xu(e){for(let t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(let t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){let t=this.fu.indexOf(e);this.fu.splice(t,1)}};function sg(r){return function(t,n){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of n)if(o in i&&typeof i[o]=="function")return!0;return!1}(r,["next","error","complete"])}var ag=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Ye,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var Hb=-1,ke=class extends ci{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new td,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return k(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new td(e),this._firestoreClient=void 0,yield e}})}};function it(r){if(r._terminated)throw new N(M.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||Qb(r),r._firestoreClient}function Qb(r){var e,t,n;let i=r._freezeSettings(),o=function(c,l,d,f){return new Rp(c,l,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,zb(f.experimentalLongPollingOptions),f.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new og(r._authCredentials,r._appCheckCredentials,r._queue,o,r._componentsProvider&&function(c){let l=c?._online.build();return{_offline:c?._offline.build(l),_online:l}}(r._componentsProvider))}function Yb(r,e){Qt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=r._freezeSettings();return Jb(r,Xg.provider,{build:n=>new Zu(n,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function Xb(r){return k(this,null,function*(){Qt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=r._freezeSettings();Jb(r,Xg.provider,{build:t=>new tg(t,e.cacheSizeBytes)})})}function Jb(r,e,t){if((r=fe(r,ke))._firestoreClient||r._terminated)throw new N(M.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(r._componentsProvider||r._getSettings().localCache)throw new N(M.FAILED_PRECONDITION,"SDK cache is already specified.");r._componentsProvider={_online:e,_offline:t},Qb(r)}function Zb(r){if(r._initialized&&!r._terminated)throw new N(M.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Ye;return r._queue.enqueueAndForgetEvenWhileRestricted(()=>k(this,null,function*(){try{yield function(n){return k(this,null,function*(){if(!fr.D())return Promise.resolve();let i=n+yb;yield fr.delete(i)})}(Fg(r._databaseId,r._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function eI(r){return function(t){let n=new Ye;return t.asyncQueue.enqueueAndForget(()=>k(this,null,function*(){return KR(yield ey(t),n)})),n.promise}(it(r=fe(r,ke)))}function tI(r){return sM(it(r=fe(r,ke)))}function nI(r){return aM(it(r=fe(r,ke)))}function rI(r,e){let t=it(r=fe(r,ke)),n=new ag;return dM(t,r._databaseId,e,n),n}function iI(r,e){return hM(it(r=fe(r,ke)),e).then(t=>t?new rt(r,null,t.query):null)}var _n=class r{constructor(e){this._byteString=e}static fromBase64String(e){try{return new r(qe.fromBase64String(e))}catch(t){throw new N(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new r(qe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Zt=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new N(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new je(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var jn=class{constructor(e){this._methodName=e}};var li=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new N(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new N(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ie(this._lat,e._lat)||ie(this._long,e._long)}};var Qa=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}};var fM=/^__.*__$/,cg=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Jt(e,this.data,this.fieldMask,t,this.fieldTransforms):new vr(e,this.data,t,this.fieldTransforms)}},nd=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Jt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function oI(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}var rd=class r{constructor(e,t,n,i,o,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Bu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new r(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:n,Qu:!1});return i.$u(e),i}Ku(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:n,Qu:!1});return i.Bu(),i}Uu(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return id(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if(oI(this.Lu)&&fM.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}},lg=class{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||rc(e)}ju(e,t,n,i=!1){return new rd({Lu:e,methodName:t,zu:n,path:je.emptyPath(),Qu:!1,Gu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function hi(r){let e=r._freezeSettings(),t=rc(r._databaseId);return new lg(r._databaseId,!!e.ignoreUndefinedProperties,t)}function wd(r,e,t,n,i,o={}){let s=r.ju(o.merge||o.mergeFields?2:0,e,t,i);cy("Data must be an object, but it was:",s,n);let c=cI(n,s),l,d;if(o.merge)l=new Nt(s.fieldMask),d=s.fieldTransforms;else if(o.mergeFields){let f=[];for(let p of o.mergeFields){let g=pg(e,p,t);if(!s.contains(g))throw new N(M.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);uI(f,g)||f.push(g)}l=new Nt(f),d=s.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,d=s.fieldTransforms;return new cg(new dt(c),l,d)}var Ya=class r extends jn{_toFieldTransform(e){if(e.Lu!==2)throw e.Lu===1?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof r}};function sI(r,e,t){return new rd({Lu:3,zu:e.settings.zu,methodName:r._methodName,Qu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var ug=class r extends jn{_toFieldTransform(e){return new ii(e.path,new yr)}isEqual(e){return e instanceof r}},dg=class r extends jn{constructor(e,t){super(e),this.Hu=t}_toFieldTransform(e){let t=sI(this,e,!0),n=this.Hu.map(o=>fi(o,t)),i=new Ln(n);return new ii(e.path,i)}isEqual(e){return e instanceof r&&Sh(this.Hu,e.Hu)}},hg=class r extends jn{constructor(e,t){super(e),this.Hu=t}_toFieldTransform(e){let t=sI(this,e,!0),n=this.Hu.map(o=>fi(o,t)),i=new Un(n);return new ii(e.path,i)}isEqual(e){return e instanceof r&&Sh(this.Hu,e.Hu)}},fg=class r extends jn{constructor(e,t){super(e),this.Ju=t}_toFieldTransform(e){let t=new _r(e.serializer,jC(e.serializer,this.Ju));return new ii(e.path,t)}isEqual(e){return e instanceof r&&this.Ju===e.Ju}};function sy(r,e,t,n){let i=r.ju(1,e,t);cy("Data must be an object, but it was:",i,n);let o=[],s=dt.empty();Tr(n,(l,d)=>{let f=ly(e,l,t);d=De(d);let p=i.Ku(f);if(d instanceof Ya)o.push(f);else{let g=fi(d,p);g!=null&&(o.push(f),s.set(f,g))}});let c=new Nt(o);return new nd(s,c,i.fieldTransforms)}function ay(r,e,t,n,i,o){let s=r.ju(1,e,t),c=[pg(e,n,t)],l=[i];if(o.length%2!=0)throw new N(M.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)c.push(pg(e,o[g])),l.push(o[g+1]);let d=[],f=dt.empty();for(let g=c.length-1;g>=0;--g)if(!uI(d,c[g])){let b=c[g],V=l[g];V=De(V);let O=s.Ku(b);if(V instanceof Ya)d.push(b);else{let R=fi(V,O);R!=null&&(d.push(b),f.set(b,R))}}let p=new Nt(d);return new nd(f,p,s.fieldTransforms)}function aI(r,e,t,n=!1){return fi(t,r.ju(n?4:3,e))}function fi(r,e){if(lI(r=De(r)))return cy("Unsupported field value:",e,r),cI(r,e);if(r instanceof jn)return function(n,i){if(!oI(i.Lu))throw i.Wu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Wu(`${n._methodName}() is not currently supported inside arrays`);let o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(n,i){let o=[],s=0;for(let c of n){let l=fi(c,i.Uu(s));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),s++}return{arrayValue:{values:o}}}(r,e)}return function(n,i){if((n=De(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return jC(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let o=Oe.fromDate(n);return{timestampValue:Oo(i.serializer,o)}}if(n instanceof Oe){let o=new Oe(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Oo(i.serializer,o)}}if(n instanceof li)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof _n)return{bytesValue:YC(i.serializer,n._byteString)};if(n instanceof Ae){let o=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(o))throw i.Wu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:kg(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Qa)return function(s,c){return{mapValue:{fields:{[Pg]:{stringValue:xg},[Po]:{arrayValue:{values:s.toArray().map(d=>{if(typeof d!="number")throw c.Wu("VectorValues must only contain numeric values.");return Og(c.serializer,d)})}}}}}}(n,i);throw i.Wu(`Unsupported field value: ${vd(n)}`)}(r,e)}function cI(r,e){let t={};return yC(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Tr(r,(n,i)=>{let o=fi(i,e.qu(n));o!=null&&(t[n]=o)}),{mapValue:{fields:t}}}function lI(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Oe||r instanceof li||r instanceof _n||r instanceof Ae||r instanceof jn||r instanceof Qa)}function cy(r,e,t){if(!lI(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let n=vd(t);throw n==="an object"?e.Wu(r+" a custom object"):e.Wu(r+" "+n)}}function pg(r,e,t){if((e=De(e))instanceof Zt)return e._internalPath;if(typeof e=="string")return ly(r,e);throw id("Field path arguments must be of type string or ",r,!1,void 0,t)}var pM=new RegExp("[~\\*/\\[\\]]");function ly(r,e,t){if(e.search(pM)>=0)throw id(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Zt(...e.split("."))._internalPath}catch{throw id(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function id(r,e,t,n,i){let o=n&&!n.isEmpty(),s=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${n}`),s&&(l+=` in document ${i}`),l+=")"),new N(M.INVALID_ARGUMENT,c+r+l)}function uI(r,e){return r.some(t=>t.isEqual(e))}var ui=class{constructor(e,t,n,i,o){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ae(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new mg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Ed("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},mg=class extends ui{data(){return super.data()}};function Ed(r,e){return typeof e=="string"?ly(r,e):e instanceof Zt?e._internalPath:e._delegate._internalPath}function dI(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new N(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Xa=class{},di=class extends Xa{};function zn(r,e,...t){let n=[];e instanceof Xa&&n.push(e),n=n.concat(t),function(o){let s=o.filter(l=>l instanceof gg).length,c=o.filter(l=>l instanceof od).length;if(s>1||s>0&&c>0)throw new N(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(let i of n)r=i._apply(r);return r}var od=class r extends di{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new r(e,t,n)}_apply(e){let t=this._parse(e);return EI(e._query,t),new rt(e.firestore,e.converter,$p(e._query,t))}_parse(e){let t=hi(e.firestore);return function(o,s,c,l,d,f,p){let g;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new N(M.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){ZE(p,f);let V=[];for(let O of p)V.push(JE(l,o,O));g={arrayValue:{values:V}}}else g=JE(l,o,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||ZE(p,f),g=aI(c,s,p,f==="in"||f==="not-in");return le.create(d,f,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function hI(r,e,t){let n=e,i=Ed("where",r);return od._create(i,n,t)}var gg=class r extends Xa{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new r(e,t)}_parse(e){let t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:we.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,c=o.getFlattenedFilters();for(let l of c)EI(s,l),s=$p(s,l)}(e._query,t),new rt(e.firestore,e.converter,$p(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var yg=class r extends di{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new r(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new N(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new N(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ni(o,s)}(e._query,this._field,this._direction);return new rt(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new Yt(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function fI(r,e="asc"){let t=e,n=Ed("orderBy",r);return yg._create(n,t)}var sd=class r extends di{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new r(e,t,n)}_apply(e){return new rt(e.firestore,e.converter,bu(e._query,this._limit,this._limitType))}};function pI(r){return $b("limit",r),sd._create("limit",r,"F")}function mI(r){return $b("limitToLast",r),sd._create("limitToLast",r,"L")}var ad=class r extends di{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new r(e,t,n)}_apply(e){let t=wI(e,this.type,this._docOrFields,this._inclusive);return new rt(e.firestore,e.converter,function(i,o){return new Yt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}};function gI(...r){return ad._create("startAt",r,!0)}function yI(...r){return ad._create("startAfter",r,!1)}var cd=class r extends di{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new r(e,t,n)}_apply(e){let t=wI(e,this.type,this._docOrFields,this._inclusive);return new rt(e.firestore,e.converter,function(i,o){return new Yt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}};function _I(...r){return cd._create("endBefore",r,!1)}function vI(...r){return cd._create("endAt",r,!0)}function wI(r,e,t,n){if(t[0]=De(t[0]),t[0]instanceof ui)return function(o,s,c,l,d){if(!l)throw new N(M.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);let f=[];for(let p of vo(o))if(p.field.isKeyField())f.push(ti(s,l.key));else{let g=l.data.field(p.field);if(fd(g))throw new N(M.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let b=p.field.canonicalString();throw new N(M.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${b}' (used as the orderBy) does not exist.`)}f.push(g)}return new yn(f,d)}(r._query,r.firestore._databaseId,e,t[0]._document,n);{let i=hi(r.firestore);return function(s,c,l,d,f,p){let g=s.explicitOrderBy;if(f.length>g.length)throw new N(M.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let b=[];for(let V=0;V<f.length;V++){let O=f[V];if(g[V].field.isKeyField()){if(typeof O!="string")throw new N(M.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof O}`);if(!Mg(s)&&O.indexOf("/")!==-1)throw new N(M.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${O}' contains a slash.`);let R=s.path.child(de.fromString(O));if(!B.isDocumentKey(R))throw new N(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let K=new B(R);b.push(ti(c,K))}else{let R=aI(l,d,O);b.push(R)}}return new yn(b,p)}(r._query,r.firestore._databaseId,i,e,t,n)}}function JE(r,e,t){if(typeof(t=De(t))=="string"){if(t==="")throw new N(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Mg(e)&&t.indexOf("/")!==-1)throw new N(M.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let n=e.path.child(de.fromString(t));if(!B.isDocumentKey(n))throw new N(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ti(r,new B(n))}if(t instanceof Ae)return ti(r,t._key);throw new N(M.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vd(t)}.`)}function ZE(r,e){if(!Array.isArray(r)||r.length===0)throw new N(M.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function EI(r,e){let t=function(i,o){for(let s of i)for(let c of s.getFlattenedFilters())if(o.indexOf(c.op)>=0)return c.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new N(M.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new N(M.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var zo=class{convertValue(e,t="none"){switch(mr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Me(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Fn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw W()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let n={};return Tr(e,(i,o)=>{n[i]=this.convertValue(o,t)}),n}convertVectorValue(e){var t,n,i;let o=(i=(n=(t=e.fields)===null||t===void 0?void 0:t[Po].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(s=>Me(s.doubleValue));return new Qa(o)}convertGeoPoint(e){return new li(Me(e.latitude),Me(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":let n=pd(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Oa(e));default:return null}}convertTimestamp(e){let t=Nn(e);return new Oe(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=de.fromString(e);H(ab(n));let i=new pr(n.get(1),n.get(3)),o=new B(n.popFirst(5));return i.isEqual(t)||Ue(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function Cd(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}var _g=class extends zo{constructor(e){super(),this.firestore=e}convertBytes(e){return new _n(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ae(this.firestore,null,t)}};var Vn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},zt=class extends ui{constructor(e,t,n,i,o,s){super(e,t,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new dr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(Ed("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}},dr=class extends zt{data(e={}){return super.data(e)}},en=class{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Vn(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new dr(this._firestore,this._userDataWriter,n.key,n,new Vn(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new N(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(c=>{let l=new dr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Vn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>o||c.type!==3).map(c=>{let l=new dr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Vn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,f=-1;return c.type!==0&&(d=s.indexOf(c.doc.key),s=s.delete(c.doc.key)),c.type!==1&&(s=s.add(c.doc),f=s.indexOf(c.doc.key)),{type:mM(c.type),doc:l,oldIndex:d,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function mM(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W()}}function uy(r,e){return r instanceof zt&&e instanceof zt?r._firestore===e._firestore&&r._key.isEqual(e._key)&&(r._document===null?e._document===null:r._document.isEqual(e._document))&&r._converter===e._converter:r instanceof en&&e instanceof en&&r._firestore===e._firestore&&oy(r.query,e.query)&&r.metadata.isEqual(e.metadata)&&r._snapshot.isEqual(e._snapshot)}function CI(r){r=fe(r,Ae);let e=fe(r.firestore,ke);return Bb(it(e),r._key).then(t=>py(e,r,t))}var Bn=class extends zo{constructor(e){super(),this.firestore=e}convertBytes(e){return new _n(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ae(this.firestore,null,t)}};function bI(r){r=fe(r,Ae);let e=fe(r.firestore,ke),t=it(e),n=new Bn(e);return cM(t,r._key).then(i=>new zt(e,n,r._key,i,new Vn(i!==null&&i.hasLocalMutations,!0),r.converter))}function II(r){r=fe(r,Ae);let e=fe(r.firestore,ke);return Bb(it(e),r._key,{source:"server"}).then(t=>py(e,r,t))}function TI(r){r=fe(r,rt);let e=fe(r.firestore,ke),t=it(e),n=new Bn(e);return dI(r._query),qb(t,r._query).then(i=>new en(e,n,r,i))}function AI(r){r=fe(r,rt);let e=fe(r.firestore,ke),t=it(e),n=new Bn(e);return lM(t,r._query).then(i=>new en(e,n,r,i))}function SI(r){r=fe(r,rt);let e=fe(r.firestore,ke),t=it(e),n=new Bn(e);return qb(t,r._query,{source:"server"}).then(i=>new en(e,n,r,i))}function dy(r,e,t){r=fe(r,Ae);let n=fe(r.firestore,ke),i=Cd(r.converter,e,t);return Yo(n,[wd(hi(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,Fe.none())])}function hy(r,e,t,...n){r=fe(r,Ae);let i=fe(r.firestore,ke),o=hi(i),s;return s=typeof(e=De(e))=="string"||e instanceof Zt?ay(o,"updateDoc",r._key,e,t,n):sy(o,"updateDoc",r._key,e),Yo(i,[s.toMutation(r._key,Fe.exists(!0))])}function PI(r){return Yo(fe(r.firestore,ke),[new wr(r._key,Fe.none())])}function xI(r,e){let t=fe(r.firestore,ke),n=oc(r),i=Cd(r.converter,e);return Yo(t,[wd(hi(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,Fe.exists(!1))]).then(()=>n)}function fy(r,...e){var t,n,i;r=De(r);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||sg(e[s])||(o=e[s],s++);let c={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(sg(e[s])){let p=e[s];e[s]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[s+1]=(n=p.error)===null||n===void 0?void 0:n.bind(p),e[s+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let l,d,f;if(r instanceof Ae)d=fe(r.firestore,ke),f=Go(r._key.path),l={next:p=>{e[s]&&e[s](py(d,r,p))},error:e[s+1],complete:e[s+2]};else{let p=fe(r,rt);d=fe(p.firestore,ke),f=p._query;let g=new Bn(d);l={next:b=>{e[s]&&e[s](new en(d,g,p,b))},error:e[s+1],complete:e[s+2]},dI(r._query)}return function(g,b,V,O){let R=new Bo(O),K=new Ha(b,R,V);return g.asyncQueue.enqueueAndForget(()=>k(this,null,function*(){return qg(yield qo(g),K)})),()=>{R.su(),g.asyncQueue.enqueueAndForget(()=>k(this,null,function*(){return zg(yield qo(g),K)}))}}(it(d),f,c,l)}function RI(r,e){return uM(it(r=fe(r,ke)),sg(e)?e:{next:e})}function Yo(r,e){return function(n,i){let o=new Ye;return n.asyncQueue.enqueueAndForget(()=>k(this,null,function*(){return zR(yield ey(n),i,o)})),o.promise}(it(r),e)}function py(r,e,t){let n=t.docs.get(e._key),i=new Bn(r);return new zt(r,i,e._key,n,new Vn(t.hasPendingWrites,t.fromCache),e.converter)}var gM={maxAttempts:5};var ld=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=hi(e)}set(e,t,n){this._verifyNotCommitted();let i=lr(e,this._firestore),o=Cd(i.converter,t,n),s=wd(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,n);return this._mutations.push(s.toMutation(i._key,Fe.none())),this}update(e,t,n,...i){this._verifyNotCommitted();let o=lr(e,this._firestore),s;return s=typeof(t=De(t))=="string"||t instanceof Zt?ay(this._dataReader,"WriteBatch.update",o._key,t,n,i):sy(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,Fe.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=lr(e,this._firestore);return this._mutations=this._mutations.concat(new wr(t._key,Fe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new N(M.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function lr(r,e){if((r=De(r)).firestore!==e)throw new N(M.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}var vg=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=hi(e)}get(e){let t=lr(e,this._firestore),n=new _g(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||i.length!==1)return W();let o=i[0];if(o.isFoundDocument())return new ui(this._firestore,n,o.key,o,t.converter);if(o.isNoDocument())return new ui(this._firestore,n,t._key,null,t.converter);throw W()})}set(e,t,n){let i=lr(e,this._firestore),o=Cd(i.converter,t,n),s=wd(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,n);return this._transaction.set(i._key,s),this}update(e,t,n,...i){let o=lr(e,this._firestore),s;return s=typeof(t=De(t))=="string"||t instanceof Zt?ay(this._dataReader,"Transaction.update",o._key,t,n,i):sy(this._dataReader,"Transaction.update",o._key,t),this._transaction.update(o._key,s),this}delete(e){let t=lr(e,this._firestore);return this._transaction.delete(t._key),this}};var wg=class extends vg{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=lr(e,this._firestore),n=new Bn(this._firestore);return super.get(e).then(i=>new zt(this._firestore,n,t._key,i._document,new Vn(!1,!1),t.converter))}};function MI(r,e,t){r=fe(r,ke);let n=Object.assign(Object.assign({},gM),t);return function(o){if(o.maxAttempts<1)throw new N(M.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(o,s,c){let l=new Ye;return o.asyncQueue.enqueueAndForget(()=>k(this,null,function*(){let d=yield oM(o);new ig(o.asyncQueue,d,c,s,l).Iu()})),l.promise}(it(r),i=>e(new wg(r,i)),n)}function DI(){return new Ya("deleteField")}function OI(){return new ug("serverTimestamp")}function kI(...r){return new dg("arrayUnion",r)}function VI(...r){return new hg("arrayRemove",r)}function NI(r){return new fg("increment",r)}(function(e,t=!0){(function(i){$o=i})(Ev),Ms(new Lr("firestore",(n,{instanceIdentifier:i,options:o})=>{let s=n.getProvider("app").getImmediate(),c=new ke(new _p(n.getProvider("auth-internal")),new Ep(s,n.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new N(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pr(d.options.projectId,f)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),c._setSettings(o),c},"PUBLIC").setMultipleInstances(!0)),Xn(Bw,qw,e),Xn(Bw,qw,"esm2017")})();var yM="@firebase/firestore-compat",_M="0.3.43";function wy(r,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new N("invalid-argument",`Invalid options passed to function ${r}(): You cannot specify both "merge" and "mergeFields".`);return e}function FI(){if(typeof Uint8Array>"u")throw new N("unimplemented","Uint8Arrays are not available in this environment.")}function LI(){if(!_C())throw new N("unimplemented","Blobs are unavailable in Firestore in this environment.")}var bd=class r{constructor(e){this._delegate=e}static fromBase64String(e){return LI(),new r(_n.fromBase64String(e))}static fromUint8Array(e){return FI(),new r(_n.fromUint8Array(e))}toBase64(){return LI(),this._delegate.toBase64()}toUint8Array(){return FI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function my(r){return vM(r,["next","error","complete"])}function vM(r,e){if(typeof r!="object"||r===null)return!1;let t=r;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}var gy=class{enableIndexedDbPersistence(e,t){return Yb(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return Xb(e._delegate)}clearIndexedDbPersistence(e){return Zb(e._delegate)}},Id=class{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof pr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Qt("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,n={}){Wb(this._delegate,e,t,n)}enableNetwork(){return tI(this._delegate)}disableNetwork(){return nI(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,ny("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return eI(this._delegate)}onSnapshotsInSync(e){return RI(this._delegate,e)}get app(){if(!this._appCompat)throw new N("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Zo(this,ry(this._delegate,e))}catch(t){throw _t(t,"collection()","Firestore.collection()")}}doc(e){try{return new vn(this,oc(this._delegate,e))}catch(t){throw _t(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new yi(this,Kb(this._delegate,e))}catch(t){throw _t(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return MI(this._delegate,t=>e(new Td(this,t)))}batch(){return it(this._delegate),new Ad(new ld(this._delegate,e=>Yo(this._delegate,e)))}loadBundle(e){return rI(this._delegate,e)}namedQuery(e){return iI(this._delegate,e).then(t=>t?new yi(this,t):null)}},Xo=class extends zo{constructor(e){super(),this.firestore=e}convertBytes(e){return new bd(new _n(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return vn.forKey(t,this.firestore,null)}};function wM(r){eC(r)}var Td=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Xo(e)}get(e){let t=pi(e);return this._delegate.get(t).then(n=>new mi(this._firestore,new zt(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){let i=pi(e);return n?(wy("Transaction.set",n),this._delegate.set(i,t,n)):this._delegate.set(i,t),this}update(e,t,n,...i){let o=pi(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,n,...i),this}delete(e){let t=pi(e);return this._delegate.delete(t),this}},Ad=class{constructor(e){this._delegate=e}set(e,t,n){let i=pi(e);return n?(wy("WriteBatch.set",n),this._delegate.set(i,t,n)):this._delegate.set(i,t),this}update(e,t,n,...i){let o=pi(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,n,...i),this}delete(e){let t=pi(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Jo=class r{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){let n=new dr(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new gi(this._firestore,n),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let n=r.INSTANCES,i=n.get(e);i||(i=new WeakMap,n.set(e,i));let o=i.get(t);return o||(o=new r(e,new Xo(e),t),i.set(t,o)),o}};Jo.INSTANCES=new WeakMap;var vn=class r{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Xo(e)}static forPath(e,t,n){if(e.length%2!==0)throw new N("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new r(t,new Ae(t._delegate,n,new B(e)))}static forKey(e,t,n){return new r(t,new Ae(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new Zo(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Zo(this.firestore,ry(this._delegate,e))}catch(t){throw _t(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=De(e),e instanceof Ae?iy(this._delegate,e):!1}set(e,t){t=wy("DocumentReference.set",t);try{return t?dy(this._delegate,e,t):dy(this._delegate,e)}catch(n){throw _t(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return arguments.length===1?hy(this._delegate,e):hy(this._delegate,e,t,...n)}catch(i){throw _t(i,"updateDoc()","DocumentReference.update()")}}delete(){return PI(this._delegate)}onSnapshot(...e){let t=UI(e),n=jI(e,i=>new mi(this.firestore,new zt(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return fy(this._delegate,t,n)}get(e){let t;return e?.source==="cache"?t=bI(this._delegate):e?.source==="server"?t=II(this._delegate):t=CI(this._delegate),t.then(n=>new mi(this.firestore,new zt(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(Jo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function _t(r,e,t){return r.message=r.message.replace(e,t),r}function UI(r){for(let e of r)if(typeof e=="object"&&!my(e))return e;return{}}function jI(r,e){var t,n;let i;return my(r[0])?i=r[0]:my(r[1])?i=r[1]:typeof r[0]=="function"?i={next:r[0],error:r[1],complete:r[2]}:i={next:r[1],error:r[2],complete:r[3]},{next:o=>{i.next&&i.next(e(o))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(n=i.complete)===null||n===void 0?void 0:n.bind(i)}}var mi=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new vn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return uy(this._delegate,e._delegate)}},gi=class extends mi{data(e){let t=this._delegate.data(e);return this._delegate._converter||tC(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},yi=class r{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Xo(e)}where(e,t,n){try{return new r(this.firestore,zn(this._delegate,hI(e,t,n)))}catch(i){throw _t(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new r(this.firestore,zn(this._delegate,fI(e,t)))}catch(n){throw _t(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new r(this.firestore,zn(this._delegate,pI(e)))}catch(t){throw _t(t,"limit()","Query.limit()")}}limitToLast(e){try{return new r(this.firestore,zn(this._delegate,mI(e)))}catch(t){throw _t(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new r(this.firestore,zn(this._delegate,gI(...e)))}catch(t){throw _t(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new r(this.firestore,zn(this._delegate,yI(...e)))}catch(t){throw _t(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new r(this.firestore,zn(this._delegate,_I(...e)))}catch(t){throw _t(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new r(this.firestore,zn(this._delegate,vI(...e)))}catch(t){throw _t(t,"endAt()","Query.endAt()")}}isEqual(e){return oy(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=AI(this._delegate):e?.source==="server"?t=SI(this._delegate):t=TI(this._delegate),t.then(n=>new sc(this.firestore,new en(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){let t=UI(e),n=jI(e,i=>new sc(this.firestore,new en(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return fy(this._delegate,t,n)}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(Jo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},yy=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new gi(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},sc=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new yi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new gi(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new yy(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new gi(this._firestore,n))})}isEqual(e){return uy(this._delegate,e._delegate)}},Zo=class r extends yi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new vn(this.firestore,e):null}doc(e){try{return e===void 0?new vn(this.firestore,oc(this._delegate)):new vn(this.firestore,oc(this._delegate,e))}catch(t){throw _t(t,"doc()","CollectionReference.doc()")}}add(e){return xI(this._delegate,e).then(t=>new vn(this.firestore,t))}isEqual(e){return iy(this._delegate,e._delegate)}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(Jo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function pi(r){return fe(r,Ae)}var _y=class r{constructor(...e){this._delegate=new Zt(...e)}static documentId(){return new r(je.keyField().canonicalString())}isEqual(e){return e=De(e),e instanceof Zt?this._delegate._internalPath.isEqual(e._internalPath):!1}};var vy=class r{static serverTimestamp(){let e=OI();return e._methodName="FieldValue.serverTimestamp",new r(e)}static delete(){let e=DI();return e._methodName="FieldValue.delete",new r(e)}static arrayUnion(...e){let t=kI(...e);return t._methodName="FieldValue.arrayUnion",new r(t)}static arrayRemove(...e){let t=VI(...e);return t._methodName="FieldValue.arrayRemove",new r(t)}static increment(e){let t=NI(e);return t._methodName="FieldValue.increment",new r(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}};var EM={Firestore:Id,GeoPoint:li,Timestamp:Oe,Blob:bd,Transaction:Td,WriteBatch:Ad,DocumentReference:vn,DocumentSnapshot:mi,Query:yi,QueryDocumentSnapshot:gi,QuerySnapshot:sc,CollectionReference:Zo,FieldPath:_y,FieldValue:vy,setLogLevel:wM,CACHE_SIZE_UNLIMITED:Hb};function CM(r,e){r.INTERNAL.registerComponent(new Lr("firestore-compat",t=>{let n=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(n,i)},"PUBLIC").setServiceProps(Object.assign({},EM)))}function bM(r){CM(r,(e,t)=>new Id(e,t,new gy)),r.registerVersion(yM,_M)}bM(It);function IM(r,e=Ic){return new tn(t=>{let n;return e!=null?e.schedule(()=>{n=r.onSnapshot({includeMetadataChanges:!0},t)}):n=r.onSnapshot({includeMetadataChanges:!0},t),()=>{n?.()}})}function BI(r,e){return IM(r,e)}function TM(r,e){return BI(r,e).pipe(Ti(void 0),Sc(),Z(t=>{let[n,i]=t;return i.exists?n?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function by(r,e){return BI(r,e).pipe(Z(t=>({payload:t,type:"query"})))}var Sd=class{ref;afs;injector=$(wt);constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let n=this.ref.collection(e),{ref:i,query:o}=WI(n,t);return new xd(i,o,this.afs)}snapshotChanges(){return TM(this.ref,this.afs.schedulers.outsideAngular).pipe(gt(this.injector))}valueChanges(e={}){return this.snapshotChanges().pipe(Z(({payload:t})=>e.idField?ge(z({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Pe(this.ref.get(e)).pipe(gt(this.injector))}};function Pd(r,e){return by(r,e).pipe(Ti(void 0),Sc(),Z(t=>{let[n,i]=t,o=i.payload.docChanges(),s=o.map(c=>({type:c.type,payload:c}));return n&&JSON.stringify(n.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((c,l)=>{let d=o.find(p=>p.doc.ref.isEqual(c.ref)),f=n?.payload.docs.find(p=>p.ref.isEqual(c.ref));d&&JSON.stringify(d.doc.metadata)===JSON.stringify(c.metadata)||!d&&f&&JSON.stringify(f.metadata)===JSON.stringify(c.metadata)||s.push({type:"modified",payload:{oldIndex:l,newIndex:l,type:"modified",doc:c}})}),s}))}function qI(r,e,t){return Pd(r,t).pipe(Ii((n,i)=>AM(n,i.map(o=>o.payload),e),[]),k_(),Z(n=>n.map(i=>({type:i.type,payload:i}))))}function AM(r,e,t){return e.forEach(n=>{t.indexOf(n.type)>-1&&(r=SM(r,n))}),r}function Ey(r,e,t,...n){let i=r.slice();return i.splice(e,t,...n),i}function SM(r,e){switch(e.type){case"added":if(!r[e.newIndex]?.doc.ref.isEqual(e.doc.ref))return Ey(r,e.newIndex,0,e);break;case"modified":if(r[e.oldIndex]==null||r[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=r.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return Ey(r,e.newIndex,1,e);break;case"removed":if(r[e.oldIndex]?.doc.ref.isEqual(e.doc.ref))return Ey(r,e.oldIndex,1);break}return r}function zI(r){return(!r||r.length===0)&&(r=["added","removed","modified"]),r}var xd=class{ref;query;afs;injector=$(wt);constructor(e,t,n){this.ref=e,this.query=t,this.afs=n}stateChanges(e){let t=Pd(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Z(n=>n.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Ti(void 0),Sc(),vt(([n,i])=>i.length>0||!n),Z(([,n])=>n),gt(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(Ii((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=zI(e);return qI(this.query,t,this.afs.schedulers.outsideAngular).pipe(gt(this.injector))}valueChanges(e={}){return by(this.query,this.afs.schedulers.outsideAngular).pipe(Z(t=>t.payload.docs.map(n=>e.idField?ge(z({},n.data()),{[e.idField]:n.id}):n.data())),gt(this.injector))}get(e){return Pe(this.query.get(e)).pipe(gt(this.injector))}add(e){return this.ref.add(e)}doc(e){return new Sd(this.ref.doc(e),this.afs)}},Cy=class{query;afs;injector=$(wt);constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Pd(this.query,this.afs.schedulers.outsideAngular).pipe(gt(this.injector)):Pd(this.query,this.afs.schedulers.outsideAngular).pipe(Z(t=>t.filter(n=>e.indexOf(n.type)>-1)),vt(t=>t.length>0),gt(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(Ii((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=zI(e);return qI(this.query,t,this.afs.schedulers.outsideAngular).pipe(gt(this.injector))}valueChanges(e={}){return by(this.query,this.afs.schedulers.outsideAngular).pipe(Z(n=>n.payload.docs.map(i=>e.idField?z({[e.idField]:i.id},i.data()):i.data())),gt(this.injector))}get(e){return Pe(this.query.get(e)).pipe(gt(this.injector))}},$I=new te("angularfire2.enableFirestorePersistence"),GI=new te("angularfire2.firestore.persistenceSettings"),PM=new te("angularfire2.firestore.settings"),xM=new te("angularfire2.firestore.use-emulator");function WI(r,e=t=>t){return{query:e(r),ref:r}}var RM=(()=>{class r{schedulers;firestore;persistenceEnabled$;ngZone=$(Ne);constructor(t,n,i,o,s,c,l,d,f,p,g,b,V,O,R,K,Q){this.schedulers=l;let L=ha(t,c,n),J=f;p&&np(L,c,g,V,O,R,b,K),[this.firestore,this.persistenceEnabled$]=$l(`${L.name}.firestore`,"AngularFirestore",L.name,()=>{let ne=c.runOutsideAngular(()=>L.firestore());if(o&&ne.settings(o),J&&ne.useEmulator(...J),i&&!Fr(s)){let re=()=>{try{return Pe(ne.enablePersistence(d||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),X(!1)}};return[ne,c.runOutsideAngular(re)]}else return[ne,X(!1)]},[o,J,i])}collection(t,n){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:o,query:s}=WI(i,n),c=this.ngZone.run(()=>o);return new xd(c,s,this)}collectionGroup(t,n){let i=n||(s=>s),o=this.firestore.collectionGroup(t);return new Cy(i(o),this)}doc(t){let n;typeof t=="string"?n=this.firestore.doc(t):n=t;let i=this.ngZone.run(()=>n);return new Sd(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(n){return new(n||r)(q(to),q(no,8),q($I,8),q(PM,8),q(Lt),q(Ne),q(da),q(GI,8),q(xM,8),q(Lw,8),q(Yf,8),q(Xf,8),q(Jf,8),q(Zf,8),q(ep,8),q(tp,8),q(ro,8))};static \u0275prov=ee({token:r,factory:r.\u0275fac,providedIn:"any"})}return r})(),KI=(()=>{class r{constructor(){It.registerVersion("angularfire",eo.full,"fst-compat")}static enablePersistence(t){return{ngModule:r,providers:[{provide:$I,useValue:!0},{provide:GI,useValue:t}]}}static \u0275fac=function(n){return new(n||r)};static \u0275mod=Ze({type:r});static \u0275inj=Je({providers:[RM]})}return r})();var MM="@",DM=(()=>{class r{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=$(on);loadingSchedulerFn=$(OM,{optional:!0});_engine;constructor(t,n,i,o,s){this.doc=t,this.delegate=n,this.zone=i,this.animationType=o,this.moduleImpl=s}ngOnDestroy(){this._engine?.flush()}loadImpl(){let t=()=>this.moduleImpl??import("./chunk-WRHNZXSG.js").then(i=>i),n;return this.loadingSchedulerFn?n=this.loadingSchedulerFn(t):n=t(),n.catch(i=>{throw new he(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:o})=>{this._engine=i(this.animationType,this.doc);let s=new o(this.delegate,this._engine,this.zone);return this.delegate=s,s})}createRenderer(t,n){let i=this.delegate.createRenderer(t,n);if(i.\u0275type===0)return i;typeof i.throwOnSyntheticProps=="boolean"&&(i.throwOnSyntheticProps=!1);let o=new Iy(i);return n?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(s=>{let c=s.createRenderer(t,n);o.use(c),this.scheduler??=this.injector.get(B_,null,{optional:!0}),this.scheduler?.notify(11)}).catch(s=>{o.use(i)}),o}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(t){this._engine?.flush(),this.delegate.componentReplaced?.(t)}static \u0275fac=function(n){xc()};static \u0275prov=ee({token:r,factory:r.\u0275fac})}return r})(),Iy=class{delegate;replay=[];\u0275type=1;constructor(e){this.delegate=e}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,n,i){this.delegate.insertBefore(e,t,n,i)}removeChild(e,t,n){this.delegate.removeChild(e,t,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,i){this.delegate.setStyle(e,t,n,i)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){this.shouldReplay(t)&&this.replay.push(i=>i.setProperty(e,t,n)),this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n,i){return this.shouldReplay(t)&&this.replay.push(o=>o.listen(e,t,n,i)),this.delegate.listen(e,t,n,i)}shouldReplay(e){return this.replay!==null&&e.startsWith(MM)}},OM=new te("");function HI(r="animations"){return gh("NgAsyncAnimations"),Ai([{provide:Pc,useFactory:(e,t,n)=>new DM(e,t,n,r),deps:[mt,Qc,Ne]},{provide:G_,useValue:r==="noop"?"NoopAnimations":"BrowserAnimations"}])}var Rd=class r{static \u0275fac=function(t){return new(t||r)};static \u0275mod=Ze({type:r,bootstrap:[Pl]});static \u0275inj=Je({providers:[HI()],imports:[Yv,Bl,S0,Tw.initializeApp(Ll),KI,jv]})};Qv().bootstrapModule(Rd,{ngZoneEventCoalescing:!0}).catch(r=>console.error(r));
